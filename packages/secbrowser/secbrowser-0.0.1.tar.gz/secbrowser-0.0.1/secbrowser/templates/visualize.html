<!DOCTYPE html>
<html>

<head>
    <title>Data Visualization</title>
</head>

<body>
    <section>
        <form method="POST" action="/document/visualize">
            <fieldset>
                <legend>Tags:</legend>

                <input type="checkbox" id="tickers" name="tags" value="tickers" {% if selected_tags and 'tickers' in
                    selected_tags %}checked{% endif %}>
                <label for="tickers">Tickers</label>
                <input type="color" id="tickers_color" name="tickers_color"
                    value="{% if colors and 'tickers' in colors %}{{ colors['tickers'] }}{% else %}#ff0000{% endif %}">
                <br>

                <input type="checkbox" id="persons" name="tags" value="persons" {% if selected_tags and 'persons' in
                    selected_tags %}checked{% endif %}>
                <label for="persons">Persons</label>
                <input type="color" id="persons_color" name="persons_color"
                    value="{% if colors and 'persons' in colors %}{{ colors['persons'] }}{% else %}#00ff00{% endif %}">
                <br>

                <input type="checkbox" id="cusips" name="tags" value="cusips" {% if selected_tags and 'cusips' in
                    selected_tags %}checked{% endif %}>
                <label for="cusips">CUSIPs</label>
                <input type="color" id="cusips_color" name="cusips_color"
                    value="{% if colors and 'cusips' in colors %}{{ colors['cusips'] }}{% else %}#0000ff{% endif %}">
                <br>

                <input type="checkbox" id="isins" name="tags" value="isins" {% if selected_tags and 'isins' in
                    selected_tags %}checked{% endif %}>
                <label for="isins">ISINs</label>
                <input type="color" id="isins_color" name="isins_color"
                    value="{% if colors and 'isins' in colors %}{{ colors['isins'] }}{% else %}#ffff00{% endif %}">
                <br>

                <input type="checkbox" id="figis" name="tags" value="figis" {% if selected_tags and 'figis' in
                    selected_tags %}checked{% endif %}>
                <label for="figis">FIGIs</label>
                <input type="color" id="figis_color" name="figis_color"
                    value="{% if colors and 'figis' in colors %}{{ colors['figis'] }}{% else %}#ff00ff{% endif %}">
                <br>
            </fieldset>

            <fieldset>
                <legend>Similarity:</legend>

                <input type="checkbox" id="loughran_mcdonald" name="similarity" value="loughran_mcdonald" {% if
                    selected_similarity and 'loughran_mcdonald' in selected_similarity %}checked{% endif %}>
                <label for="loughran_mcdonald">Loughran McDonald</label>
            </fieldset>

            <fieldset>
                <legend>Dictionaries - Persons:</legend>

                <input type="radio" id="persons_none" name="persons_dict" value="none" {% if not form_data or
                    form_data.get('persons_dict')=='none' %}checked{% endif %}>
                <label for="persons_none">None</label>
                <br>

                <input type="radio" id="persons_ssa" name="persons_dict" value="ssa_baby_first_names" {% if form_data
                    and form_data.get('persons_dict')=='ssa_baby_first_names' %}checked{% endif %}>
                <label for="persons_ssa">SSA Baby First Names</label>
                <br>

                <input type="radio" id="persons_8k" name="persons_dict" value="8k_2024_persons" {% if form_data and
                    form_data.get('persons_dict')=='8k_2024_persons' %}checked{% endif %}>
                <label for="persons_8k">8-K 2024 Persons</label>
                <br>
            </fieldset>

            <fieldset>
                <legend>Dictionaries - CUSIPs:</legend>

                <input type="radio" id="cusips_none" name="cusips_dict" value="none" {% if not form_data or
                    form_data.get('cusips_dict')=='none' %}checked{% endif %}>
                <label for="cusips_none">None</label>
                <br>

                <input type="radio" id="cusips_sc13dg" name="cusips_dict" value="sc13dg_cusips" {% if form_data and
                    form_data.get('cusips_dict')=='sc13dg_cusips' %}checked{% endif %}>
                <label for="cusips_sc13dg">SC 13D/G CUSIPs</label>
                <br>

                <input type="radio" id="cusips_13fhr" name="cusips_dict" value="13fhr_information_table_cusips" {% if
                    form_data and form_data.get('cusips_dict')=='13fhr_information_table_cusips' %}checked{% endif %}>
                <label for="cusips_13fhr">13F-HR Information Table CUSIPs</label>
                <br>
            </fieldset>

            <fieldset>
                <legend>Dictionaries - FIGIs:</legend>

                <input type="radio" id="figis_none" name="figis_dict" value="none" {% if not form_data or
                    form_data.get('figis_dict')=='none' %}checked{% endif %}>
                <label for="figis_none">None</label>
                <br>

                <input type="radio" id="figis_npx" name="figis_dict" value="npx_figis" {% if form_data and
                    form_data.get('figis_dict')=='npx_figis' %}checked{% endif %}>
                <label for="figis_npx">NPX FIGIs</label>
                <br>
            </fieldset>

            <fieldset>
                <legend>Dictionaries - ISINs:</legend>

                <input type="radio" id="isins_none" name="isins_dict" value="none" {% if not form_data or
                    form_data.get('isins_dict')=='none' %}checked{% endif %}>
                <label for="isins_none">None</label>
                <br>

                <input type="radio" id="isins_npx" name="isins_dict" value="npx_isins" {% if form_data and
                    form_data.get('isins_dict')=='npx_isins' %}checked{% endif %}>
                <label for="isins_npx">NPX ISINs</label>
                <br>
            </fieldset>

            <!-- Sentiment visualization controls inside form -->
            {% if available_sentiment_keys %}
            <fieldset>
                <legend>Sentiment Visualization:</legend>
                {% for key in available_sentiment_keys %}
                <input type="checkbox" id="sentiment_{{ key }}" name="sentiment_keys" value="{{ key }}" {% if not
                    selected_sentiment_keys or key in selected_sentiment_keys %}checked{% endif %}>
                <label for="sentiment_{{ key }}">{{ key|title }}</label>
                <input type="color" id="sentiment_{{ key }}_color" name="sentiment_{{ key }}_color"
                    value="{% if sentiment_colors and key in sentiment_colors %}{{ sentiment_colors[key] }}{% else %}{% if key == 'negative' %}#ff4444{% elif key == 'positive' %}#44ff44{% elif key == 'uncertainty' %}#ffaa44{% elif key == 'litigious' %}#aa44ff{% elif key == 'strong_modal' %}#4444ff{% elif key == 'weak_modal' %}#44aaff{% elif key == 'constraining' %}#ff44aa{% else %}#888888{% endif %}{% endif %}">
                <br>
                {% endfor %}
            </fieldset>
            {% endif %}

            <button type="submit">Process Data Tags</button>
        </form>
    </section>



    {% if data_visualization %}
    <h3>Visualize with Tags</h3>
    {% if tags_summary %}
    <p><strong>Tags found:</strong></p>
    <ul>
        {% for tag_type, matches in tags_summary.items() %}
        <li><strong>{{ tag_type|title }}:</strong> {{ matches|join(', ') }}</li>
        {% endfor %}
    </ul>
    {% else %}
    <p><strong>No tags found</strong></p>
    {% endif %}
    <div>{{ data_visualization|safe }}</div>
    {% else %}
    <div>{{ document.data }}</div>
    {% endif %}

</body>

</html>