{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PyInGraph Configuration Schema",
  "description": "JSON schema for PyInGraph computational graph configuration files",
  "type": "object",
  "required": ["nodes", "edges"],
  "properties": {
    "nodes": {
      "type": "array",
      "description": "Array of algorithm blocks (nodes) in the computational graph",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "name", "folder_url", "folder_path", "class_file", "class_name", "parameters"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for this node",
            "pattern": "^[a-zA-Z0-9_-]+$",
            "examples": ["node1", "source_node", "processing-block"]
          },
          "name": {
            "type": "string",
            "description": "Human-readable name for this node",
            "minLength": 1,
            "examples": ["Constant Source 1", "Data Processor", "Output Sink"]
          },
          "folder_url": {
            "type": "string",
            "description": "HTTP URL for remote module loading (leave empty for local modules)",
            "format": "uri",
            "examples": ["", "https://example.com/modules"]
          },
          "folder_path": {
            "type": "string",
            "description": "Local directory path containing the local module file, if non-empty, loading local modules is prioritized than remote modules.",
            "examples": ["local_modules", "algorithms", "blocks"]
          },
          "class_file": {
            "type": "string",
            "description": "Python file containing the algorithm class",
            "pattern": ".*\\.py$",
            "examples": ["mod_source_constant.py", "processor.py"]
          },
          "class_name": {
            "type": "string",
            "description": "Name of the Python class implementing the algorithm",
            "pattern": "^[A-Z][a-zA-Z0-9_]*$",
            "examples": ["ConstantSource", "DataProcessor", "SinkPrint"]
          },
          "parameters": {
            "type": "object",
            "description": "Configuration parameters for the algorithm instance",
            "additionalProperties": true,
            "examples": [
              {"value": 5.0},
              {"scales": [1.0, 1.0]},
              {"threshold": 0.5, "mode": "auto"}
            ]
          }
        },
        "additionalProperties": false
      }
    },
    "edges": {
      "type": "array",
      "description": "Array of connections between nodes in the computational graph",
      "items": {
        "type": "object",
        "required": ["id","source_node_id", "target_node_id", "source_port_idx", "target_port_idx", "properties"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Optional unique identifier for this edge",
            "pattern": "^[a-zA-Z0-9_-]+$",
            "examples": ["edge1", "connection_1", "data-flow"]
          },
          "source_node_id": {
            "type": "string",
            "description": "ID of the source node (must match a node ID)",
            "examples": ["node1", "source_block"]
          },
          "target_node_id": {
            "type": "string",
            "description": "ID of the target node (must match a node ID)",
            "examples": ["node2", "sink_block"]
          },
          "source_port_idx": {
            "type": "integer",
            "description": "Output port index of the source node (0-based)",
            "minimum": 0,
            "examples": [0, 1, 2]
          },
          "target_port_idx": {
            "type": "integer",
            "description": "Input port index of the target node (0-based)",
            "minimum": 0,
            "examples": [0, 1, 2]
          },
          "properties": {
            "type": "object",
            "description": "Additional properties for this connection",
            "properties": {
              "signal_type": {
                "type": "string",
                "description": "Type or description of the signal being transmitted",
                "examples": ["constant_input_1", "processed_data", "control_signal"]
              },
              "weight": {
                "type": "number",
                "description": "Weight or scaling factor for this connection",
                "examples": [1.0, 0.5, -1.0]
              }
            },
            "additionalProperties": true
          }
        },
        "additionalProperties": false
      }
    },
    "metadata": {
      "type": "object",
      "description": "Optional metadata about the graph",
      "properties": {
        "version": {
          "type": "string",
          "description": "Version of the graph configuration",
          "examples": ["1.0", "2.1.0"]
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of the graph",
          "examples": ["Simple addition example", "Control system simulation"]
        },
        "author": {
          "type": "string",
          "description": "Author of the graph configuration",
          "examples": ["John Doe", "team@company.com"]
        },
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "Creation timestamp",
          "examples": ["2024-01-15T10:30:00Z"]
        },
        "tags": {
          "type": "array",
          "description": "Tags for categorizing the graph",
          "items": {
            "type": "string"
          },
          "examples": [["demo", "simple"], ["control", "simulation"]]
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "nodes": [
        {
          "id": "node1",
          "name": "Constant Source",
          "folder_url": "",
          "folder_path": "local_modules",
          "class_file": "mod_source_constant.py",
          "class_name": "ConstantSource",
          "parameters": {
            "value": 5.0
          }
        },
        {
          "id": "node2",
          "name": "Print Sink",
          "folder_url": "",
          "folder_path": "local_modules",
          "class_file": "mod_sink_print.py",
          "class_name": "SinkPrint",
          "parameters": {}
        }
      ],
      "edges": [
        {
          "id": "edge1",
          "source_node_id": "node1",
          "target_node_id": "node2",
          "source_port_idx": 0,
          "target_port_idx": 0,
          "properties": {
            "signal_type": "constant_value",
            "weight": 1.0
          }
        }
      ],
      "metadata": {
        "version": "1.0",
        "description": "Simple constant to print example",
        "tags": ["demo", "basic"]
      }
    }
  ]
}