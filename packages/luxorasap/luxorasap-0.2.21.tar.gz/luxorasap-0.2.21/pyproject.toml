#############################
# Build & packaging metadata
#############################
[build-system]
requires = ["setuptools>=69", "wheel"]
build-backend = "setuptools.build_meta"

#############################
# Core project metadata
#############################
[project]
name            = "luxorasap"
version = "0.2.21"
description     = "Toolbox da Luxor para ingestão, análise e automação de dados financeiros."
readme          = "README.md"
requires-python = ">=3.9"
authors         = [{ name = "Luxor Group", email = "backoffice@luxor.com.br" }]
license         = { text = "Proprietary – All rights reserved" }
classifiers     = [
  "Programming Language :: Python :: 3",
  "License :: Other/Proprietary License",
  "Operating System :: OS Independent",
]

#############################
# Runtime dependencies
#############################
dependencies = [
  # core
  "pandas>=2.2",
  "numpy>=1.25",
  "loguru>=0.7",
  "python-dotenv>=1.0",
  "azure-storage-blob>=12.19",
  "pyarrow>=15.0",      # usado por datareader/ingest
  "requests>=2.32",     # usado por btgapi
  "pydantic>=2.7",      # usado por btgapi
  "scipy>=1.13",
  "openpyxl"
]

[project.optional-dependencies]
# mantém para uso futuro ou para quem queira instalação granular
storage   = ["azure-storage-blob>=12.19", "pyarrow>=15.0"]
dataframe = ["pandas>=2.2"]
datareader = ["luxorasap[storage,dataframe]", "numpy>=1.25", "scipy>=1.13"]
ingest     = ["luxorasap[storage,dataframe]", "pandas>=2.2"]
btgapi     = ["requests>=2.32", "pydantic>=2.7"]
dev        = [
  "pytest>=8.2",
  "requests-mock>=1.11",
  "black>=24.4.0",
  "isort>=5.13",
  "bumpver>=2024.3",
  "pre-commit>=3.7",
  "build>=1.2"
]

[project.urls]
Homepage = "https://github.com/luxorinvestimentos/luxor-asap"
Documentation = "https://luxorinvestimentos.github.io/luxorasap-docs/"

#############################
# Console scripts (opcional)
#############################
[project.scripts]
# habilita:   $ luxor-report --help
luxor-report = "luxorasap.cli:main"

#############################
# setuptools discovery
#############################
[tool.setuptools.packages.find]
where   = ["src"]
exclude = ["tests*"]

#############################
# bumpver (sem-ver)
#############################
[tool.bumpver]
current_version = "0.2.21"
version_pattern = "MAJOR.MINOR.PATCH"

# regex explícito – obrigatório no bumpver 2024+
version_regex = '''
(?P<major>[0-9]+)
\.
(?P<minor>[0-9]+)
\.
(?P<patch>[0-9]+)
'''

commit          = true
tag             = true
push            = false
commit_message  = "release: {old_version} → {new_version}"
tag_message     = "v{new_version}"

[tool.bumpver.file_patterns]
# ─── Arquivos/linhas onde a versão deve mudar ─────────────────────
"pyproject.toml"           = ['version = "{version}"']
"src/luxorasap/__init__.py" = ['__version__ = "{version}"']

#############################
# Tooling (black / isort)
#############################
[tool.black]
line-length = 88
target-version = ["py311"]

[tool.isort]
profile = "black"
line_length = 88
src_paths = ["src", "tests"]