"use strict";(self.webpackChunkdaiquiri_ui=self.webpackChunkdaiquiri_ui||[]).push([[89],{94708:(e,t,r)=>{r.d(t,{Z0:()=>i,ZP:()=>o});var n=r(69521);function i(){return(0,n.jsx)("div",{className:"separator"})}function o(e){var t,r;const i=null!==(t=e.spacing)&&void 0!==t?t:.2,o={center:"center",left:"flex-start",right:"flex-end"}[null!==(r=e.align)&&void 0!==r?r:"left"];return(0,n.jsx)("div",{className:"toolbar",style:{justifyContent:o,gap:`${i}em`,...e.style},children:e.children})}},2498:(e,t,r)=>{r.d(t,{HI:()=>m,qk:()=>p});var n=r(20837),i=r(70775),o=r(7842);class s{constructor(e,t){this.counter=void 0,this.hoveredRois=void 0,this.currentUid=void 0,this.topUid=void 0,this.disabled=void 0,this.onMouseInteractionOverlayChanged=void 0,this.setCursor=void 0,this.counter=1,this.currentUid=void 0,this.hoveredRois={},this.onMouseInteractionOverlayChanged=e,this.setCursor=t,this.disabled=!1}setDisabled(e){this.disabled=e,e&&this.currentUid&&this.release(this.currentUid),this.updateTopUid()}register(e,t,r,n){const i="interaction_"+this.counter++;return this.hoveredRois[i]={priority:e,pointer:t,onEnter:r,onLeave:n},this.updateTopUid(),i}unregister(e){const t=this.hoveredRois[e];if(void 0!==t){var r;if(delete this.hoveredRois[e],this.topUid===e)null===(r=t.onLeave)||void 0===r||r.call(t),this.topUid=void 0;this.updateTopUid()}}setCurrent(e){this.currentUid=e,this.updateCursor()}updateTopUid(){var e;const t=this.disabled?void 0:this.computeTopUid();if(this.topUid!==t){if(void 0===this.currentUid&&void 0!==this.topUid){var r;const e=this.hoveredRois[this.topUid];null===(r=e.onLeave)||void 0===r||r.call(e)}if(this.topUid=t,void 0===this.currentUid&&void 0!==this.topUid){var n;const e=this.hoveredRois[this.topUid];null===(n=e.onEnter)||void 0===n||n.call(e)}}null===(e=this.onMouseInteractionOverlayChanged)||void 0===e||e.call(this,t),this.updateCursor()}updateCursor(){var e;const t=null!==(e=this.currentUid)&&void 0!==e?e:this.topUid;if(void 0===t){var r;null===(r=this.setCursor)||void 0===r||r.call(this,void 0)}else{var n;const e=this.hoveredRois[t];null===(n=this.setCursor)||void 0===n||n.call(this,e.pointer)}}isCurrent(e){return void 0!==this.currentUid&&this.currentUid===e}computeTopUid(){let e,t;for(const[r,n]of Object.entries(this.hoveredRois))(void 0===t||n.priority>t)&&(e=r,t=n.priority);return e}capture(e){return!this.disabled&&(void 0===this.currentUid&&(this.topUid===e&&(this.setCurrent(e),!0)))}release(e){this.setCurrent(void 0)}}var a=r(69521);function c(e){return e.zoomMode?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Ce,{disabled:e.disabled,button:i.tc.Middle}),(0,a.jsx)(i.XZ,{disabled:e.disabled}),(0,a.jsx)(i.LG,{})]}):e.panMode?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Ce,{disabled:e.disabled,button:[i.tc.Left,i.tc.Middle]}),(0,a.jsx)(i.LG,{})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Ce,{disabled:e.disabled,button:i.tc.Middle}),(0,a.jsx)(i.LG,{})]})}var u=r(42506),d=r(15568),l=r(96956),h=r(26799);function f(e){const{cursor:t}=e,r=(0,h.A)((e=>e.gl.domElement));return(0,n.useEffect)((()=>{r.style.cursor=t}),[r,t]),(0,a.jsx)(a.Fragment,{})}const v=(0,n.createContext)(null);function p(){try{const e=(0,n.useContext)(v);return null===e?void console.error("LinearVisCanvasContext not found"):e}catch{return void console.error("LinearVisCanvasContext not found")}}function m(e){var t;const{className:r,title:h,children:p,mouseMode:m="zoom",onMouseInteractionOverlayChanged:y,plotRef:b,showAxes:x,abscissaConfig:w,ordinateConfig:g,...C}=e,A=(0,n.useMemo)((()=>({zoom:"crosshair",pan:"all-scroll",...e.cursors})),[e.cursors]),M=(0,n.useRef)(null),[U,k]=(0,n.useState)(),[E,N]=(0,n.useState)();(0,n.useEffect)((()=>{const e=A[m];k(e)}),[A,m]);const I=(0,n.useCallback)((e=>{null===y||void 0===y||y(e)}),[y]),j=(0,n.useRef)(new s(I,N)),R=(0,n.useMemo)((()=>{var e;const t=function(){var e;return w.flip!==g.flip?void 0===E?E:null!==(e={"nesw-resize":"nwse-resize","nwse-resize":"nesw-resize"}[E])&&void 0!==e?e:E:E}();return null!==(e=null!==t&&void 0!==t?t:U)&&void 0!==e?e:"default"}),[U,E,w.flip,g.flip]),[D,V,L]=null!==(t=e.undoableViewpoint)&&void 0!==t?t:[void 0,void 0,void 0],[z,S]=(0,n.useState)(!1);(0,n.useLayoutEffect)((()=>{if(!V)return;if(!M.current||!z)return;M.current.resetZoom();const{center:e,scale:t}=M.current.getCameraViewpoint();null===L||void 0===L||L.reset(),null===L||void 0===L||L.resetInitialState({centerX:e.x,centerY:e.y,scale:t.x}),null===L||void 0===L||L.reset(),S(!1)}),[M.current,z]);const Z=(0,n.useCallback)((()=>{S(!0)}),[]),F=(0,n.useCallback)((()=>{M.current&&M.current.resetZoom()}),[]),O=(0,n.useCallback)((()=>!!M.current&&M.current.isZoomed()),[]),$=(0,n.useCallback)((e=>{M.current&&M.current.setScale(e)}),[]),T=(0,n.useCallback)((()=>{j.current.setDisabled(!0)}),[]),Y=(0,n.useCallback)((()=>{j.current.setDisabled(!1)}),[]),G=(0,n.useRef)({clearLater:Z,resetZoom:F,isZoomed:O,setScale:$,setMouseInteractionCursor:k,captureMouseInteraction:T,releaseMouseInteraction:Y}),H=(0,n.useRef)(null);n.useEffect((()=>{if(void 0===e.onKeyDown||null===H.current)return()=>{};function t(t){var r;t instanceof KeyboardEvent&&(null===(r=e.onKeyDown)||void 0===r||r.call(e,t))}return H.current.addEventListener("keydown",t),()=>{null!==H.current&&H.current.removeEventListener("keydown",t)}}),[H.current,e.onKeyDown]),(0,n.useImperativeHandle)(b,(()=>({actions:G.current,mouseInteractionOverlay:j.current})),[]);const P=(0,n.useRef)({userInteraction:!1,ignoreNextCallback:!1}),W=(0,n.useCallback)((0,l.debounce)((e=>{void 0!==V&&(P.current.userInteraction=!0,V({centerX:e.center.x,centerY:e.center.y,scale:e.scale.x}),P.current.userInteraction=!1)}),500,{maxWait:3e3,trailing:!0}),[]),X=(0,n.useCallback)(((e,t)=>{P.current.ignoreNextCallback?P.current.ignoreNextCallback=!1:W({center:e,scale:t})}),[W]);return(0,n.useEffect)((()=>{if(!P.current.userInteraction&&void 0!==D){var e;const{centerX:t,centerY:r,scale:n}=D;null===(e=M.current)||void 0===e||e.updateCameraViewpoint({center:new d.Vector3(t,r,0),scale:new d.Vector3(n,n,1)}),P.current.ignoreNextCallback=!0}}),[D]),(0,a.jsx)("figure",{ref:H,className:`linearviscanvas ${x?"show-axes":""} ${r}`,tabIndex:e.tabIndex,"aria-label":h,"data-keep-canvas-colors":!0,children:(0,a.jsx)(i.Ic,{title:h,showAxes:x,abscissaConfig:w,ordinateConfig:g,...C,children:(0,a.jsxs)(v.Provider,{value:{overlayCursor:E,mouseMode:m,mouseInteractionOverlay:j.current,actions:G.current},children:[(0,a.jsx)(f,{cursor:R}),(0,a.jsx)(o.Z,{ref:M,onVisViewpointChange:X}),(0,a.jsx)(c,{zoomMode:"zoom"===m,panMode:"pan"===m,disabled:void 0!==E||"pan"!==m&&"zoom"!==m}),(0,a.jsx)(u.H,{children:p})]})})})}},42506:(e,t,r)=>{r.d(t,{H:()=>l,P:()=>d});var n=r(20837),i=r(70775),o=r(15568),s=r(26799),a=r(69521);const c={sx:0,sy:0,centerX:0,centerY:0,matrix:(new o.Matrix4).identity()},u=(0,n.createContext)(null);function d(){const e=(0,n.useContext)(u);if(!e)throw new Error("No LinearVisGroup context are avaialble");return e.current}function l(e){const t=(0,n.useRef)(c),{children:r}=e,{abscissaConfig:o,ordinateConfig:d,visSize:l}=(0,i.ki)(),{width:h,height:f}=l,{scaleType:v=i.N3.Linear}=o,{scaleType:p=i.N3.Linear}=d;if(v!==i.N3.Linear||p!==i.N3.Linear)throw new Error("VisGroup supports only linear axes");(0,s.C)((e=>{let{camera:r}=e;const n=(o.flip?-1:1)*h/(o.visDomain[1]-o.visDomain[0]),i=(d.flip?-1:1)*f/(d.visDomain[1]-d.visDomain[0]),s=.5*(o.visDomain[0]+o.visDomain[1]),a=.5*(d.visDomain[0]+d.visDomain[1]);t.current.sx=n,t.current.sy=i,t.current.centerX=s,t.current.centerY=a,t.current.matrix=t.current.matrix.makeScale(n,i,0)}),-100);const m=(o.flip?-1:1)*h/(o.visDomain[1]-o.visDomain[0]),y=(d.flip?-1:1)*f/(d.visDomain[1]-d.visDomain[0]),b=.5*(o.visDomain[0]+o.visDomain[1]),x=.5*(d.visDomain[0]+d.visDomain[1]);return t.current.sx=m,t.current.sy=y,t.current.centerX=b,t.current.centerY=x,t.current.matrix=t.current.matrix.makeScale(m,y,0),(0,a.jsx)(u.Provider,{value:t,children:(0,a.jsx)("group",{position:[-b*m,-x*y,0],scale:[m,y,1],children:r})})}},25263:(e,t,r)=>{function n(e){const t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?Number.NaN:1/0:2**(t-15)*(1+r/1024):r/1024*6103515625e-14)}r.d(t,{S:()=>i,m:()=>n});class i{constructor(e,t){if(this.shape=void 0,this.dimension=void 0,this.data=void 0,this.dtype=void 0,2!==t.length)throw new Error(`Unsupported dimension ${t.length} with NdFloat16Array`);this.data=e,this.shape=t,this.dimension=t.length,this.dtype="float16"}index(){if(arguments.length!==this.dimension)throw new Error(`Expected ${this.dimension} for indexing`);return(arguments.length<=1?void 0:arguments[1])+(arguments.length<=0?void 0:arguments[0])*this.shape[1]}getRaw(){const e=this.index(...arguments);return this.data[e]}get(){return n(this.getRaw(...arguments))}}},43674:(e,t,r)=>{r.d(t,{G:()=>i});var n=r(70775);class i{constructor(e,t,r){if(this.shape=void 0,this.dimension=void 0,this.data=void 0,this.dtype=void 0,this.transfer=void 0,2!==t.length)throw new Error(`Unsupported dimension ${t.length} with NdNormalizedUint8Array`);this.data=e,this.transfer=r,this.shape=t,this.dimension=t.length,this.dtype="uint8"}index(){if(arguments.length!==this.dimension)throw new Error(`Expected ${this.dimension} for indexing`);return(arguments.length<=1?void 0:arguments[1])+(arguments.length<=0?void 0:arguments[0])*this.shape[1]}getRaw(){const e=this.index(...arguments);return this.data[e]}get(){const e=this.getRaw(...arguments),{min:t,max:r,normalization:i}=this.transfer,o=e*(r-t)/255+t;switch(i){case n.N3.Linear:return o;case n.N3.Log:return Math.exp(o);case n.N3.Sqrt:return o**2;default:return Number.NaN}}}},37668:(e,t,r)=>{r.d(t,{y:()=>i});var n=r(20837);function i(e){const[t,r]=(0,n.useState)(e),[i,o]=(0,n.useState)("zoom");(0,n.useEffect)((()=>{"pan"!==t&&"zoom"!==t||o(t)}),[t,o]);const s=(0,n.useCallback)((()=>{r(i)}),[i]),a=(0,n.useCallback)((e=>{r(e!==t?e:i)}),[t,i,r]);return{mouseMode:t,setMouseMode:r,resetMouseMode:s,setOrResetMouseMode:a,defaultMouseMode:i,setDefaultMouseMode:o}}},7842:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(43046),i=r(26799),o=r(20837),s=r(15568),a=r(48542),c=r(84009);const u=(0,o.forwardRef)(((e,t)=>{const{onVisViewpointChange:r}=e,u=(0,i.A)((e=>e.camera)),d=(0,i.A)((e=>e.invalidate)),l=(0,a.Hl)(),h=(0,a.oA)(),[f,{inc:v}]=(0,n.C)(),p=(0,o.useRef)(0),m=(0,o.useRef)({center:new s.Vector3,scale:new s.Vector3});return(0,o.useLayoutEffect)(d,[f,d]),(0,o.useImperativeHandle)(t,(()=>({getCameraViewpoint:()=>h(),updateCameraViewpoint:e=>{const{position:t,scale:r}=l(e);(0,c.RC)(u.position,t,1e-10,1e-10)&&(0,c.RC)(u.scale,r,1e-10,1e-10)||(u.position.copy(t),u.scale.copy(r),u.updateMatrixWorld(),v())},setScale:e=>{u.scale.x=e,u.scale.y=e,u.updateMatrixWorld(),v()},isZoomed:()=>u.scale.x<1||u.scale.y<1,resetZoom:()=>{u.scale.x=1,u.scale.y=1,u.position.x=0,u.position.y=0,u.updateMatrixWorld(),v()}}))),(0,i.C)((()=>{if(p.current===f){if(void 0!==r){const{center:e,scale:t}=h(),n=m.current;m.current={center:e,scale:t},(0,c.RC)(n.center,e,1e-10,1e-10)&&(0,c.RC)(n.scale,t,1e-10,1e-10)||r(e,t)}}else p.current=f})),null}))},4363:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(10827),i=r(18578),o=r(69521);function s(e){const{mouseModeInteraction:t}=e,{mouseMode:r,setMouseMode:s}=t;return(0,o.jsxs)(n.Z,{children:[(0,o.jsx)(i.Z,{variant:"zoom"===r?"primary":"secondary",title:"Zoom on the scene and edit the ROIs",onClick:()=>{s("zoom")},children:(0,o.jsx)("i",{className:"fa fa-search fa-fw fa-lg"})}),(0,o.jsx)(i.Z,{variant:"pan"===r?"primary":"secondary",title:"Pan on the scene and edit the ROIs",onClick:()=>{s("pan")},children:(0,o.jsx)("i",{className:"fa fa-arrows fa-fw fa-lg"})})]})}},94117:(e,t,r)=>{r.d(t,{V:()=>i});r(20837);var n=r(15568);function i(e,t){if("string"===typeof e){if(""===e)return new n.Vector4(0,0,0,0);if("transparent"===e)return new n.Vector4(0,0,0,0);if(e.startsWith("#")&&9===e.length){const r=Number(`0x${e.slice(1,3)}`)/255,i=Number(`0x${e.slice(3,5)}`)/255,o=Number(`0x${e.slice(5,7)}`)/255,s=Number(`0x${e.slice(7,9)}`)/255;return new n.Vector4(r,i,o,s*(null!==t&&void 0!==t?t:1))}}const r=new n.Color(e);return new n.Vector4(r.r,r.g,r.b,null!==t&&void 0!==t?t:1)}},48542:(e,t,r)=>{r.d(t,{Hl:()=>l,I5:()=>d,oA:()=>h,rB:()=>f});var n=r(70775),i=r(96956),o=r(20837),s=r(26799),a=r(15568),c=r(43285),u=r(84009);function d(e){return(0,o.useMemo)((()=>(0,u.Rj)(e)),[e])}function l(){const e=(0,s.A)((e=>e.camera)),{dataToWorld:t,abscissaConfig:r,ordinateConfig:i,visSize:c}=(0,n.ki)(),{width:u,height:d}=c;return(0,o.useCallback)((n=>{const{center:o,scale:s}=n,c=t(o),l=s.x*u/Math.abs(r.visDomain[1]-r.visDomain[0]),h=s.y*d/Math.abs(i.visDomain[1]-i.visDomain[0]);return{position:new a.Vector3(c.x,c.y,e.position.z),scale:new a.Vector3(l,h,e.scale.z)}}),[e,t,r,i,u,d])}function h(){const{width:e,height:t}=(0,s.A)((e=>e.size)),r=(0,s.A)((e=>e.camera)),{getVisibleDomains:o}=(0,n.ki)();return()=>{const{xVisibleDomain:n,yVisibleDomain:s}=o(r);return{center:new a.Vector3((0,i.sum)(n),(0,i.sum)(s)).multiplyScalar(.5),scale:new a.Vector3(Math.abs(n[1]-n[0])/e,Math.abs(s[1]-s[0])/t,1)}}}function f(){return(0,c.Z)(void 0,{behavior:"destroyFuture",historyLimit:50,ignoreIdenticalMutations:!0})}},84009:(e,t,r)=>{r.d(t,{RC:()=>h,Rj:()=>u,Us:()=>c,d4:()=>d,pi:()=>f});var n=r(70775),i=r(96956),o=r(15568),s=r(25263),a=r(43674);function c(e){return"string"===typeof(t=e)&&Object.values(n.N3).includes(t)?e:e[0];var t}function u(e){const{values:t,bins:r}=e,n=t.findIndex((e=>0!==e));if(-1===n)return{...e,values:new Float64Array,bins:new Float64Array};const o=(0,i.findLastIndex)(t,(e=>0!==e))+1;return 0===n&&o===t.length?e:{...e,values:t.slice(n,o),bins:r.slice(n,o+1)}}function d(e){return(t=e)instanceof Object&&"y"in t?e:new o.Vector2(e[0],e[1]);var t}function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-8;return Math.abs(e-t)<=n+r*Math.abs(t)}function h(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-8;return l(e.x,t.x,r,n)&&l(e.y,t.y,r,n)&&l(e.z,t.z,r,n)}function f(e){if(void 0!==e){if(2!==e.dimension)throw new Error("A 2d array is expected");e instanceof a.G||e instanceof s.S||function(e){if(e.constructore===Float32Array)throw new Error("A Float32Array is expected")}(e.data)}}},60687:(e,t,r)=>{r.d(t,{AA:()=>d,Os:()=>c,UZ:()=>v,WU:()=>f,Yk:()=>p,cy:()=>m,hO:()=>a,pm:()=>u,x7:()=>h});var n=r(97133),i=r.n(n),o=r(20837),s=r(25263);function a(e){var t;const r=`<${e.slice(1)}`;return null!==(t={"<f1":"<f4","<f2":"<f4","<i8":"<i4","<u8":"<u4"}[r])&&void 0!==t?t:r}function c(e,t){const r={"<f4":Float32Array,"<f8":Float64Array,"<i1":Int8Array,"|i1":Int8Array,i1:Int8Array,"<i2":Int16Array,"<i4":Int32Array,"<u1":Uint8Array,"|u1":Uint8Array,u1:Uint8Array,"<u2":Uint16Array,"<u4":Uint32Array}[t];if(!r)throw new Error(`Unsupported dtype: ${t}`);if(e instanceof Uint8Array){const t=r.BYTES_PER_ELEMENT;try{return new r(e.buffer,e.byteOffset,e.byteLength/t)}catch{return console.warn(`toTypedArray is using a memory copy for a '${r}'. Probably because the buffer is not properly aligned.`),new r(e)}}return new r(e)}function u(e,t,r){const n=t.reduce(((e,t)=>e*t));let o;switch(r){case"<f2":o=2*n===e.byteLength?Uint16Array:Float32Array;break;case"<f4":o=Float32Array;break;case"<f8":o=Float64Array;break;case"<i1":case"|i1":case"i1":o=Int8Array;break;case"<i2":o=Int16Array;break;case"<i4":case"<i8":o=Int32Array;break;case"<u1":case"|u1":case"u1":o=Uint8Array;break;case"<u2":o=Uint16Array;break;case"<u4":case"<u8":o=Uint32Array;break;default:throw new Error(`Unsupported dtype: ${r}`)}return i()(new o(e),t)}function d(e){return"float32"===e.dtype?e:i()(Float32Array.from(e.data),e.shape)}function l(e){return e instanceof Object&&"data"in e&&"stride"in e&&"shape"in e}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Expected NdArray<TypedArray>";if(!l(e))throw new Error(t)}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Expected NdArray<TypedArray> or NdFloat16Array";if(!l(e)&&!(e instanceof s.S))throw new Error(t)}function v(e){if(3!==e.length)throw new Error(`Unsupported dtype format ${e}`);return{byteorder:e[0],type:e[1],itemsize:Number.parseInt(e[2]),numpy:e}}function p(e,t,r){return(0,o.useMemo)((()=>function(e,t,r){if(1!==e.dimension)throw new Error("Slicing only supported for 1dim array");const n=e.data.subarray(t,r);return i()(n,[r-t])}(e,t,r)),[e,t,r])}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Expected number[]";if(!function(e){if(!Array.isArray(e))return!1;for(const t of e)if("number"!==typeof t)return!1;return!0}(e))throw new Error(t)}}}]);
//# sourceMappingURL=89.6eba840d.chunk.js.map