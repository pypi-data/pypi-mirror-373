"use strict";(self.webpackChunkdaiquiri_ui=self.webpackChunkdaiquiri_ui||[]).push([[984],{18680:(e,n,a)=>{a.d(n,{Z:()=>s});var i=a(70775),t=a(20837);const s=function(e){const{onClick:n,threshold:a=4}=e,{worldToData:s}=(0,i.ki)(),[r,o]=(0,t.useState)(null),l=(0,t.useCallback)((e=>{const{htmlPt:n}=e;o(n)}),[o]),c=(0,t.useCallback)((e=>{if(!r)return!1;const{htmlPt:n}=e;return Math.max(Math.abs(n.x-r.x),Math.abs(n.y-r.y))<=a}),[r,a]),d=(0,t.useCallback)((e=>{c(e)||o(null)}),[c,o]),m=(0,t.useCallback)((e=>{c(e)&&n(e)}),[c,n,n,s]);return(0,i.iq)("pointerdown",l),(0,i.iq)("pointermove",d),(0,i.iq)("pointerup",m),null}},30:(e,n,a)=>{a.d(n,{z:()=>c});var i=a(20837),t=a(40714),s=a(70775),r=a(37185),o=a(21681);var l=a(69521);function c(e){const[n,a]=function(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[i,t]=(0,o.F)(e);return[i,(0,r.y)(t,[],n,a)]}({loading:e.loading,info:e.info,warning:e.warning,danger:e.danger},500);return(0,i.useEffect)((()=>{a({loading:e.loading,warning:e.warning,danger:e.danger,info:e.info})}),[e.loading,e.info,e.warning,e.danger]),n.loading||n.danger||n.warning||n.info?(0,l.jsx)(s.aV,{style:{zIndex:200},children:(0,l.jsxs)("div",{style:{textAlign:"center"},children:[n.loading&&(0,l.jsxs)(t.Z,{variant:"warning",style:{marginLeft:"auto",marginRight:"auto",marginTop:"2em",display:"inline-block"},children:[(0,l.jsx)("i",{className:"fa fa-spinner fa-solid fa-pulse"})," Loading"]}),!n.loading&&n.danger&&(0,l.jsx)(t.Z,{variant:"danger",style:{marginLeft:"auto",marginRight:"auto",marginTop:"2em",display:"inline-block"},children:n.danger}),!n.loading&&!n.danger&&n.warning&&(0,l.jsx)(t.Z,{variant:"warning",style:{marginLeft:"auto",marginRight:"auto",marginTop:"2em",display:"inline-block"},children:n.warning}),n.info&&(0,l.jsx)(t.Z,{variant:"info",style:{marginLeft:"auto",marginRight:"auto",marginTop:"2em",display:"inline-block"},children:n.info})]})}):(0,l.jsx)(l.Fragment,{})}},39310:(e,n,a)=>{a.d(n,{v:()=>u});var i=a(70775),t=a(20837),s=a(26799),r=a(69521);const o=t.forwardRef(((e,n)=>{let{children:a,percentLocation:o}=e;const l=t.useRef(null);t.useImperativeHandle(n,(()=>l.current),[]);const c=(0,i.ki)();return(0,s.C)((e=>{let{camera:n}=e;const a=l.current;if(!a)return;const i=c.getVisibleDomains(n),t=i.xVisibleDomain[0]+(i.xVisibleDomain[1]-i.xVisibleDomain[0])*(o[0]/100),s=i.yVisibleDomain[0]+(i.yVisibleDomain[1]-i.yVisibleDomain[0])*(1-o[1]/100);a.position.x=t,a.position.y=s})),(0,r.jsx)("group",{ref:l,children:(0,r.jsx)("group",{children:a})})}));var l=a(94443),c=a(62958),d=a.n(c),m=a(17e3);function u(e){const{unit:n,percentWidth:a=30,percentLocation:t=75}=e,s=(0,i.ki)(),{width:c}=s.canvasSize,u=(0,i.Jk)((e=>{const i=s.getVisibleDomains(e),{xVisibleDomain:r,yVisibleDomain:o}=i,l=r[1]-r[0],u=c/Math.abs(l),x=function(e){const n=10**Math.ceil(Math.log10(e)),a=e/n;return a>=1?Number(n):a>=.5?.5*n:a>=.25?.25*n:a>=.1?.1*n:e}(Math.abs(l)*a/100),h=x*u,p=r[0]+l*t/100,f=o[1];const v=function(e,n){return"px"===n?`${e} ${n}`:`${(0,m.A)(new(d())(e,"mm")).toPrec(.1)}`}(x,n);return{pixelRange:h,dataRange:x,dataX:p,dataY:f,text:v}}),[n,c,a,t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.q6,{x:u.dataX,y:u.dataY,style:{color:"black"},children:(0,r.jsx)("div",{style:{top:"50%",left:"50%",position:"relative",transform:"translate(-100%, 0%)",borderRadius:5,paddingLeft:5,paddingRight:5,backgroundColor:"#FFFFFF80",fontWeight:"bold",fontSize:"100%",zIndex:100},children:u.text})}),(0,r.jsx)(o,{percentLocation:[t,0],children:(0,r.jsx)(l.b,{children:(0,r.jsxs)("group",{"position-y":26,children:[(0,r.jsxs)("mesh",{position:[0,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[u.pixelRange,4,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"white",opacity:1})]}),(0,r.jsxs)("mesh",{position:[.5*u.pixelRange,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[4,12,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"white",opacity:1})]}),(0,r.jsxs)("mesh",{position:[.5*-u.pixelRange,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[4,12,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"white",opacity:1})]}),(0,r.jsxs)("mesh",{position:[0,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[u.pixelRange,2,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"black",opacity:1})]}),(0,r.jsxs)("mesh",{position:[.5*u.pixelRange,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[2,10,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"black",opacity:1})]}),(0,r.jsxs)("mesh",{position:[.5*-u.pixelRange,0,0],children:[(0,r.jsx)("ambientLight",{}),(0,r.jsx)("planeGeometry",{attach:"geometry",args:[2,10,1,1]}),(0,r.jsx)("meshBasicMaterial",{attach:"material",transparent:!0,color:"black",opacity:1})]})]})})})]})}},43039:(e,n,a)=>{a.d(n,{Z:()=>r});var i=a(6447),t=a(58421),s=a(69521);function r(e){const{centerX:n,centerY:a,width:r,height:o}=e,l=.5*r,c=.5*o;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{y:a,x1:n,x2:n-l,color:e.color,gapColor:e.gapColor,dashSize:e.dashSize,gapSize:e.gapSize,lineWidth:e.lineWidth,zIndex:e.zIndex}),(0,s.jsx)(i.A,{y:a,x1:n,x2:n+l,color:e.color,gapColor:e.gapColor,dashSize:e.dashSize,gapSize:e.gapSize,lineWidth:e.lineWidth,zIndex:e.zIndex}),(0,s.jsx)(t.D,{x:n,y1:a,y2:a+c,color:e.color,gapColor:e.gapColor,dashSize:e.dashSize,gapSize:e.gapSize,lineWidth:e.lineWidth,zIndex:e.zIndex}),(0,s.jsx)(t.D,{x:n,y1:a,y2:a-c,color:e.color,gapColor:e.gapColor,dashSize:e.dashSize,gapSize:e.gapSize,lineWidth:e.lineWidth,zIndex:e.zIndex})]})}},45874:(e,n,a)=>{a.d(n,{i:()=>d});var i=a(26799),t=a(20837),s=a(15568),r=a(94117),o=a(94443),l=a(69521);class c extends s.ShaderMaterial{constructor(){super({uniforms:{color:{value:new s.Vector4},lineWidth:{value:0},sizeInScreen:{value:0}},vertexShader:"\nout vec2 pixelCoord;\n\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    pixelCoord = vec2(position.x, position.y);\n}\n      ",fragmentShader:"\nuniform vec4 color;\nuniform float lineWidth;\nuniform float sizeInScreen;\nin vec2 pixelCoord;\n\n/**\n * Exact signed distance function to compute an\n * orthogonal rectangle.\n *\n * @param pos: Pixel position\n * @param center: Center of the rectangle\n * @param size: Size of the rectangle\n */\nfloat sdf_rect(vec2 pos, vec2 center, vec2 size) {\n    vec2 d = abs(pos - center) - size * 0.5;\n    return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n}\n\nvoid main() {\n  float d1 = sdf_rect(\n    pixelCoord,\n    vec2(0.0, 0.0),\n    vec2(abs(sizeInScreen), lineWidth)\n  );\n  float d2 = sdf_rect(\n    pixelCoord,\n    vec2(0.0, 0.0),\n    vec2(lineWidth, abs(sizeInScreen))\n  );\n  float d = min(d1, d2);\n\n  if (d > 0.2) {\n    discard;\n  }\n\n  float alpha;\n  if (lineWidth >= 1.0) {\n    alpha = smoothstep(0.2, 0.0, d);\n  } else {\n    // simulate line thiner than 1px with alpha\n    alpha = lineWidth;\n  }\n\n  gl_FragColor = vec4(color.r, color.g, color.b, alpha * color.a);\n}\n      "})}}function d(e){const{x:n,y:a,color:s="black",opacity:c,sizeInScreen:d,lineWidth:m=1,zIndex:u=0}=e,x=(0,t.useRef)(null);return(0,t.useEffect)((()=>{const e=(0,r.V)(s,c);if(x.current){const n=x.current.uniforms;n.color.value=e,n.lineWidth.value=m,n.sizeInScreen.value=d,(0,i.l)()}}),[s,c,m,d]),(0,l.jsx)("group",{position:[n,a,u],children:(0,l.jsx)(o.b,{children:(0,l.jsxs)("mesh",{children:[(0,l.jsx)("ambientLight",{}),(0,l.jsx)("planeGeometry",{attach:"geometry",args:[d+m,d+m,1,1]}),(0,l.jsx)("crossMarkerMaterial",{attach:"material",transparent:!0,ref:x})]})})})}(0,i.e)({CrossMarkerMaterial:c})},6447:(e,n,a)=>{a.d(n,{A:()=>d});var i=a(26799),t=a(20837),s=a(15568),r=a(42506),o=a(94117),l=a(69521);class c extends s.ShaderMaterial{constructor(){super({uniforms:{color:{value:new s.Vector4},gapColor:{value:new s.Vector4},dashSize:{value:0},gapSize:{value:0},scaleX:{value:0},scaleY:{value:0},size:{value:0},lineWidth:{value:0}},vertexShader:"\nuniform float scaleX;\nuniform float scaleY;\nuniform float size;\nout vec2 pixelCoord;\n\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    vec2 pixelScale = vec2(scaleX, scaleY);\n    pixelCoord = vec2(position.x + size * 0.5, position.y) / pixelScale;\n}\n      ",fragmentShader:"\nuniform vec4 color;\nuniform vec4 gapColor;\nuniform float gapSize;\nuniform float dashSize;\nuniform float lineWidth;\n\nin vec2 pixelCoord;\n\nvoid main() {\n    float alpha;\n    if (lineWidth >= 1.0) {\n        alpha = smoothstep(lineWidth * 0.5 + 0.01, lineWidth * 0.5 - 0.1, abs(pixelCoord.y));\n    } else {\n        // simulate line thiner than 1px with alpha\n        alpha = lineWidth;\n    }\n\n    if (dashSize == 0.0) {\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha * color.a);\n        return;\n    }\n\n    float dist = abs(pixelCoord.x);\n    dist = mod(dist, (dashSize + gapSize));\n    if (dist <= dashSize) {\n        gl_FragColor = vec4(color.r, color.g, color.b, alpha * color.a);\n    } else {\n        gl_FragColor = vec4(gapColor.r, gapColor.g, gapColor.b, alpha * gapColor.a);\n    }\n}\n      "})}}function d(e){const{y:n,x1:a,x2:s,lineWidth:c=1,color:d="black",gapColor:m,dashSize:u=0,gapSize:x=u,opacity:h=1,zIndex:p=0}=e,f=(0,t.useRef)(null),v=s-a,g=.5*(a+s),j=t.useRef(null),y=(0,r.P)();return(0,t.useEffect)((()=>{const e=(0,o.V)(d,h),n=(0,o.V)(null!==m&&void 0!==m?m:"transparent",h);if(f.current){const a=f.current.uniforms;a.color.value=e,a.gapColor.value=n,a.dashSize.value=u,a.gapSize.value=x,a.size.value=v,a.lineWidth.value=c,(0,i.l)()}}),[d,m,u,x,h,v,c]),(0,i.C)((e=>{let{camera:n}=e;if(null===j.current||null===f.current)return;const a=n.scale.x/y.sx,i=n.scale.y/y.sy;j.current.scale.y=i;const t=f.current.uniforms;t.scaleX.value=a,t.scaleY.value=1})),(0,l.jsx)("group",{ref:j,position:[g,n,p],children:(0,l.jsxs)("mesh",{children:[(0,l.jsx)("ambientLight",{}),(0,l.jsx)("planeGeometry",{attach:"geometry",args:[Math.abs(v),c+1,1,1]}),(0,l.jsx)("hDashMaterial",{attach:"material",transparent:!0,ref:f})]})})}(0,i.e)({HDashMaterial:c})},64700:(e,n,a)=>{a.d(n,{e:()=>t});var i=a(93014);function t(){return{...(0,i.y)({name:"tomo/defaultcolormap"})}}},60676:(e,n,a)=>{a.d(n,{Z:()=>p});var i=a(70775),t=a(82794),s=a(91328),r=a(18578),o=a(86912),l=a(38213),c=a(10827),d=a(99146),m=a(38243),u=a(61283),x=a(69521);function h(e){if(!e.array||!e.array.info)return(0,x.jsx)(x.Fragment,{});const n=e.array.info;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",children:"Info"})}),(0,x.jsxs)(t.Z,{children:[(0,x.jsx)(s.Z,{children:(0,x.jsx)("h6",{children:"Shape"})}),(0,x.jsx)(s.Z,{children:(i=e.array.array.shape,i.map((e=>`${e}`)).join(" \xd7 "))})]}),(0,x.jsxs)(t.Z,{children:[(0,x.jsx)(s.Z,{children:(0,x.jsx)("h6",{children:"Profile"})}),(0,x.jsx)(s.Z,{children:n.profile})]}),(0,x.jsxs)(t.Z,{children:[(0,x.jsx)(s.Z,{children:(0,x.jsx)("h6",{children:"Size"})}),(0,x.jsx)(s.Z,{children:(a=n.byteLength,a<1e3?`${a} B`:a<1e5?`${(a/1e3).toFixed(1)} KB`:`${(a/1e6).toFixed(1)} MB`)})]}),(0,x.jsxs)(t.Z,{children:[(0,x.jsx)(s.Z,{children:(0,x.jsx)("h6",{title:"Data type of the source",children:"Type"})}),(0,x.jsx)(s.Z,{children:n.dtype})]})]});var a,i}function p(e){const{as:n,showDisplayed:a=!0}=e;function s(n,a){const i=e.lut===n?"primary":"secondary";return(0,x.jsx)(r.Z,{variant:i,onClick:()=>{e.onSelectLut(n)},className:"text-nowrap",title:a,size:"sm",children:(0,x.jsx)(u.FR,{name:n})})}function p(n){const a=e.autoscaleMode===n,i=a&&e.autoscale?"primary":a?"warning":"secondary",t={[m.me.Minmax]:"Minmax",[m.me.StdDev3]:"3\xd7std",[m.me.None]:"Manual"}[n];return(0,x.jsx)(r.Z,{variant:i,onClick:()=>{e.onSelectAutoscaleMode(n),e.onSelectAutoscale(!0)},size:"sm",children:t})}function f(n,a){const i=e.norm===n?"primary":"secondary";return(0,x.jsx)(r.Z,{variant:i,onClick:()=>{e.onSelectNorm(n)},size:"sm",children:a})}function v(n,a,i){const t=e.profile===n?"primary":"secondary";return(0,x.jsx)(r.Z,{variant:t,onClick:()=>{e.onSelectProfile(n)},size:"sm",title:i,children:a})}return(0,x.jsxs)(o.Z,{as:n,className:""+("up"===e.dropDirection?"dropup":""),children:[(0,x.jsxs)(o.Z.Toggle,{id:"dropdown-basic",variant:e.variant,className:"d-flex align-items-center",children:[(0,x.jsx)("i",{className:"fa fam-hardware-camera fa-lg me-1"}),e.isDisplayed&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.FR,{name:e.lut}),(0,x.jsx)(u.Q7,{scale:e.norm}),e.autoscale&&(0,x.jsx)(u.gf,{autoscale:e.autoscaleMode})]})]}),(0,x.jsx)(o.Z.Menu,{className:"dropdown-menu-center",children:(0,x.jsx)("div",{className:"ms-1 me-1",children:(0,x.jsxs)(l.Z,{children:[a&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",children:"Detector"})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const n=e.isDisplayed?"primary":"secondary";return(0,x.jsx)(r.Z,{variant:n,onClick:()=>{e.onSelectDisplayed(!e.isDisplayed)},size:"sm",children:"Display detector data"})}()})})]}),(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",children:"Lookup table"})}),(0,x.jsx)(t.Z,{children:(0,x.jsxs)(c.Z,{className:"flex-grow-1",children:[s("Greys","Gray"),s("Viridis","Viridis"),s("Cividis","Cividis"),s("Magma","Magma"),s("Inferno","Inferno"),s("Plasma","Plasma")]})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const n=e.isInverted?"primary":"secondary";return(0,x.jsxs)(r.Z,{variant:n,onClick:()=>{e.onSelectInvertion(!e.isInverted)},size:"sm",children:[(0,x.jsx)("i",{className:"fa fa-fw fa-arrows-alt-v"})," Inverted LUT"]})}()})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",children:"Auto scale"})}),(0,x.jsx)(t.Z,{children:(0,x.jsxs)(c.Z,{className:"flex-grow-1 mt-1",children:[p(m.me.Minmax),p(m.me.StdDev3)]})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const n=e.autoscale?"primary":"secondary";return(0,x.jsxs)(r.Z,{variant:n,onClick:()=>{e.onSelectAutoscale(!e.autoscale)},size:"sm",children:[(0,x.jsx)("i",{className:"fa-solid fa-circle-half-stroke fa-fw fa-lg"})," Auto scale enabled"]})}()})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",children:"Normalization"})}),(0,x.jsx)(t.Z,{children:(0,x.jsxs)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:[f(i.N3.Linear,"Linear"),f(i.N3.Log,"Log"),f(i.N3.SymLog,"SymLog")]})}),(0,x.jsx)(t.Z,{children:(0,x.jsx)("h6",{className:"flex-grow-1 text-center",title:"How to transfer the data",children:"Profile"})}),(0,x.jsx)(t.Z,{children:(0,x.jsxs)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:[v(d.rS.Raw,"Raw","Transfer data as it is provided by the detector or the processing"),v(d.rS.F16,"Float 16b","Transfer data as float 16-bits"),v(d.rS.U8,"8-bits","Transfer data as 8-bits")]})}),(0,x.jsx)(h,{array:e.array})]})})})]})}},3471:(e,n,a)=>{a.d(n,{J:()=>m,h:()=>u});var i=a(20837),t=a(99146),s=a(38243),r=a(34718),o=a.n(r),l=a(70775),c=a(74773),d=a(19097);o()("daiquiri.components.tomo.utils.TomoDetector");function m(e){const n=(0,c.cO)();return(0,i.useMemo)((()=>{const a=function(){var n,a;if(e.sampleStage){const{detector:n}=e.sampleStage;return n?n.id:""}return null!==(n=null===(a=e.sampleStageRefs)||void 0===a?void 0:a.detector)&&void 0!==n?n:""}();return n[a]}),[e.sampleStage,n])}function u(e){const[n,a]=(0,t.ao)(),r=function(e,n,a){let t=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=(0,i.useRef)(),r=(0,i.useRef)();return(0,d.z)((()=>{s.current&&clearTimeout(s.current)})),(0,i.useMemo)((()=>{const n=(i,o)=>{r.current=void 0,e.apply(i,o),s.current=setTimeout((()=>{s.current=void 0,!t&&r.current&&(n(r.current.this,r.current.args),r.current=void 0)}),a)},i=function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];s.current?r.current={args:a,this:this}:n(this,a)};return Object.defineProperties(i,{length:{value:e.length},name:{value:`${e.name||"anonymous"}__throttled__${a}`}}),i}),[a,t,...n])}(a,[e.minRefreshPeriod,a],1e3*e.minRefreshPeriod,!0);return(0,i.useEffect)((()=>{var n;"u8"!==e.profile&&(e.enabled&&e.detector&&r({detector:e.detector,lut:"Cividis",autoscale:s.me.StdDev3,normalization:l.N3.Linear,process:null!==(n=e.processing)&&void 0!==n?n:t.uh.Flatfield,profiles:[e.profile],histogram:e.histogram}))}),[e.detector,r,e.enabled,e.profile,e.processing,e.histogram]),(0,i.useEffect)((()=>{var n;"u8"===e.profile&&(e.enabled&&e.detector&&r({detector:e.detector,lut:"Cividis",normalization:e.normalization,process:null!==(n=e.processing)&&void 0!==n?n:t.uh.Flatfield,profiles:[e.profile],histogram:e.histogram,...e.autoscale&&e.autoscaleMode!==s.me.None?{autoscale:e.autoscaleMode}:{vmin:e.domain[0],vmax:e.domain[1],autoscale:s.me.None}}))}),[e.detector,r,e.enabled,e.profile,e.processing,e.autoscale,e.autoscaleMode,e.normalization,e.domain[0],e.domain[1],e.histogram]),n}},44984:(e,n,a)=>{a.r(n),a.d(n,{default:()=>ue});var i=a(52799),t=a(34718),s=a.n(t),r=a(20837),o=a(10827),l=a(18578),c=a(99146),d=a(69521);function m(e){const{warningMessage:n,iconName:a}=e;return(0,d.jsx)(l.Z,{variant:(i=e.var,t=e.value,i===t?"primary":"secondary"),onClick:()=>{e.setter(e.value)},className:"text-nowrap",size:"sm",title:null!==n&&void 0!==n?n:e.title,children:(0,d.jsxs)("span",{className:"fa-stack fa-2x",children:[(0,d.jsx)("i",{className:`${a} fa-stack-1x`}),e.warningMessage&&(0,d.jsx)("i",{className:"fa-solid fa-xmark fa-stack-1x text-danger",title:n})]})});var i,t}function u(e){var n,a,i,t;return(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(m,{var:e.value,value:c.uh.Flatfield,setter:e.onSelect,title:"Display the last projection with flatfield correction",iconName:"fad fam-picture-dinosaur"}),(0,d.jsx)(m,{var:e.value,value:c.uh.Proj,setter:e.onSelect,title:"Display the last projection",warningMessage:void 0===(null===(n=e.detector)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.frame_no)?"No projection yet available":void 0,iconName:"fad fam-picture-flatfield-raw"}),(0,d.jsx)(m,{var:e.value,value:c.uh.Flat,setter:e.onSelect,title:"Display the flat used for the correction",warningMessage:void 0===(null===(i=e.detector)||void 0===i?void 0:i.flat)?"No flat yet available":void 0,iconName:"fad fam-picture-flatfield-flat"}),(0,d.jsx)(m,{var:e.value,value:c.uh.Dark,setter:e.onSelect,title:"Display the dark used for the correction",warningMessage:void 0===(null===(t=e.detector)||void 0===t?void 0:t.dark)?"No dark yet available":void 0,iconName:"fad fam-picture-flatfield-dark"})]})}var x=a(94708),h=a(86912),p=a(79008);function f(e){const{mouseMode:n,setOrResetMouseMode:a}=e,i=(0,p.pC)();function t(e,n){var a;return e?null!==(a=e.alias)&&void 0!==a?a:e.name:n}function s(e){if(!i)return"You must have the control to the session to move motors";if(!e)return"This motor is not available";if(!e.online)return"This motor is not online";const{state:n}=e.properties;return n.includes("READY")?void 0:`This motor is not ready (found ${e.properties.state})`}const r=s(e.sy),c=s(e.sz),m=s(e.sampy),u=t(e.sy,"sy"),x=t(e.sz,"sz"),f=t(e.sampy,"sampy");return(0,d.jsxs)(h.Z,{as:o.Z,className:e.className,children:[null!==e.sampy&&(0,d.jsxs)(l.Z,{variant:"sampy"===n?"danger":"secondary",onClick:()=>{null===a||void 0===a||a("sampy")},disabled:void 0!==m,title:m,children:[(0,d.jsx)("i",{className:"fa fam-arrow-h-over-rot"})," ",f]}),(0,d.jsxs)(l.Z,{variant:"sy"===n?"danger":"secondary",onClick:()=>{null===a||void 0===a||a("sy")},disabled:void 0!==r,title:r,children:[(0,d.jsx)("i",{className:"fa fam-arrow-h-under-rot"})," ",u]}),(0,d.jsxs)(l.Z,{variant:"sz"===n?"danger":"secondary",onClick:()=>{null===a||void 0===a||a("sz")},disabled:void 0!==c,title:c,children:[(0,d.jsx)("i",{className:"fa fa-arrows-v"})," ",x]})]})}var v=a(63887);function g(e){var n;const{sy:a,sz:i,sampy:t,tomoDetector:s,detector:r}=e;if(null===a||null===i)return null;const o=(0,v.DJ)(i),l=null!==(n=(0,v.kw)(t))&&void 0!==n?n:0;return{y:(0,v.DJ)(a)+l,z:o,fov:(0,v.WZ)(s,r)}}function j(e,n){var a,i,t,s,r;const{imagePixelSize:o,sampyPosition:l,syPosition:c,szPosition:d,detectorCenterY:m,detectorCenterZ:u}=n;if(null===o||"pixel"===o.units())return null;if(null===c||null===d)return null;const{sampleStage:x}=e,h=null!==(a=null===x||void 0===x?void 0:x.properties.detector_center)&&void 0!==a?a:[0,0],p=null!==(i=h[0])&&void 0!==i?i:0,f=null!==(t=h[1])&&void 0!==t?t:0,v=null!==(s=null===m||void 0===m?void 0:m.to("mm").scalar)&&void 0!==s?s:0,g=null!==(r=null===u||void 0===u?void 0:u.to("mm").scalar)&&void 0!==r?r:0,j=o.to("mm").scalar,y=c.to("mm").scalar,w=d.to("mm").scalar;return{y:y+(l?l.to("mm").scalar:0)+(p-v),z:w+(f-g),px:j}}var y=a(38243),w=a(70775),z=a(4363),S=a(3471),Z=a(2498),b=a(60676),M=a(38213),N=a(82794),C=a(91328);function k(e){return(0,d.jsx)(l.Z,{variant:(n=e.var,a=e.value,n===a?"primary":"secondary"),onClick:()=>{e.setter(e.value)},className:"text-nowrap",size:"sm",children:e.children});var n,a}function D(e){const{as:n,variant:a="secondary",config:i}=e;return(0,d.jsxs)(h.Z,{as:n,children:[(0,d.jsx)(h.Z.Toggle,{id:"dropdown-basic",variant:a,className:"d-flex align-items-center",children:(0,d.jsx)("i",{className:"fa fa-sliders fa-fw fa-lg"})}),(0,d.jsx)(h.Z.Menu,{className:"dropdown-menu-center",children:(0,d.jsx)("div",{className:"ms-1 me-1",style:{minWidth:"300px"},children:(0,d.jsxs)(M.Z,{children:[(0,d.jsxs)(N.Z,{children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Display axes"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.displayAxes,value:!0,setter:i.setDisplayAxes,children:"Yes"}),(0,d.jsx)(k,{var:i.displayAxes,value:!1,setter:i.setDisplayAxes,children:"No"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Follow"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.follow,value:"motors",setter:i.setFollow,children:"Motors"}),(0,d.jsx)(k,{var:i.follow,value:"last-image",setter:i.setFollow,children:"Last image"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Field of view"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.fieldOfView,value:1,setter:i.setFieldOfView,children:"\xd71"}),(0,d.jsx)(k,{var:i.fieldOfView,value:1.5,setter:i.setFieldOfView,children:"\xd71.5"}),(0,d.jsx)(k,{var:i.fieldOfView,value:2,setter:i.setFieldOfView,children:"\xd72"}),(0,d.jsx)(k,{var:i.fieldOfView,value:3,setter:i.setFieldOfView,children:"\xd73"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Crosshair"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.crossHair,value:!0,setter:i.setCrossHair,children:"Yes"}),(0,d.jsx)(k,{var:i.crossHair,value:!1,setter:i.setCrossHair,children:"No"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Mean level"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.displayMean,value:!0,setter:i.setDisplayMean,children:"Show"}),(0,d.jsx)(k,{var:i.displayMean,value:!1,setter:i.setDisplayMean,children:"Hide"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Timestamp"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.displayEpoch,value:!0,setter:i.setDisplayEpoch,children:"Show"}),(0,d.jsx)(k,{var:i.displayEpoch,value:!1,setter:i.setDisplayEpoch,children:"Hide"})]})})]}),(0,d.jsxs)(N.Z,{className:"mt-1",children:[(0,d.jsx)(C.Z,{className:"my-auto",children:"Histogram"}),(0,d.jsx)(C.Z,{xs:7,children:(0,d.jsxs)(o.Z,{children:[(0,d.jsx)(k,{var:i.displayHistogram,value:!0,setter:i.setDisplayHistogram,children:"Show"}),(0,d.jsx)(k,{var:i.displayHistogram,value:!1,setter:i.setDisplayHistogram,children:"Hide"})]})})]})]})})})]})}var I=a(64700),F=a(39310),P=a(18680),R=a(62958),W=a.n(R),L=a(35875);var V=a(30),H=a(42963),A=a(81079),T=a(74773),_=a(43162),Y=a(37668),O=a(95100),X=a(35802),$=a(17332),E=a(26799),q=a(15568),G=a(94117),B=a(94443);class U extends q.ShaderMaterial{constructor(){super({uniforms:{color:{value:new q.Vector4},lineWidth:{value:0},sizeXInScreen:{value:0},sizeYInScreen:{value:0},inner:{value:0}},vertexShader:"\nout vec2 pixelCoord;\n\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    pixelCoord = vec2(position.x, position.y);\n}\n      ",fragmentShader:"\nuniform vec4 color;\nuniform float lineWidth;\nuniform float sizeXInScreen;  // signed size\nuniform float sizeYInScreen;  // signed size\nuniform int inner;            // 0 or 1\n\nin vec2 pixelCoord;\n\n/**\n * Exact signed distance function to compute an\n * orthogonal rectangle.\n *\n * @param pos: Pixel position\n * @param center: Center of the rectangle\n * @param size: Size of the rectangle\n */\nfloat sdf_rect(vec2 pos, vec2 center, vec2 size) {\n    vec2 d = abs(pos - center) - size * 0.5;\n    return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n}\n\nvoid main() {\n  float is_inner = float(inner);\n  float d1 = sdf_rect(\n    pixelCoord,\n    vec2(\n      (sizeXInScreen - (1.0 - is_inner) * lineWidth * sign(sizeXInScreen)) * 0.5,\n      is_inner * lineWidth * sign(sizeYInScreen) * 0.5\n    ),\n    vec2(abs(sizeXInScreen), lineWidth)\n  );\n  float d2 = sdf_rect(\n    pixelCoord,\n    vec2(\n      is_inner * lineWidth * sign(sizeXInScreen) * 0.5,\n      (sizeYInScreen - (1.0 - is_inner) * lineWidth * sign(sizeYInScreen)) * 0.5\n    ),\n    vec2(lineWidth, abs(sizeYInScreen))\n  );\n  float d = min(d1, d2);\n\n  if (d > 0.2) {\n    discard;\n  }\n\n  float alpha;\n  if (lineWidth >= 1.0) {\n    alpha = smoothstep(0.2, 0.0, d);\n  } else {\n    // simulate line thiner than 1px with alpha\n    alpha = lineWidth;\n  }\n\n  gl_FragColor = vec4(color.r, color.g, color.b, alpha * color.a);\n}\n      "})}}function Q(e){const{x:n,y:a,color:i="black",opacity:t,sizeXInScreen:s,sizeYInScreen:o,lineWidth:l=1,inner:c=!1,zIndex:m=0}=e,u=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=(0,G.V)(i,t);if(u.current){const n=u.current.uniforms;n.color.value=e,n.lineWidth.value=l,n.sizeXInScreen.value=s,n.sizeYInScreen.value=o,n.inner.value=c?1:0,(0,E.l)()}}),[i,t,l,s,o,c]),(0,d.jsx)("group",{position:[n,a,m],children:(0,d.jsx)(B.b,{screenDirection:!1,children:(0,d.jsxs)("mesh",{children:[(0,d.jsx)("ambientLight",{}),(0,d.jsx)("planeGeometry",{attach:"geometry",args:[2*Math.abs(s)+l,2*Math.abs(o)+l,1,1]}),(0,d.jsx)("cornerMarkerMaterial",{attach:"material",transparent:!0,ref:u})]})})})}(0,E.e)({CornerMarkerMaterial:U});var J=a(45874),K=a(25775);const ee=s()("daiquiri.components.tomo.detectorview.ActualDetectorLocation");function ne(e){const{x:n,y:a,fov:i}=e,t=.5*i[0],s=.5*i[1];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Q,{x:n+t,y:a+s,sizeXInScreen:-40,sizeYInScreen:-40,color:K.Z.danger,lineWidth:4,inner:!0}),(0,d.jsx)(Q,{x:n-t,y:a-s,sizeXInScreen:40,sizeYInScreen:40,color:K.Z.danger,lineWidth:4,inner:!0}),(0,d.jsx)(Q,{x:n-t,y:a+s,sizeXInScreen:40,sizeYInScreen:-40,color:K.Z.danger,lineWidth:4,inner:!0}),(0,d.jsx)(Q,{x:n+t,y:a-s,sizeXInScreen:-40,sizeYInScreen:40,color:K.Z.danger,lineWidth:4,inner:!0})]})}function ae(e){var n;const{tomoHardware:a}=e,{detector:i}=a,t=g(a);if(null===t)return ee("Skipped: one of sy, sz is missing."),(0,d.jsx)(d.Fragment,{});const{y:s,z:r,fov:o}=t;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(J.i,{x:s,y:r,color:K.Z.danger,sizeInScreen:40,lineWidth:3,zIndex:.5}),(0,d.jsx)($.Z,{datapos:[s,r],color:K.Z.danger,text:"Beam",anchor:"top-right"}),null!==o&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)($.Z,{datapos:[s-.5*o[0],r-.5*o[1]],color:K.Z.danger,text:null!==(n=null===i||void 0===i?void 0:i.name)&&void 0!==n?n:"Detector",anchor:"top-right"}),(0,d.jsx)(ne,{x:s,y:r,fov:o})]})]})}var ie=a(43039),te=a(68108);s()("daiquiri.components.tomo.detectorview.DetectorPositionMesh");function se(e){var n;const{x:a,y:i,showMean:t,mean:s,showEpoch:o,epoch:l}=e,c=(0,r.useMemo)((()=>{if(void 0!==l)return new Date(1e3*l)}),[l]);if(!o&&(!t||void 0===s))return(0,d.jsx)(d.Fragment,{});return(0,d.jsxs)(w.q6,{x:a,y:i,children:[t&&void 0!==s&&(0,d.jsx)("div",{className:"ms-2 mt-2",title:"Mean grey level",children:(0,d.jsxs)("div",{className:"bg-dark text-light p-1 rounded font-tabular-nums",children:[(0,d.jsx)("i",{className:"fa-solid fa-circle-half-stroke fa-fw fa-lg"})," ",s.toFixed(2)]})}),o&&(0,d.jsx)("div",{className:"ms-2 mt-2",title:`Timestamp (${null!==(n=null===c||void 0===c?void 0:c.toUTCString())&&void 0!==n?n:"undefined"})`,children:(0,d.jsxs)("div",{className:"bg-dark text-light p-1 rounded font-tabular-nums",children:[(0,d.jsx)("i",{className:"fa-solid fa-clock fa-fw fa-lg"})," ",function(e){return void 0===e?"Undefined":`${e.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:1})}`}(c)]})})]})}function re(e){var n;const{config:a,detectorArray:i}=e,{displayArray:t,statistics:s,detectorSize:r,epoch:o}=i,l=j(e.tomoHardware,i);if(null===l)return null;const{y:c,z:m,px:u}=l;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(te.Z,{ref:e.imageRef,values:t,domain:e.domain,colorMap:e.lut,invertColorMap:e.isColorMapInverted,scaleType:e.scale,position:[c,m,0],scale:[-u,u,u],size:r}),(0,d.jsx)(se,{x:c+r.width*u*.5,y:m-r.height*u*.5,showMean:a.displayMean,mean:null!==(n=null===s||void 0===s?void 0:s.mean)&&void 0!==n?n:void 0,showEpoch:a.displayEpoch,epoch:o}),(0,d.jsx)(ie.Z,{centerX:c,centerY:m,width:r.width*u,height:r.height*u,color:"white",gapColor:"black",dashSize:5,gapSize:5,lineWidth:1})]})}function oe(e){const{sampleStage:n}=e,a=(0,v.kw)(n.sy),i=((0,v.kw)(n.sz),(0,v.kw)(n.sampy)),t=(0,v.Lv)(n.sy,"sy"),s=(0,v.Lv)(n.sampy,"sampy"),r=(0,v.Lv)(n.sz,"sz");return(0,d.jsx)("table",{children:(0,d.jsxs)("tbody",{children:[null===i&&null!==a&&(0,d.jsxs)("tr",{className:"flex-nowrap text-nowrap",children:[(0,d.jsx)("td",{children:t}),(0,d.jsx)("td",{className:"text-end",children:e.px.toFixed(2)}),(0,d.jsx)("td",{className:"text-start",children:"mm"})]}),null!==i&&null!==a&&(0,d.jsxs)("tr",{className:"flex-nowrap text-nowrap",children:[(0,d.jsx)("td",{children:t}),(0,d.jsx)("td",{className:"text-end",children:(a+i-e.px).toFixed(2)}),(0,d.jsx)("td",{className:"text-start",children:"mm"})]}),null!==i&&null!==a&&(0,d.jsxs)("tr",{className:"flex-nowrap text-nowrap",children:[(0,d.jsx)("td",{children:s}),(0,d.jsx)("td",{className:"text-end",children:(e.px-a).toFixed(2)}),(0,d.jsx)("td",{className:"text-start",children:"mm"})]}),(0,d.jsxs)("tr",{className:"flex-nowrap text-nowrap",children:[(0,d.jsx)("td",{style:{minWidth:"7em"},children:r}),(0,d.jsx)("td",{style:{minWidth:"4em"},className:"text-end",children:e.py.toFixed(2)}),(0,d.jsx)("td",{className:"text-start",children:"mm"})]}),void 0!==e.pixel&&(0,d.jsxs)("tr",{className:"flex-nowrap text-nowrap",children:[(0,d.jsx)("td",{children:"pixel"}),(0,d.jsx)("td",{className:"text-end",children:(o=e.pixel,l=2,Math.round(o)===o?o.toFixed(0):o.toFixed(l))}),(0,d.jsx)("td",{className:"text-start"})]})]})});var o,l}var le=a(58421);s()("daiquiri.components.tomo.detectorview.ActualRotationAxisLocation");function ce(e){var n,a,i;const{tomoHardware:t,sampleStageGeometry:s}=e;if(null===t.sy)return(0,d.jsx)(d.Fragment,{});const r=null!==(n=null===(a=t.sampleStage)||void 0===a||null===(i=a.properties.detector_center)||void 0===i?void 0:i[0])&&void 0!==n?n:0,o=s.detectorCenter[0]+(0,v.DJ)(t.sy)-r,l=s.maxDetectorPos[1],c=l-.1*(s.maxDetectorPos[1]-s.minDetectorPos[1]),m=new q.Vector2(o,c);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(le.D,{x:o,y1:l,y2:c,color:"red",gapColor:"white",dashSize:10,gapSize:10,lineWidth:2,zIndex:1.5}),(0,d.jsx)($.Z,{datapos:[m.x,m.y],color:"#FF0000",text:"Theorical rotation axis"})]})}s()("daiquiri.components.tomo.detectorview.Default");function de(e){var n,a,i,t,s,m,h,p;const{options:M}=e,N=(0,T.cO)(),C=(0,T.kP)(null!==(n=M.tomoconfig)&&void 0!==n?n:""),k=(0,T.Bp)(C),R=N[null!==(a=null===(i=k.detector)||void 0===i?void 0:i.id)&&void 0!==a?a:""],$=(0,I.e)(),E=(q=M.moveenabled,G=!0,null===q||void 0===q?G:q);var q,G;const B=function(){const[e,n]=(0,L.Z)("tomo/detectorview/follow","last-image"),[a,i]=(0,L.Z)("tomo/detectorview/axes",!0),[t,s]=(0,L.Z)("tomo/detectorview/field-of-view",1),[r,o]=(0,L.Z)("tomo/detectorview/crosshair",!1),[l,c]=(0,L.Z)("tomo/detectorview/mean",!0),[d,m]=(0,L.Z)("tomo/detectorview/epoch",!1),[u,x]=(0,L.Z)("tomo/detectorview/histogram",!1);return{follow:e,setFollow:n,displayAxes:a,setDisplayAxes:i,fieldOfView:t,setFieldOfView:s,crossHair:r,setCrossHair:o,displayMean:l,setDisplayMean:c,displayEpoch:d,setDisplayEpoch:m,displayHistogram:u,setDisplayHistogram:x}}(),[U,Q]=(0,r.useState)(c.uh.Flatfield),J=(0,S.h)({detector:R,sampleStage:k,profile:$.profile,normalization:$.scaleType,autoscale:$.autoscale,autoscaleMode:$.autoscaleMode,domain:$.scaleDomain,histogram:B.displayHistogram,enabled:!0,minRefreshPeriod:.5,processing:U}),K=J.data;(0,y.$n)({statistics:null===K||void 0===K?void 0:K.statistics,...$});const ee=(0,r.useRef)(null),ne=(0,r.useRef)(null),ie=(0,Y.y)("zoom"),{mouseMode:te,setMouseMode:se}=ie,le=function(e,n,a){const i=g(e);if(null===i)return null;const{y:t,z:s,fov:r}=i;if(null===r)return null;const[o,l]=function(){if(null===n||"motors"===a.follow)return[t,s];const i=j(e,n);return null===i?[0,0]:[i.y,i.z]}();return{detectorCenter:[t,s],minDetectorPos:[t-.5*r[0],s-.5*r[1]],maxDetectorPos:[t+.5*r[0],s+.5*r[1]],viewCenter:[o-.5*r[0],l-.5*r[1]*a.fieldOfView],minViewPos:[o-.5*r[0],l-.5*r[1]*a.fieldOfView],maxViewPos:[o+.5*r[0],l+.5*r[1]*a.fieldOfView]}}(k,K,B);function de(e){if(!k)return null;const n=k[e]||null;if(!n)return null;const a=n.properties.position;return null===a?null:new(W())(a,n.properties.unit)}const me=de("sampy"),ue=de("sy"),xe=(0,r.useCallback)((e=>{const n=e.dataPt.x,a=e.dataPt.y;switch(te){case"pan":case"zoom":break;case"sampy":if(se("pan"),null!==ue){const e=new(W())(n,"mm").sub(ue);(0,X.Q)({sampy:e})}else console.error("sy axis is not defined");break;case"sy":if(se("pan"),null!==ue)if(null!==me){const e=ue.add(me).sub(new(W())(n,"mm"));(0,X.Q)({sy:e})}else{const e=new(W())(n,"mm");(0,X.Q)({sy:e})}else console.error("sy axis is not defined");break;case"sz":se("pan"),(0,X.Q)({sz:new(W())(a,"mm")});break;default:console.error(`Unexpected ${te}`)}}),[te,me,ue,X.Q,K]),he=null===K||void 0===K?void 0:K.statistics,pe=!(null!==K&&void 0!==K&&K.imagePixelSize)||"pixel"===(null===K||void 0===K||null===(t=K.imagePixelSize)||void 0===t?void 0:t.units());const fe=function(e){if(!e)return;return{[c.yr.Dark]:"Dark",[c.yr.Flat]:"Flat",[c.yr.Proj]:"Proj",[c.yr.Unknown]:"Unknown data",[c.yr.FlatfieldNorm]:void 0,[c.yr.ProjNorm]:"Only normalized proj",[c.yr.ProjDarkNorm]:"Only normalized proj-dark",[c.yr.ProjFlatNorm]:"Only normalized proj/flat"}[e]}(null===K||void 0===K?void 0:K.datakind);return(0,d.jsxs)("div",{className:"plot2d-container w-100 h-100",style:{flex:"1 1 0%",display:"flex",flexDirection:"column"},children:[(0,d.jsxs)(x.ZP,{align:"center",children:[(0,d.jsx)(z.Z,{mouseModeInteraction:ie}),(0,d.jsx)(l.Z,{title:"Reset zoom (sample stage overview)",variant:"secondary",onClick:()=>{var e;null===ee||void 0===ee||null===(e=ee.current)||void 0===e||e.actions.resetZoom()},children:(0,d.jsx)("i",{className:"fa fa-expand fa-fw fa-lg"})}),(0,d.jsx)(x.Z0,{}),(0,d.jsx)(O.t,{mouseModeInteraction:ie}),E&&(0,d.jsx)(f,{mouseMode:te,setOrResetMouseMode:ie.setOrResetMouseMode,sy:k.sy,sz:k.sz,sampy:k.sampy}),(0,d.jsx)(x.Z0,{}),(0,d.jsx)(b.Z,{showDisplayed:!1,variant:"secondary",isInverted:$.invertColorMap,onSelectInvertion:$.setInvertColorMap,isDisplayed:!0,onSelectDisplayed:()=>{},lut:$.colorMap,onSelectLut:$.setColorMap,norm:$.scaleType,onSelectNorm:$.setScaleType,autoscale:$.autoscale,onSelectAutoscale:$.setAutoscale,autoscaleMode:$.autoscaleMode,onSelectAutoscaleMode:$.setAutoscaleMode,profile:$.profile,onSelectProfile:$.setProfile,array:K}),(0,d.jsx)(H.Z,{disabled:void 0===he,...$}),(0,d.jsx)(A.Z,{disabled:void 0===he,statistics:null===K||void 0===K?void 0:K.statistics,histogram:null===K||void 0===K?void 0:K.histogram,...$}),(0,d.jsx)(u,{as:o.Z,value:U,onSelect:Q,detector:R}),(0,d.jsx)(x.Z0,{}),(0,d.jsx)(D,{config:B})]}),(0,d.jsxs)("div",{style:{flex:"1 1 auto",display:"flex",margin:0,minHeight:0},children:[null!==le&&(0,d.jsxs)(Z.HI,{plotRef:ee,abscissaConfig:{visDomain:[le.minViewPos[0],le.maxViewPos[0]],label:`${(0,v.Lv)(k.sy,"sy")} + ${(0,v.Lv)(k.sampy,"sampy")} (mm)`,flip:!0},ordinateConfig:{visDomain:[le.minViewPos[1],le.maxViewPos[1]],label:`${(0,v.Lv)(k.sz,"sz")} (mm)`,flip:!0},showAxes:B.displayAxes,mouseMode:te,aspect:"equal",children:[(0,d.jsx)(V.z,{loading:J.loading,info:fe,warning:null===K?"No data":void 0,danger:J.error}),(0,d.jsx)(_.Z,{mouseMode:te,plotUnit:"mm"}),K&&(0,d.jsx)(re,{tomoHardware:k,config:B,detectorArray:K,lut:$.colorMap,isColorMapInverted:$.invertColorMap,scale:$.scaleType,domain:$.scaleDomain,imageRef:ne}),(0,d.jsx)(ce,{tomoHardware:k,sampleStageGeometry:le}),(0,d.jsx)(ae,{tomoHardware:k}),(0,d.jsx)(w.p9,{guides:B.crossHair?"both":void 0,renderTooltip:(e,n)=>{var a;const i=null===(a=ne.current)||void 0===a?void 0:a.pick(e,n);return(0,d.jsx)(oe,{sampleStage:k,px:e,py:n,pixel:i})}}),("sz"===te||"sampy"===te||"sy"===te)&&(0,d.jsx)(P.Z,{onClick:xe}),(0,d.jsx)(F.v,{unit:"mm"})]}),null===le&&(0,d.jsxs)(Z.HI,{plotRef:ee,abscissaConfig:{visDomain:[0,null!==(s=null===K||void 0===K||null===(m=K.detectorSize)||void 0===m?void 0:m.width)&&void 0!==s?s:1],label:"width (px)",flip:!0},ordinateConfig:{visDomain:[0,null!==(h=null===K||void 0===K||null===(p=K.detectorSize)||void 0===p?void 0:p.height)&&void 0!==h?h:1],label:"height (px)",flip:!0},showAxes:B.displayAxes,mouseMode:te,children:[(0,d.jsx)(V.z,{loading:J.loading,info:fe,warning:null===K?"No data":pe?"No sample pixel size defined":void 0,danger:J.error}),K&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(re,{tomoHardware:k,config:B,detectorArray:K,lut:$.colorMap,isColorMapInverted:$.invertColorMap,scale:$.scaleType,domain:$.scaleDomain,imageRef:ne})}),(0,d.jsx)(w.p9,{guides:B.crossHair?"both":void 0,renderTooltip:(e,n)=>{var a;const i=null===(a=ne.current)||void 0===a?void 0:a.pick(e,n);return(0,d.jsx)(oe,{sampleStage:k,px:e,py:n,pixel:i})}}),(0,d.jsx)(F.v,{unit:"px"}),(0,d.jsx)(_.Z,{mouseMode:te,plotUnit:"px"})]})]})]})}function me(e){return(0,d.jsx)(de,{...e})}function ue(e){const{yamlNode:n,tomoconfig:a,moveenabled:t,...s}=e;i.Ee(n,"tomoconfig",a),i.kC(n,"moveenabled",t),i.ol(n,s);const r={tomoconfig:a,moveenabled:t};return(0,d.jsx)(me,{options:r})}},35802:(e,n,a)=>{a.d(n,{P:()=>r,Q:()=>s});var i=a(96931),t=a(99646);function s(e){const{sz:n=null,sy:a=null,sampx:s=null,sampy:r=null,sampu:o=null,sampv:l=null}=e,c=new URL(`${(0,i.Z)()}/tomo/move`);a&&c.searchParams.append("sy",a.toString()),n&&c.searchParams.append("sz",n.toString()),s&&c.searchParams.append("sampx",s.toString()),r&&c.searchParams.append("sampy",r.toString()),o&&c.searchParams.append("sampu",o.toString()),l&&c.searchParams.append("sampv",l.toString()),c.searchParams.append("relative","false");const d=new XMLHttpRequest;d.open("GET",c.href,!0),t.Z.token&&d.setRequestHeader("Authorization",`Bearer ${t.Z.token}`),d.send()}function r(e){const{datacollectionid:n,axisposition:a,deltabeta:s,filename:r}=e;if(void 0===n)return;const o=new URL(`${(0,i.Z)()}/tomo/slice_reconstruction`);void 0!==n&&o.searchParams.append("datacollectionid",n.toString()),void 0!==a&&o.searchParams.append("axisposition",a.toString()),void 0!==s&&o.searchParams.append("deltabeta",s.toString()),void 0!==r&&o.searchParams.append("filename",r);const l=new XMLHttpRequest;l.open("GET",o.href,!0),t.Z.token&&l.setRequestHeader("Authorization",`Bearer ${t.Z.token}`),l.send()}}}]);
//# sourceMappingURL=984.401a8067.chunk.js.map