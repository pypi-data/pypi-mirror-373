"use strict";(self.webpackChunkdaiquiri_ui=self.webpackChunkdaiquiri_ui||[]).push([[184],{58184:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var a=s(52799),r=s(57209),i=s(45425),n=s(65699),o=s(20837),c=s(83401),p=s(98844),h=s(20729),l=s(18578),m=s(96956),u=s(18941),d=s(82794),f=s(91328),y=s(35950),g=s(28656),S=s(69521);class v extends o.Component{constructor(e){var t;super(e),this.selectRef=void 0,this.scans=void 0,this.changeSchema=()=>{var e,t;const s=null===(e=this.selectRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.value;this.props.actions.setSchema(""),s&&setTimeout((()=>this.props.actions.setSchema(s)),50)},this.onSubmit=(e,t,s)=>s({...e,overwrite:this.props.overwrite}).then((()=>{this.props.onSubmit&&this.props.onSubmit()})),this.onAsyncValidate=e=>{this.setState({asyncAdditional:e.additionalAsync})},console.log("parameteriser",this.props);const s=null!==(t=this.props.ptype)&&void 0!==t?t:"";this.scans=this.props.config&&s in this.props.config.parametertypes?this.props.config.parametertypes[s]:[],this.state={asyncAdditional:{},type:this.props.ptype},this.selectRef=o.createRef()}componentDidMount(){this.props.ptype!==this.state.type&&(this.props.actions.setSchemaType(this.state.type),this.changeSchema()),this.props.initialSchema&&(this.selectRef.current&&(this.selectRef.current.value=this.props.initialSchema),this.changeSchema())}render(){const e=(0,m.map)(this.scans,(e=>(0,S.jsx)("option",{value:e.actor,children:e.actor},e.actor))),{schema:t=""}=this.props;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.Z,{children:(0,S.jsxs)(u.Z.Group,{as:d.Z,children:[(0,S.jsx)(u.Z.Label,{column:!0,sm:3,children:"Type"}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(u.Z.Control,{ref:this.selectRef,as:"select",value:this.props.schema,onChange:this.changeSchema,disabled:this.props.overwrite,children:e})})]})}),(0,S.jsx)("hr",{}),""===this.props.schema?null:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(g.Z,{schema:`${y.Ps(t)}Schema`,formData:{...this.props.formData},onSubmit:this.onSubmit,onAsyncValidate:this.onAsyncValidate,submitText:"Save",button:this.props.button})})]})}}var x=s(31801);const b=(0,r.$j)((e=>({config:x.Z.selector("config",e,"parameteriser"),schema:x.Z.selector("form",e).newParametersSchema||"",type:x.Z.selector("form",e).newParametersSchemaType||""})),(()=>({actions:{setSchema:e=>x.Z.dispatch("SET_FORM",{key:"newParametersSchema",value:e}),setSchemaType:e=>x.Z.dispatch("SET_FORM",{key:"newParametersSchemaType",value:e})}})))(v);var j=s(25743);const P=function(e){var t;const s=(0,o.useRef)((()=>{})),a=(0,o.useRef)(!1),r=(0,o.useRef)(),i=(0,o.useCallback)((()=>{var t;null===(t=r.current)||void 0===t||t.close(),e.onSubmit&&e.onSubmit()}),[r,e.onSubmit]);return(0,S.jsx)(j.Z,{ref:r,id:`newParameters${e.ptype}${null!==(t=e.prefix)&&void 0!==t?t:""}`,button:e.button||(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("i",{className:"fa fa-plus me-1"}),"New"]}),buttonProps:{disabled:e.disabled,className:e.inset?"":"float-end mb-1",...e.buttonProps},buttons:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(l.Z,{onClick:()=>s.current(),disabled:a.current,children:"Save"})}),title:`${e.title||"New"} ${e.ptype}`,children:(0,S.jsx)(b,{onSubmit:i,config:e.config,formData:{...e.formData},ptype:e.ptype,initialSchema:e.schema,overwrite:e.overwrite,button:(e,t)=>{a.current=e,s.current=t}})})};function Z(e,t,s,a){return(0,S.jsx)(P,{ptype:a.ptype,onSubmit:a.onSubmit,formData:{...t.parameters},overwrite:!0,schema:t.instance_type,button:(0,S.jsx)("i",{className:"fa fa-search"}),buttonProps:{size:"sm",variant:"info"},inset:!0,title:"Edit",prefix:t.name})}function w(e){(0,o.useEffect)((()=>{e.actions.setParams({type:e.type},!0)}),[]);const t=()=>{e.actions.fetch()},s=[{dataField:"name",text:"Name"},{dataField:"instance_type",text:"Instance"},{dataField:"file_name",text:"File"},{dataField:"action",text:"",formatter:Z,formatExtraData:{onSubmit:t,ptype:e.type},classes:"text-end text-nowrap"}];return(0,S.jsx)(h.Z,{children:(0,S.jsx)(c.Z,{children:(0,S.jsxs)("div",{className:"object",children:[(0,S.jsxs)("h5",{children:[e.type,(0,S.jsx)(P,{ptype:e.type,onSubmit:t})]}),(0,S.jsx)(p.Z,{keyField:"name",data:e.parameters,columns:s,noDataIndication:"No parameters defined",pages:{page:e.page,per_page:e.per_page,total:e.total,setPage:e.actions.setPage,setPageSize:e.actions.setPageSize,setParams:e.actions.setParams,fetch:e.actions.fetch},loading:e.fetching,overlay:!0})]})})})}w.defaultProps={pnamespace:""};const F=w;const R=(0,i.Qg)({parameteriser:n.Z})((0,r.$j)((function(e,t){const{providers:s}=t,{parameters:a}=s.parameteriser;return{parameters:a.selector("ordered",e),namespace:a.getNamespace(),per_page:a.selector("per_page",e),page:a.selector("page",e),total:a.selector("total",e),fetching:a.selector("fetching",e)}}),(function(e,t){const{providers:s}=t,{parameters:a}=s.parameteriser;return{actions:{fetch:()=>a.fetch(),setParams:e=>a.setParams(e,!0),setPage:e=>a.setPage(e),setPageSize:e=>a.setPageSize(e)}}}))(F));function _(e){const{providers:t,yamlNode:s,paramtype:r,...i}=e;return a.Xl(s,"paramtype",r),a.ol(s,i),(0,S.jsx)(R,{providers:t,type:r})}}}]);
//# sourceMappingURL=184.cfb55d77.chunk.js.map