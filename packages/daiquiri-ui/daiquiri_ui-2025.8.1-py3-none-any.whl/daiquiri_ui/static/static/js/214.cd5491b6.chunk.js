"use strict";(self.webpackChunkdaiquiri_ui=self.webpackChunkdaiquiri_ui||[]).push([[214],{64700:(e,t,r)=>{r.d(t,{e:()=>a});var n=r(93014);function a(){return{...(0,n.y)({name:"tomo/defaultcolormap"})}}},60676:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(70775),a=r(82794),o=r(91328),i=r(18578),s=r(86912),l=r(38213),c=r(10827),u=r(99146),d=r(38243),f=r(61283),m=r(69521);function p(e){if(!e.array||!e.array.info)return(0,m.jsx)(m.Fragment,{});const t=e.array.info;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",children:"Info"})}),(0,m.jsxs)(a.Z,{children:[(0,m.jsx)(o.Z,{children:(0,m.jsx)("h6",{children:"Shape"})}),(0,m.jsx)(o.Z,{children:(n=e.array.array.shape,n.map((e=>`${e}`)).join(" \xd7 "))})]}),(0,m.jsxs)(a.Z,{children:[(0,m.jsx)(o.Z,{children:(0,m.jsx)("h6",{children:"Profile"})}),(0,m.jsx)(o.Z,{children:t.profile})]}),(0,m.jsxs)(a.Z,{children:[(0,m.jsx)(o.Z,{children:(0,m.jsx)("h6",{children:"Size"})}),(0,m.jsx)(o.Z,{children:(r=t.byteLength,r<1e3?`${r} B`:r<1e5?`${(r/1e3).toFixed(1)} KB`:`${(r/1e6).toFixed(1)} MB`)})]}),(0,m.jsxs)(a.Z,{children:[(0,m.jsx)(o.Z,{children:(0,m.jsx)("h6",{title:"Data type of the source",children:"Type"})}),(0,m.jsx)(o.Z,{children:t.dtype})]})]});var r,n}function h(e){const{as:t,showDisplayed:r=!0}=e;function o(t,r){const n=e.lut===t?"primary":"secondary";return(0,m.jsx)(i.Z,{variant:n,onClick:()=>{e.onSelectLut(t)},className:"text-nowrap",title:r,size:"sm",children:(0,m.jsx)(f.FR,{name:t})})}function h(t){const r=e.autoscaleMode===t,n=r&&e.autoscale?"primary":r?"warning":"secondary",a={[d.me.Minmax]:"Minmax",[d.me.StdDev3]:"3\xd7std",[d.me.None]:"Manual"}[t];return(0,m.jsx)(i.Z,{variant:n,onClick:()=>{e.onSelectAutoscaleMode(t),e.onSelectAutoscale(!0)},size:"sm",children:a})}function v(t,r){const n=e.norm===t?"primary":"secondary";return(0,m.jsx)(i.Z,{variant:n,onClick:()=>{e.onSelectNorm(t)},size:"sm",children:r})}function x(t,r,n){const a=e.profile===t?"primary":"secondary";return(0,m.jsx)(i.Z,{variant:a,onClick:()=>{e.onSelectProfile(t)},size:"sm",title:n,children:r})}return(0,m.jsxs)(s.Z,{as:t,className:""+("up"===e.dropDirection?"dropup":""),children:[(0,m.jsxs)(s.Z.Toggle,{id:"dropdown-basic",variant:e.variant,className:"d-flex align-items-center",children:[(0,m.jsx)("i",{className:"fa fam-hardware-camera fa-lg me-1"}),e.isDisplayed&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(f.FR,{name:e.lut}),(0,m.jsx)(f.Q7,{scale:e.norm}),e.autoscale&&(0,m.jsx)(f.gf,{autoscale:e.autoscaleMode})]})]}),(0,m.jsx)(s.Z.Menu,{className:"dropdown-menu-center",children:(0,m.jsx)("div",{className:"ms-1 me-1",children:(0,m.jsxs)(l.Z,{children:[r&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",children:"Detector"})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const t=e.isDisplayed?"primary":"secondary";return(0,m.jsx)(i.Z,{variant:t,onClick:()=>{e.onSelectDisplayed(!e.isDisplayed)},size:"sm",children:"Display detector data"})}()})})]}),(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",children:"Lookup table"})}),(0,m.jsx)(a.Z,{children:(0,m.jsxs)(c.Z,{className:"flex-grow-1",children:[o("Greys","Gray"),o("Viridis","Viridis"),o("Cividis","Cividis"),o("Magma","Magma"),o("Inferno","Inferno"),o("Plasma","Plasma")]})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const t=e.isInverted?"primary":"secondary";return(0,m.jsxs)(i.Z,{variant:t,onClick:()=>{e.onSelectInvertion(!e.isInverted)},size:"sm",children:[(0,m.jsx)("i",{className:"fa fa-fw fa-arrows-alt-v"})," Inverted LUT"]})}()})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",children:"Auto scale"})}),(0,m.jsx)(a.Z,{children:(0,m.jsxs)(c.Z,{className:"flex-grow-1 mt-1",children:[h(d.me.Minmax),h(d.me.StdDev3)]})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:function(){const t=e.autoscale?"primary":"secondary";return(0,m.jsxs)(i.Z,{variant:t,onClick:()=>{e.onSelectAutoscale(!e.autoscale)},size:"sm",children:[(0,m.jsx)("i",{className:"fa-solid fa-circle-half-stroke fa-fw fa-lg"})," Auto scale enabled"]})}()})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",children:"Normalization"})}),(0,m.jsx)(a.Z,{children:(0,m.jsxs)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:[v(n.N3.Linear,"Linear"),v(n.N3.Log,"Log"),v(n.N3.SymLog,"SymLog")]})}),(0,m.jsx)(a.Z,{children:(0,m.jsx)("h6",{className:"flex-grow-1 text-center",title:"How to transfer the data",children:"Profile"})}),(0,m.jsx)(a.Z,{children:(0,m.jsxs)(c.Z,{className:"flex-grow-1 mt-1 mb-2",children:[x(u.rS.Raw,"Raw","Transfer data as it is provided by the detector or the processing"),x(u.rS.F16,"Float 16b","Transfer data as float 16-bits"),x(u.rS.U8,"8-bits","Transfer data as 8-bits")]})}),(0,m.jsx)(p,{array:e.array})]})})})]})}},3471:(e,t,r)=>{r.d(t,{J:()=>d,h:()=>f});var n=r(20837),a=r(99146),o=r(38243),i=r(34718),s=r.n(i),l=r(70775),c=r(74773),u=r(19097);s()("daiquiri.components.tomo.utils.TomoDetector");function d(e){const t=(0,c.cO)();return(0,n.useMemo)((()=>{const r=function(){var t,r;if(e.sampleStage){const{detector:t}=e.sampleStage;return t?t.id:""}return null!==(t=null===(r=e.sampleStageRefs)||void 0===r?void 0:r.detector)&&void 0!==t?t:""}();return t[r]}),[e.sampleStage,t])}function f(e){const[t,r]=(0,a.ao)(),i=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=(0,n.useRef)(),i=(0,n.useRef)();return(0,u.z)((()=>{o.current&&clearTimeout(o.current)})),(0,n.useMemo)((()=>{const t=(n,s)=>{i.current=void 0,e.apply(n,s),o.current=setTimeout((()=>{o.current=void 0,!a&&i.current&&(t(i.current.this,i.current.args),i.current=void 0)}),r)},n=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];o.current?i.current={args:r,this:this}:t(this,r)};return Object.defineProperties(n,{length:{value:e.length},name:{value:`${e.name||"anonymous"}__throttled__${r}`}}),n}),[r,a,...t])}(r,[e.minRefreshPeriod,r],1e3*e.minRefreshPeriod,!0);return(0,n.useEffect)((()=>{var t;"u8"!==e.profile&&(e.enabled&&e.detector&&i({detector:e.detector,lut:"Cividis",autoscale:o.me.StdDev3,normalization:l.N3.Linear,process:null!==(t=e.processing)&&void 0!==t?t:a.uh.Flatfield,profiles:[e.profile],histogram:e.histogram}))}),[e.detector,i,e.enabled,e.profile,e.processing,e.histogram]),(0,n.useEffect)((()=>{var t;"u8"===e.profile&&(e.enabled&&e.detector&&i({detector:e.detector,lut:"Cividis",normalization:e.normalization,process:null!==(t=e.processing)&&void 0!==t?t:a.uh.Flatfield,profiles:[e.profile],histogram:e.histogram,...e.autoscale&&e.autoscaleMode!==o.me.None?{autoscale:e.autoscaleMode}:{vmin:e.domain[0],vmax:e.domain[1],autoscale:o.me.None}}))}),[e.detector,i,e.enabled,e.profile,e.processing,e.autoscale,e.autoscaleMode,e.normalization,e.domain[0],e.domain[1],e.histogram]),t}},64578:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(52799),a=r(20837),o=r(34718),i=r.n(o),s=r(4363),l=r(94708),c=r(38243),u=r(3471),d=r(18578),f=r(2498),m=r(60676),p=r(64700),h=r(42963),v=r(81079),x=r(74773),g=r(37668),y=r(68108),j=r(69521);function Z(e){const{domain:t}=e,{displayArray:r,detectorSize:n}=e.detectorArray;return(0,j.jsx)(y.Z,{values:r,domain:t,colorMap:e.lut,invertColorMap:e.isColorMapInverted,scaleType:e.scale,position:[.5*n.width,.5*n.height,0],scale:[1,1,1],size:n})}var S=r(63887),w=r(17332),b=r(15568),M=r(58421);function N(e){var t,r,n,a;const{tomoHardware:o,detectorArray:i}=e,s=null===(t=i.imagePixelSize)||void 0===t||null===(r=t.to("mm"))||void 0===r?void 0:r.scalar,l=o.sy?(0,S.DJ)(o.sy):null;if(null===l||void 0===s)return(0,j.jsx)(j.Fragment,{});const c=i.detectorSize.width,{sampleStage:u}=o,d=null!==(n=null===u||void 0===u||null===(a=u.properties.detector_center)||void 0===a?void 0:a[0])&&void 0!==n?n:0,f=i.detectorSize.height,m=.5*c+l/s-d,p=new b.Vector2(m,.75*f),h=f/50;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(M.D,{x:m,y1:f,y2:.75*f,color:"red",gapColor:"white",dashSize:h,gapSize:h,lineWidth:2}),(0,j.jsx)(w.Z,{datapos:[p.x,p.y],color:"#FF0000",text:"Theorical rotation axis"})]})}i()("daiquiri.components.tomo.detector.Default");function C(e){var t;const{options:r}=e,{tomoconfig:n}=r,o=(0,p.e)(),i=(0,x.kP)(null!==n&&void 0!==n?n:""),y=(0,x.Bp)(i),S=(0,u.J)({sampleStage:y}),w=(0,u.h)({detector:S,sampleStage:y,profile:o.profile,normalization:o.scaleType,autoscale:o.autoscale,autoscaleMode:o.autoscaleMode,domain:o.scaleDomain,enabled:!0,minRefreshPeriod:.5}).data,b=(0,a.useRef)(null),M=(0,g.y)("zoom"),{mouseMode:C}=M,k=null!==(t=null===w||void 0===w?void 0:w.detectorSize)&&void 0!==t?t:{width:0,height:0},z=null===w||void 0===w?void 0:w.statistics;return(0,c.$n)({statistics:null===w||void 0===w?void 0:w.statistics,...o}),(0,j.jsxs)("div",{className:"plot2d-container w-100 h-100",style:{flex:"1 1 0%",display:"flex",flexDirection:"column"},children:[(0,j.jsxs)(l.ZP,{align:"center",children:[(0,j.jsx)(s.Z,{mouseModeInteraction:M}),(0,j.jsx)(d.Z,{title:"Reset zoom (sample stage overview)",variant:"secondary",onClick:()=>{var e;null===b||void 0===b||null===(e=b.current)||void 0===e||e.actions.resetZoom()},children:(0,j.jsx)("i",{className:"fa fa-expand fa-fw fa-lg"})}),(0,j.jsx)(l.Z0,{}),(0,j.jsx)(m.Z,{showDisplayed:!1,variant:"secondary",isInverted:o.invertColorMap,onSelectInvertion:o.setInvertColorMap,isDisplayed:!0,onSelectDisplayed:()=>{},lut:o.colorMap,onSelectLut:o.setColorMap,norm:o.scaleType,onSelectNorm:o.setScaleType,autoscale:o.autoscale,onSelectAutoscale:o.setAutoscale,autoscaleMode:o.autoscaleMode,onSelectAutoscaleMode:o.setAutoscaleMode,profile:o.profile,onSelectProfile:o.setProfile,array:w}),(0,j.jsx)(h.Z,{disabled:void 0===z,...o}),(0,j.jsx)(v.Z,{disabled:void 0===z,statistics:null===w||void 0===w?void 0:w.statistics,...o})]}),(0,j.jsx)("div",{style:{flex:"1 1 auto",display:"flex",margin:0,minHeight:0},children:(0,j.jsx)(f.HI,{plotRef:b,abscissaConfig:{visDomain:[0,k.width],label:"px"},ordinateConfig:{visDomain:[0,k.height],label:"px",flip:!0},mouseMode:C,aspect:"equal",children:w&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Z,{detectorArray:w,lut:o.colorMap,isColorMapInverted:o.invertColorMap,scale:o.scaleType,domain:o.scaleDomain}),(0,j.jsx)(N,{tomoHardware:y,detectorArray:w})]})})})]})}function k(e){return(0,j.jsx)(C,{...e})}function z(e){const{yamlNode:t,tomoconfig:r,...a}=e;n.Ee(t,"tomoconfig",r),n.ol(t,a);const o={tomoconfig:r};return(0,j.jsx)(k,{options:o})}},43046:(e,t,r)=>{r.d(t,{C:()=>s});var n=r(20837),a=r(21681),o=r(7894);function i(e,t){return"function"===typeof e?e(t):e}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;const[s,l]=function(e,t){const[r,s]=(0,a.F)((()=>t?t(i(e)):e)),l=(0,o.x)(t);return[r,(0,n.useCallback)((e=>{l.current?s((t=>l.current?.(i(e,t)))):s(e)}),[])]}(e,(e=>(void 0!==t&&(e=Math.min(t,e)),void 0!==r&&(e=Math.max(r,e)),e))),c=(0,o.x)(s);return[s,(0,n.useMemo)((()=>({get:()=>c.current,set:l,dec:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;l((t=>t-i(e,t)))},inc:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;l((t=>t+i(e,t)))},reset:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;l((e=>i(t,e)))}})),[e,l,c])]}},21681:(e,t,r)=>{r.d(t,{F:()=>a});var n=r(20837);function a(e){const[t,r]=(0,n.useState)(e),a=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=(0,n.useRef)(e),r=(0,n.useCallback)((()=>t.current),[]);return(0,n.useEffect)((()=>(t.current=!0,()=>{t.current=!1})),[]),r}(!0);return[t,(0,n.useCallback)((e=>{a()&&r(e)}),[])]}},43285:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(20837);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}var o=function(e){return new Error("NoPayloadError: "+e+" requires a payload.")},i=function(e,t){var r=e.past,n=e.present,i=e.future,s=t.payload,l=t.behavior,c=t.historyLimit,u=t.ignoreIdenticalMutations,d=t.cloneState,f=t.ignoreAction;if(!s||void 0===s)throw o("mutate");if(f)return{past:r,present:s,future:i};var m=[].concat(r);"infinium"!==c&&"infinity"!==c&&(m=function(e,t){if(!e)return t;var r=[].concat(t);if(r.length<=e)return t;var n=r.length-e;return 1===n?r.shift():r.splice(0,n),r}(c,r));var p=JSON.stringify(s)===JSON.stringify(n);if(u&&p)return d?a({},e):e;var h=[].concat(i),v={mergePastReversed:{past:[].concat(m,h.reverse(),[n]),present:s,future:[]},mergePast:{past:[].concat(m,i,[n]),present:s,future:[]},destroyFuture:{past:[].concat(m,[n]),present:s,future:[]},keepFuture:{past:[].concat(m,[n]),present:s,future:i}};if("undefined"===typeof l)return v.mergePastReversed;if(!v.hasOwnProperty(l))throw function(e){return new Error("Mutation behavior must be one of: mergePastReversed, mergePast, keepFuture, or destroyFuture. Not: "+e)}(l);return v[l]},s=function(e,t){var r=e.past,n=e.present,a=e.future,s={undo:function(){if(0===r.length)return e;var t=r[r.length-1];return{past:r.slice(0,r.length-1),present:t,future:[n].concat(a)}},redo:function(){if(0===a.length)return e;var t=a[0],o=a.slice(1);return{past:[].concat(r,[n]),present:t,future:o}},update:function(){return i(e,function(e){return e.payload="function"===typeof e.payload?e.payload(n):e.payload,e}(t))},reset:function(){return{past:[],present:t.payload||e.present,future:[]}},resetInitialState:function(){var e=t.payload;if(!e)throw o("resetInitialState");var i=[].concat(r);return i[0]=e,{past:[].concat(i),present:n,future:[].concat(a)}}};return s[t.type]()},l={past:[],present:null,future:[]},c={behavior:"mergePastReversed",historyLimit:100,ignoreIdenticalMutations:!0,cloneState:!1};const u=function(e,t){void 0===t&&(t=c);var r=(0,n.useReducer)(s,a({},l,{present:e})),o=r[0],i=r[1],u=0!==o.past.length,d=0!==o.future.length,f=(0,n.useCallback)((function(){u&&i({type:"undo"})}),[u]),m=(0,n.useCallback)((function(){d&&i({type:"redo"})}),[d]),p=(0,n.useCallback)((function(t){return void 0===t&&(t=e),i({type:"reset",payload:t})}),[]),h=(0,n.useCallback)((function(e){return i({type:"resetInitialState",payload:e})}),[]),v=(0,n.useCallback)((function(e,r,n){return i(a({type:"update",payload:e,behavior:r,ignoreAction:n},function(e){return a({},c,e)}(t)))}),[]),x=(0,n.useCallback)((function(e,r,n){return void 0===r&&(r=t.behavior),void 0===n&&(n=!1),v(e,r,n)}),[o]);return[o.present,x,{past:o.past,future:o.future,undo:f,canUndo:u,redo:m,canRedo:d,reset:p,resetInitialState:h,static_setState:function(e,r,n){void 0===r&&(r=t.behavior),void 0===n&&(n=!1),v(e,r,n)}}]}}}]);
//# sourceMappingURL=214.cd5491b6.chunk.js.map