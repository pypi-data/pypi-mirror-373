{% extends "aa_discord_announcements/base.html" %}

{% load i18n %}

{% block aa_discord_announcements_body %}
    <div class="row">
        <div class="col-md-6">
            <div class="card card-default">
                <div class="card-header">
                    <div class="card-title mb-0">{% translate "Announcement details" %}</div>
                </div>

                <div class="card-body">
                    {% include "aa_discord_announcements/partials/form/form.html" %}
                </div>
            </div>
        </div>

        <div class="col-md-6 aa-discord-announcements-announcementtext">
            <div class="card card-default position-sticky" style="top: 1rem;">
                <div class="card-header">
                    <div class="card-title mb-0">{% translate "Formatted announcement text" %}</div>
                </div>

                <div class="card-body">
                    {% include "aa_discord_announcements/partials/announcement/announcement.html" %}
                </div>
            </div>
        </div>
    </div>

    {% translate "Mandatory information is missing.<br>To create an announcement, you need to fill out the following fields:<br>Â» Announcement text" as l10nMissingFields %}
    {% translate "Error! Your announcement was not copied to your clipboard. Maybe your browser doesn't support this feature." as l10nCopyToClipboardError %}
    {% translate "Success! Your announcement text has been copied to your clipboard." as l10nCopyToClipboardSuccess %}

    <script>
        const discordAnnouncementsSettings = {
            url: {
                createAnnouncement: '{% url "aa_discord_announcements:ajax_create_announcement" %}',
                getAnnouncementTargets: '{% url "aa_discord_announcements:ajax_get_announcement_targets" %}',
                getAnnouncementWebhooks: '{% url "aa_discord_announcements:ajax_get_webhooks" %}'
            },
            translation: {
                error: {
                    missingFields: '{{ l10nMissingFields|escapejs }}'
                },
                copyToClipboard: {
                    error: '{{ l10nCopyToClipboardError|escapejs }}',
                    success: '{{ l10nCopyToClipboardSuccess|escapejs }}'
                }
            }
        };
    </script>
{% endblock %}

{% block extra_javascript %}
    {% include "bundles/clipboard-js.html" %}
    {% include "aa_discord_announcements/bundles/discord-announcements-js.html" %}
{% endblock %}
