$(document).ready(()=>{'use strict';const e=$('select#id_announcement_target'),n=$('select#id_announcement_channel'),s=$('input[name="csrfmiddlewaretoken"]'),t=$('textarea[name="announcement_text"]'),o=$('#aa-discord-announcements-form'),a=()=>{fetchGet({url:discordAnnouncementsSettings.url.getAnnouncementTargets,responseIsJson:!1}).then(n=>{''!==n&&$(e).html(n)}).catch(e=>{console.error('Error fetching announcement targets:',e)})},r=()=>{fetchGet({url:discordAnnouncementsSettings.url.getAnnouncementWebhooks,responseIsJson:!1}).then(e=>{''!==e&&$(n).html(e)}).catch(e=>{console.error('Error fetching announcement webhooks:',e)})},c=(e,n=10)=>{$(e).fadeTo(1e3*n,500).slideUp(500,()=>{$(e).remove()})},i=(e,n)=>{const s='alert alert-success alert-dismissible alert-message-success d-flex align-items-center fade show';$(n).html(`<div class="${s}">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),c('.alert-message-success')},m=(e,n)=>{const s='alert alert-danger alert-dismissible alert-message-error d-flex align-items-center fade show';$(n).html(`<div class="${s}">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),c('.alert-message-error',9999)},d=()=>{const e=new ClipboardJS('button#copyDiscordAnnouncement');e.on('success',n=>{i(discordAnnouncementsSettings.translation.copyToClipboard.success,'.aa-discord-announcements-announcement-copyresult'),n.clearSelection(),e.destroy()}),e.on('error',()=>{m(discordAnnouncementsSettings.translation.copyToClipboard.error,'.aa-discord-announcements-announcement-copyresult'),e.destroy()})};o.submit(e=>{e.preventDefault(),$('.aa-discord-announcements-form-message div').remove();if([t.val()].includes(''))return m(discordAnnouncementsSettings.translation.error.missingFields,'.aa-discord-announcements-form-message'),!1;const n=o.serializeArray().reduce((e,n)=>(e[n.name]=n.value,e),{});fetchPost({url:discordAnnouncementsSettings.url.createAnnouncement,csrfToken:s.val(),payload:n,responseIsJson:!0}).then(e=>{!0===e.success?($('.aa-discord-announcements-no-announcement').hide('fast'),$('.aa-discord-announcements-announcement').show('fast'),$('.aa-discord-announcements-announcement-text').html(e.announcement_context),e.message&&i(e.message,'.aa-discord-announcements-form-message')):m(e.message||'Something went wrong, no details given.','.aa-discord-announcements-form-message')}).catch(e=>{console.error(`Error: ${e.message}`),m(e.message||'Something went wrong, no details given.','.aa-discord-announcements-form-message')})}),$('button#copyDiscordAnnouncement').on('click',()=>{d()}),a(),r()});
//# sourceMappingURL=aa-discord-announcements.min.js.map