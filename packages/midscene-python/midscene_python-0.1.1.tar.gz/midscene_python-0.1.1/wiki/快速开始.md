# å¿«é€Ÿå¼€å§‹

æ¬¢è¿ä½¿ç”¨ Midscene Pythonï¼æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨ 5 åˆ†é’Ÿå†…ä¸Šæ‰‹ AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–æ“ä½œã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

- **Python 3.9+**
- **pip** åŒ…ç®¡ç†å™¨
- **æµè§ˆå™¨** (Chrome/Firefox/Edgeï¼Œç”¨äº Web è‡ªåŠ¨åŒ–)
- **AI æ¨¡å‹ API Key** (OpenAIã€Claudeã€Qwen æˆ– Gemini ä»»é€‰å…¶ä¸€)

## ğŸš€ å¿«é€Ÿå®‰è£…

### 1. å®‰è£… Midscene Python

```bash
pip install midscene-python
```

### 2. å®‰è£…æµè§ˆå™¨é©±åŠ¨ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ è®¡åˆ’è¿›è¡Œ Web è‡ªåŠ¨åŒ–ï¼Œéœ€è¦å®‰è£…å¯¹åº”çš„æµè§ˆå™¨é©±åŠ¨ï¼š

```bash
# Selenium WebDriver
pip install webdriver-manager

# æˆ–è€… Playwright
pip install playwright
playwright install
```

### 3. é…ç½® AI æ¨¡å‹

åˆ›å»º `.env` æ–‡ä»¶é…ç½® AI æ¨¡å‹ï¼ˆä»¥ OpenAI ä¸ºä¾‹ï¼‰ï¼š

```bash
# .env
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1  # å¯é€‰ï¼Œé»˜è®¤å®˜æ–¹ API
```

## ğŸ¯ ç¬¬ä¸€ä¸ªç¤ºä¾‹

è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ Web è‡ªåŠ¨åŒ–ç¤ºä¾‹å¼€å§‹ï¼š

### ç¤ºä¾‹ 1: æœç´¢æ“ä½œ

```python
import asyncio
from midscene import Agent
from midscene.web import SeleniumWebPage

async def search_example():
    """åœ¨ç™¾åº¦æœç´¢ Python æ•™ç¨‹"""
    
    # åˆ›å»º Web é¡µé¢å®ä¾‹
    with SeleniumWebPage.create() as page:
        # åˆ›å»º Agent
        agent = Agent(page)
        
        # å¯¼èˆªåˆ°ç½‘ç«™
        await page.goto("https://www.baidu.com")
        
        # ä½¿ç”¨è‡ªç„¶è¯­è¨€è¿›è¡Œæœç´¢
        await agent.ai_action("åœ¨æœç´¢æ¡†è¾“å…¥'Python æ•™ç¨‹'")
        await agent.ai_action("ç‚¹å‡»æœç´¢æŒ‰é’®")
        
        # éªŒè¯æœç´¢ç»“æœ
        await agent.ai_assert("é¡µé¢æ˜¾ç¤ºäº† Python æ•™ç¨‹çš„æœç´¢ç»“æœ")
        
        print("âœ… æœç´¢æ“ä½œå®Œæˆï¼")

# è¿è¡Œç¤ºä¾‹
asyncio.run(search_example())
```

### ç¤ºä¾‹ 2: æ•°æ®æå–

```python
import asyncio
from midscene import Agent
from midscene.web import SeleniumWebPage

async def extract_example():
    """æå–æ–°é—»æ ‡é¢˜"""
    
    with SeleniumWebPage.create() as page:
        agent = Agent(page)
        
        # è®¿é—®æ–°é—»ç½‘ç«™
        await page.goto("https://news.example.com")
        
        # æå–ç»“æ„åŒ–æ•°æ®
        news_data = await agent.ai_extract({
            "articles": [
                {
                    "title": "æ–°é—»æ ‡é¢˜",
                    "time": "å‘å¸ƒæ—¶é—´",
                    "summary": "æ–°é—»æ‘˜è¦"
                }
            ]
        })
        
        # è¾“å‡ºç»“æœ
        for article in news_data["articles"]:
            print(f"ğŸ“° {article['title']}")
            print(f"â° {article['time']}")
            print(f"ğŸ“„ {article['summary']}\n")

# è¿è¡Œç¤ºä¾‹
asyncio.run(extract_example())
```

## ğŸ“± Android è‡ªåŠ¨åŒ–ç¤ºä¾‹

```python
import asyncio
from midscene import Agent
from midscene.android import AndroidDevice

async def android_example():
    """Android åº”ç”¨è‡ªåŠ¨åŒ–"""
    
    # è¿æ¥ Android è®¾å¤‡
    device = AndroidDevice()
    await device.connect()
    
    # åˆ›å»º Agent
    agent = Agent(device)
    
    # å¯åŠ¨åº”ç”¨
    await device.start_app("com.example.app")
    
    # è‡ªç„¶è¯­è¨€æ“ä½œ
    await agent.ai_action("ç‚¹å‡»ç™»å½•æŒ‰é’®")
    await agent.ai_action("è¾“å…¥ç”¨æˆ·å 'testuser'")
    await agent.ai_action("è¾“å…¥å¯†ç  'password123'")
    await agent.ai_action("ç‚¹å‡»ç¡®è®¤ç™»å½•")
    
    # éªŒè¯ç™»å½•çŠ¶æ€
    await agent.ai_assert("æ˜¾ç¤ºç”¨æˆ·å·²ç™»å½•")
    
    print("âœ… Android è‡ªåŠ¨åŒ–å®Œæˆï¼")

# è¿è¡Œç¤ºä¾‹
asyncio.run(android_example())
```

## ğŸ›ï¸ é…ç½®é€‰é¡¹

### AI æ¨¡å‹é…ç½®

```python
from midscene.core.ai_model import AIModelConfig

# è‡ªå®šä¹‰ AI é…ç½®
config = AIModelConfig(
    provider="openai",  # æˆ– "claude", "qwen", "gemini"
    model="gpt-4-vision-preview",
    temperature=0.1,
    max_tokens=1000
)

agent = Agent(page, ai_config=config)
```

### Agent é€‰é¡¹

```python
from midscene.core import AgentOptions

# è‡ªå®šä¹‰ Agent é€‰é¡¹
options = AgentOptions(
    timeout=30,  # æ“ä½œè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    retry_count=3,  # é‡è¯•æ¬¡æ•°
    screenshot_on_error=True,  # é”™è¯¯æ—¶è‡ªåŠ¨æˆªå›¾
    cache_enabled=True  # å¯ç”¨æ™ºèƒ½ç¼“å­˜
)

agent = Agent(page, options=options)
```

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### åŸºç¡€äº¤äº’

```python
# ç‚¹å‡»æ“ä½œ
await agent.ai_action("ç‚¹å‡»æäº¤æŒ‰é’®")
await agent.ai_action("ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ç”¨æˆ·å¤´åƒ")

# è¾“å…¥æ“ä½œ
await agent.ai_action("åœ¨ç”¨æˆ·åæ¡†è¾“å…¥ 'admin'")
await agent.ai_action("åœ¨å¯†ç æ¡†è¾“å…¥å¯†ç ")

# æ»šåŠ¨æ“ä½œ
await agent.ai_action("å‘ä¸‹æ»šåŠ¨æŸ¥çœ‹æ›´å¤šå†…å®¹")
await agent.ai_action("æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨")

# ç­‰å¾…æ“ä½œ
await agent.ai_action("ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ")
```

### å…ƒç´ å®šä½

```python
# ç²¾ç¡®å®šä½å…ƒç´ 
element = await agent.ai_locate("ç™»å½•æŒ‰é’®")
await element.click()

# å®šä½å¤šä¸ªå…ƒç´ 
elements = await agent.ai_locate_all("å•†å“å¡ç‰‡")
for element in elements:
    await element.hover()
```

### æ¡ä»¶æ–­è¨€

```python
# é¡µé¢çŠ¶æ€éªŒè¯
await agent.ai_assert("ç”¨æˆ·å·²æˆåŠŸç™»å½•")
await agent.ai_assert("è´­ç‰©è½¦æ˜¾ç¤º 3 ä»¶å•†å“")
await agent.ai_assert("é¡µé¢ä¸åŒ…å«é”™è¯¯ä¿¡æ¯")

# å…ƒç´ å­˜åœ¨æ€§éªŒè¯
await agent.ai_assert("é¡µé¢åŒ…å«æœç´¢ç»“æœ")
await agent.ai_assert("æ˜¾ç¤ºç”¨æˆ·ä¸ªäººä¿¡æ¯")
```

## ğŸ“Š æŸ¥çœ‹æ‰§è¡ŒæŠ¥å‘Š

Midscene Python è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†çš„æ‰§è¡ŒæŠ¥å‘Šï¼š

```python
# è¿è¡Œåï¼Œæ£€æŸ¥ç”Ÿæˆçš„æŠ¥å‘Šæ–‡ä»¶
# æŠ¥å‘Šä½ç½®: ./midscene_reports/
# - execution_report.html  # å¯è§†åŒ–æŠ¥å‘Š
# - screenshots/           # æ‰§è¡Œæˆªå›¾
# - logs/                  # è¯¦ç»†æ—¥å¿—
```

## ğŸ” è°ƒè¯•æŠ€å·§

### å¯ç”¨è¯¦ç»†æ—¥å¿—

```python
import logging
from midscene.shared.logger import setup_logger

# å¯ç”¨è°ƒè¯•æ—¥å¿—
setup_logger(level=logging.DEBUG)
```

### æˆªå›¾è°ƒè¯•

```python
# æ‰‹åŠ¨æˆªå›¾
screenshot = await page.screenshot()
with open("debug.png", "wb") as f:
    f.write(screenshot)

# è·å–é¡µé¢ä¿¡æ¯
context = await page.get_context()
print(f"é¡µé¢æ ‡é¢˜: {context.page_title}")
print(f"é¡µé¢ URL: {context.url}")
```

## ğŸš¨ å¸¸è§é—®é¢˜

### 1. AI æ¨¡å‹è°ƒç”¨å¤±è´¥
```python
# æ£€æŸ¥ API Key é…ç½®
import os
print(f"API Key: {os.getenv('OPENAI_API_KEY')[:10]}...")
```

### 2. å…ƒç´ å®šä½å¤±è´¥
```python
# ä½¿ç”¨æ›´å…·ä½“çš„æè¿°
await agent.ai_action("ç‚¹å‡»é¡µé¢å·¦ä¸Šè§’çš„è“è‰²ç™»å½•æŒ‰é’®")
```

### 3. é¡µé¢åŠ è½½é—®é¢˜
```python
# æ·»åŠ ç­‰å¾…æ—¶é—´
await page.wait_for_page_load()
await agent.ai_action("ç­‰å¾… 3 ç§’è®©é¡µé¢å®Œå…¨åŠ è½½")
```

## ğŸ“ ä¸‹ä¸€æ­¥

æ­å–œï¼ä½ å·²ç»æŒæ¡äº† Midscene Python çš„åŸºç¡€ç”¨æ³•ã€‚æ¥ä¸‹æ¥å¯ä»¥ï¼š

1. ğŸ“– æ·±å…¥å­¦ä¹  [æ ¸å¿ƒæ¦‚å¿µ](æ ¸å¿ƒæ¦‚å¿µ/Agentæ ¸å¿ƒæ§åˆ¶å™¨.md)
2. ğŸ”§ æŸ¥çœ‹ [API å‚è€ƒ](APIå‚è€ƒ/Agent-API.md)
3. ğŸŒ äº†è§£ [Web è‡ªåŠ¨åŒ–](å¹³å°é›†æˆ/Webè‡ªåŠ¨åŒ–/README.md) é«˜çº§ç‰¹æ€§
4. ğŸ“± æ¢ç´¢ [Android è‡ªåŠ¨åŒ–](å¹³å°é›†æˆ/Androidè‡ªåŠ¨åŒ–.md)
5. ğŸ¯ å‚è€ƒ [æœ€ä½³å®è·µ](ç¤ºä¾‹å’Œæ•™ç¨‹/æœ€ä½³å®è·µ.md)

## ğŸ’¡ å°è´´å£«

- ä½¿ç”¨å…·ä½“ã€æ¸…æ™°çš„è‡ªç„¶è¯­è¨€æè¿°èƒ½è·å¾—æ›´å¥½çš„æ‰§è¡Œæ•ˆæœ
- å®šæœŸæŸ¥çœ‹æ‰§è¡ŒæŠ¥å‘Šæ¥ä¼˜åŒ–è‡ªåŠ¨åŒ–è„šæœ¬
- å–„ç”¨ç¼“å­˜æœºåˆ¶æ¥æå‡æ‰§è¡Œæ•ˆç‡
- ä¸ºä¸åŒç¯å¢ƒé…ç½®ä¸åŒçš„ AI æ¨¡å‹

---

*å‡†å¤‡å¥½æ¢ç´¢æ›´å¤šåŠŸèƒ½äº†å—ï¼ŸæŸ¥çœ‹æˆ‘ä»¬çš„ [ç¤ºä¾‹é›†åˆ](ç¤ºä¾‹å’Œæ•™ç¨‹/åŸºç¡€ç¤ºä¾‹.md)ï¼*