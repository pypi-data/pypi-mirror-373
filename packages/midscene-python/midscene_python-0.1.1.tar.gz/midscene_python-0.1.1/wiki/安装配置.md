# å®‰è£…é…ç½®

æœ¬ç« èŠ‚è¯¦ç»†ä»‹ç» Midscene Python çš„å®‰è£…æ­¥éª¤ã€ç¯å¢ƒé…ç½®å’Œä¾èµ–ç®¡ç†ã€‚

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€è¦æ±‚
- **Python**: 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows 10+, macOS 10.14+, Linux (Ubuntu 18.04+)
- **å†…å­˜**: æœ€å°‘ 4GB RAMï¼ˆæ¨è 8GB+ï¼‰
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥ï¼ˆç”¨äº AI æ¨¡å‹è°ƒç”¨ï¼‰

### AI æ¨¡å‹è¦æ±‚
è‡³å°‘éœ€è¦ä»¥ä¸‹ AI æœåŠ¡ä¹‹ä¸€çš„ API è®¿é—®æƒé™ï¼š
- OpenAI GPT-4V
- Anthropic Claude 3
- é˜¿é‡Œäº‘é€šä¹‰åƒé—® VL
- Google Gemini Pro Vision

## ğŸš€ å¿«é€Ÿå®‰è£…

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ pip å®‰è£…ï¼ˆæ¨èï¼‰
```bash
# å®‰è£…æœ€æ–°ç‰ˆæœ¬
pip install midscene-python

# æˆ–æŒ‡å®šç‰ˆæœ¬
pip install midscene-python==0.1.0
```

### æ–¹å¼äºŒï¼šä»æºç å®‰è£…
```bash
# å…‹éš†ä»“åº“
git clone https://gitee.com/Python51888/midscene-python.git
cd midscene-python

# å®‰è£…ä¾èµ–å¹¶å®‰è£…
pip install -e .
```

### æ–¹å¼ä¸‰ï¼šå¼€å‘è€…å®‰è£…
```bash
# å…‹éš†ä»“åº“
git clone https://gitee.com/Python51888/midscene-python.git
cd midscene-python

# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev,docs]"

# å®‰è£… pre-commit hooks
pre-commit install
```

## ğŸ”§ å¹³å°ç‰¹å®šé…ç½®

### Web è‡ªåŠ¨åŒ–é…ç½®

#### Selenium é…ç½®
```bash
# å®‰è£… Selenium å’Œ WebDriver ç®¡ç†å™¨
pip install selenium webdriver-manager

# Python ä»£ç ä¸­è‡ªåŠ¨ç®¡ç†é©±åŠ¨
from selenium import webdriver
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service

service = Service(ChromeDriverManager().install())
driver = webdriver.Chrome(service=service)
```

#### Playwright é…ç½®
```bash
# å®‰è£… Playwright
pip install playwright

# å®‰è£…æµè§ˆå™¨
playwright install

# ä»…å®‰è£… Chromiumï¼ˆèŠ‚çœç©ºé—´ï¼‰
playwright install chromium
```

### Android è‡ªåŠ¨åŒ–é…ç½®

#### ADB è®¾ç½®
```bash
# å®‰è£… ADBï¼ˆUbuntu/Debianï¼‰
sudo apt-get install android-tools-adb

# å®‰è£… ADBï¼ˆmacOSï¼‰
brew install android-platform-tools

# å®‰è£… ADBï¼ˆWindowsï¼‰
# ä¸‹è½½ Android SDK Platform Tools
# æ·»åŠ åˆ°ç³»ç»Ÿ PATH
```

#### è®¾å¤‡è¿æ¥
```bash
# å¯ç”¨å¼€å‘è€…é€‰é¡¹å’Œ USB è°ƒè¯•
# è¿æ¥è®¾å¤‡åéªŒè¯
adb devices

# é¢„æœŸè¾“å‡º
List of devices attached
DEVICE_ID    device
```

## ğŸ”‘ AI æ¨¡å‹é…ç½®

### ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# OpenAI é…ç½®
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_BASE_URL=https://api.openai.com/v1  # å¯é€‰

# Anthropic é…ç½®
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# é€šä¹‰åƒé—®é…ç½®
DASHSCOPE_API_KEY=sk-your-dashscope-key

# Gemini é…ç½®
GOOGLE_API_KEY=AIza-your-google-api-key

# é»˜è®¤æ¨¡å‹é…ç½®
MIDSCENE_AI_PROVIDER=openai
MIDSCENE_AI_MODEL=gpt-4-vision-preview
```

### ä»£ç é…ç½®
```python
from midscene.core.ai_model import AIModelConfig

# å¤šä¸ª AI æä¾›å•†é…ç½®
configs = {
    "openai": AIModelConfig(
        provider="openai",
        model="gpt-4-vision-preview",
        api_key="your-openai-key",
        temperature=0.1
    ),
    "claude": AIModelConfig(
        provider="anthropic", 
        model="claude-3-sonnet-20240229",
        api_key="your-claude-key",
        temperature=0.1
    )
}
```

## ğŸ“¦ ä¾èµ–ç®¡ç†

### æ ¸å¿ƒä¾èµ–
```toml
# pyproject.toml ä¸­çš„æ ¸å¿ƒä¾èµ–
[project]
dependencies = [
    "pydantic>=2.0,<3.0",
    "selenium>=4.15.0,<5.0", 
    "playwright>=1.40.0,<2.0",
    "opencv-python>=4.8.0,<5.0",
    "pillow>=10.0.0,<11.0",
    "aiohttp>=3.9.0,<4.0",
    "loguru>=0.7.0,<1.0",
    "typer>=0.9.0,<1.0",
    "httpx>=0.25.0,<1.0",
    "openai>=1.3.0,<2.0",
    "anthropic>=0.7.0,<1.0"
]
```

### å¯é€‰ä¾èµ–
```bash
# å¼€å‘å·¥å…·
pip install "midscene-python[dev]"

# æ–‡æ¡£å·¥å…·
pip install "midscene-python[docs]"

# å…¨éƒ¨ä¾èµ–
pip install "midscene-python[dev,docs]"
```

## ğŸ” éªŒè¯å®‰è£…

### åŸºç¡€éªŒè¯
```python
# test_installation.py
import asyncio
from midscene import Agent
from midscene.core.ai_model import AIModelService

async def test_installation():
    """æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ"""
    
    # æµ‹è¯•å¯¼å…¥
    print("âœ“ å¯¼å…¥æ¨¡å—æˆåŠŸ")
    
    # æµ‹è¯• AI æœåŠ¡é…ç½®
    try:
        ai_service = AIModelService()
        print("âœ“ AI æœåŠ¡åˆå§‹åŒ–æˆåŠŸ")
    except Exception as e:
        print(f"âœ— AI æœåŠ¡åˆå§‹åŒ–å¤±è´¥: {e}")
    
    print("ğŸ‰ å®‰è£…éªŒè¯å®Œæˆï¼")

# è¿è¡Œæµ‹è¯•
asyncio.run(test_installation())
```

### Web å¹³å°éªŒè¯
```python
# test_web.py
import asyncio
from midscene import Agent
from midscene.web import SeleniumWebPage

async def test_web():
    """æµ‹è¯• Web å¹³å°åŠŸèƒ½"""
    try:
        with SeleniumWebPage.create() as page:
            agent = Agent(page)
            await page.goto("https://www.example.com")
            print("âœ“ Web è‡ªåŠ¨åŒ–æµ‹è¯•æˆåŠŸ")
    except Exception as e:
        print(f"âœ— Web è‡ªåŠ¨åŒ–æµ‹è¯•å¤±è´¥: {e}")

asyncio.run(test_web())
```

### Android å¹³å°éªŒè¯
```python
# test_android.py
import asyncio
from midscene import Agent
from midscene.android import AndroidDevice

async def test_android():
    """æµ‹è¯• Android å¹³å°åŠŸèƒ½"""
    try:
        device = AndroidDevice()
        await device.connect()
        agent = Agent(device)
        print("âœ“ Android è‡ªåŠ¨åŒ–æµ‹è¯•æˆåŠŸ")
    except Exception as e:
        print(f"âœ— Android è‡ªåŠ¨åŒ–æµ‹è¯•å¤±è´¥: {e}")

asyncio.run(test_android())
```

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### Python ç‰ˆæœ¬é—®é¢˜
```bash
# æ£€æŸ¥ Python ç‰ˆæœ¬
python --version

# å¦‚æœç‰ˆæœ¬ä½äº 3.9ï¼Œå®‰è£…æ–°ç‰ˆæœ¬
# Ubuntu/Debian
sudo apt-get install python3.9

# macOS
brew install python@3.9

# Windows
# ä» python.org ä¸‹è½½å®‰è£…
```

### ä¾èµ–å†²çªè§£å†³
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv midscene-env
source midscene-env/bin/activate  # Linux/macOS
# æˆ–
midscene-env\Scripts\activate     # Windows

# åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…
pip install midscene-python
```

### ç½‘ç»œè¿æ¥é—®é¢˜
```bash
# ä½¿ç”¨å›½å†…é•œåƒæº
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple midscene-python

# æˆ–é…ç½®æ°¸ä¹…é•œåƒæº
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```

### AI API è¿æ¥é—®é¢˜
```python
# æµ‹è¯• API è¿æ¥
import os
import httpx

async def test_openai_connection():
    api_key = os.getenv("OPENAI_API_KEY")
    if not api_key:
        print("âŒ æœªè®¾ç½® OPENAI_API_KEY")
        return
    
    async with httpx.AsyncClient() as client:
        try:
            response = await client.get(
                "https://api.openai.com/v1/models",
                headers={"Authorization": f"Bearer {api_key}"}
            )
            if response.status_code == 200:
                print("âœ… OpenAI API è¿æ¥æ­£å¸¸")
            else:
                print(f"âŒ OpenAI API è¿æ¥å¤±è´¥: {response.status_code}")
        except Exception as e:
            print(f"âŒ ç½‘ç»œè¿æ¥é”™è¯¯: {e}")
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–é…ç½®

### ç³»ç»Ÿçº§ä¼˜åŒ–
```bash
# å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼ˆLinux/macOSï¼‰
ulimit -n 65536

# è®¾ç½®ç¯å¢ƒå˜é‡ä¼˜åŒ–
export PYTHONUNBUFFERED=1
export PYTHONDONTWRITEBYTECODE=1
```

### Python é…ç½®ä¼˜åŒ–
```python
# config.py
import asyncio

# è®¾ç½®å¼‚æ­¥äº‹ä»¶å¾ªç¯ç­–ç•¥
if hasattr(asyncio, 'WindowsSelectorEventLoopPolicy'):
    asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())

# é…ç½®æ—¥å¿—çº§åˆ«
import logging
logging.getLogger("httpx").setLevel(logging.WARNING)
logging.getLogger("selenium").setLevel(logging.WARNING)
```

## ğŸ“‹ é…ç½®æ£€æŸ¥æ¸…å•

### å®‰è£…å®Œæˆæ£€æŸ¥
- [ ] Python 3.9+ å·²å®‰è£…
- [ ] midscene-python åŒ…å·²å®‰è£…
- [ ] è‡³å°‘ä¸€ä¸ª AI æä¾›å•†å·²é…ç½®
- [ ] Web é©±åŠ¨ç¨‹åºå·²å®‰è£…ï¼ˆå¦‚æœä½¿ç”¨ Web è‡ªåŠ¨åŒ–ï¼‰
- [ ] ADB å·²å®‰è£…å¹¶è®¾å¤‡å·²è¿æ¥ï¼ˆå¦‚æœä½¿ç”¨ Android è‡ªåŠ¨åŒ–ï¼‰

### ç¯å¢ƒé…ç½®æ£€æŸ¥
- [ ] ç¯å¢ƒå˜é‡å·²è®¾ç½®
- [ ] API å¯†é’¥æœ‰æ•ˆä¸”æœ‰è¶³å¤Ÿé¢åº¦
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸
- [ ] é˜²ç«å¢™å’Œä»£ç†é…ç½®æ­£ç¡®

### åŠŸèƒ½æµ‹è¯•æ£€æŸ¥
- [ ] åŸºç¡€å¯¼å…¥æµ‹è¯•é€šè¿‡
- [ ] AI æœåŠ¡åˆå§‹åŒ–æˆåŠŸ
- [ ] é€‰æ‹©çš„å¹³å°ï¼ˆWeb/Androidï¼‰æµ‹è¯•é€šè¿‡
- [ ] ç¤ºä¾‹ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œ

## ğŸ”„ å‡çº§å’Œç»´æŠ¤

### ç‰ˆæœ¬å‡çº§
```bash
# æ£€æŸ¥å½“å‰ç‰ˆæœ¬
pip show midscene-python

# å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬
pip install --upgrade midscene-python

# å‡çº§ç‰¹å®šç‰ˆæœ¬
pip install midscene-python==0.2.0
```

### é…ç½®å¤‡ä»½
```bash
# å¤‡ä»½é…ç½®æ–‡ä»¶
cp .env .env.backup
cp pyproject.toml pyproject.toml.backup

# å¯¼å‡ºä¾èµ–åˆ—è¡¨
pip freeze > requirements.txt
```

### æ¸…ç†å’Œé‡è£…
```bash
# å¸è½½å½“å‰ç‰ˆæœ¬
pip uninstall midscene-python

# æ¸…ç†ç¼“å­˜
pip cache purge

# é‡æ–°å®‰è£…
pip install midscene-python
```

---

å®Œæˆé…ç½®åï¼Œæ‚¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨ Midscene Python è¿›è¡Œ AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–äº†ï¼æ¥ä¸‹æ¥æ¨èé˜…è¯» [å¿«é€Ÿå¼€å§‹](å¿«é€Ÿå¼€å§‹.md) æŒ‡å—ã€‚