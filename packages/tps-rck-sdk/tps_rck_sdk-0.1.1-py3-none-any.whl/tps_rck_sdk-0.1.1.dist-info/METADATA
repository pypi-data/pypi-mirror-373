Metadata-Version: 2.4
Name: tps-rck-sdk
Version: 0.1.1
Summary: Official Python SDK for the Relational Calculate Kernel (RCK)
Author-email: Topos-Pathless-Service <omorsablin@gmail.com>
Project-URL: Homepage, https://github.com/TPS/rck-sdk
Project-URL: Issues, https://github.com/TPS/rck-sdk/issues
Classifier: Programming Language :: Python :: 3
Classifier: Operating System :: OS Independent
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: requests>=2.28.0
Requires-Dist: pydantic>=2.0
Requires-Dist: ratelimit>=2.2.1

# Topos Pathless Service RCK Python SDK å®Œæ•´æ•™ç¨‹

### ğŸ¯ RCKï¼šPathless ä¸­çš„éä¼ ç»Ÿè®¡ç®—å¼•æ“

**RCK (Relational Calculate Kernel)** æ˜¯ Pathless æœåŠ¡ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œä¸“é—¨è´Ÿè´£**éä¼ ç»Ÿã€éç¡®å®šæ€§è®¡ç®—ä»»åŠ¡**çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬ï¼š
- **ç¼–è¯‘**ï¼šå°†è‡ªç„¶è¯­è¨€éœ€æ±‚è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„è®¡ç®—é€»è¾‘
- **éƒ¨ç½²**ï¼šè‡ªåŠ¨éƒ¨ç½²åˆ°äº‘åŸç”Ÿç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
- **è¿è¡Œ**ï¼šæ‰§è¡Œéç¡®å®šæ€§è®¡ç®—ä»»åŠ¡ï¼Œæ”¯æŒåŠ¨æ€è°ƒæ•´
- **ç›‘æ§**ï¼šå®æ—¶ç›‘æ§è®¡ç®—è¿‡ç¨‹å’Œç»“æœè´¨é‡

### ğŸ¯ Pathless æ ¸å¿ƒç†å¿µï¼šç›®æ ‡é©±åŠ¨ï¼Œè·¯å¾„æ— å…³

ä¼ ç»Ÿç¼–ç¨‹æ€ç»´ï¼Œå¼€å‘è€…éœ€è¦ç¼–å†™å…·ä½“çš„ç®—æ³•æ­¥éª¤å’Œå®ç°ç»†èŠ‚ï¼š
```python
def process_data(input_data):
    step1 = parse(input_data)
    step2 = validate(step1)
    step3 = transform(step2)
    return step3
```

Pathless ç¼–ç¨‹æ€ç»´ï¼Œå¼€å‘è€…åªéœ€å®šä¹‰ç›®æ ‡å’Œçº¦æŸï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‰¾åˆ°å®ç°è·¯å¾„ï¼š
```python
import tps_rck_sdk
from tps_rck_sdk import EndpointModel

class MySchema(EndpointModel):
    # ... define schema fields

result = tps_rck_sdk.structured_transform(
    input_text=input_data,
    function_logic="æå–å…³é”®ä¿¡æ¯å¹¶ç»“æ„åŒ–",
    output_schema=MySchema
)
```

---

## ğŸ“¦ å®‰è£…

è¦å°† RCK Python SDK æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œè¯·ä½¿ç”¨ `pip` å‘½ä»¤ï¼š

```bash
pip install pydantic
pip install tps-rck-sdk
```

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹

### 1. å¯¼å…¥å’Œåˆå§‹åŒ–å®¢æˆ·ç«¯

åœ¨æ‚¨çš„åº”ç”¨å¯åŠ¨æ—¶ï¼Œè°ƒç”¨ `configure` å‡½æ•°æ¥è®¾ç½®å…¨å±€ API å¯†é’¥å’Œå…¶ä»–å¯é€‰å‚æ•°ã€‚

```python
import tps_rck_sdk
import os

# æ¨èä»ç¯å¢ƒå˜é‡æˆ–å®‰å…¨é…ç½®ä¸­è¯»å– API å¯†é’¥
api_key = os.getenv("RCK_API_KEY", "YOUR_API_KEY")

# åŸºæœ¬é…ç½®
tps_rck_sdk.configure(api_key=api_key)

# é«˜çº§é…ç½® - ä¼˜åŒ–æ€§èƒ½å’Œå¹¶å‘
tps_rck_sdk.configure(
    api_key=api_key,
    base_url="https://rck-aehhddpisa.us-west-1.fcapp.run",
    rate_limit_calls=15,          # æ¯60ç§’æœ€å¤§15æ¬¡è°ƒç”¨
    rate_limit_period=60,
    max_concurrent_requests=5,    # æœ€å¤§å¹¶å‘è¯·æ±‚æ•°
    default_timeout=60.0          # é»˜è®¤è¶…æ—¶æ—¶é—´(ç§’)
)
```

### 2. å‘èµ·ä½ çš„ç¬¬ä¸€æ¬¡ API è°ƒç”¨

è¿™æ˜¯ä¸€ä¸ªä»æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯çš„ç®€å•ç¤ºä¾‹ã€‚Pathless çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Pydantic æ¨¡å‹æ¥å®šä¹‰æœŸæœ›çš„è¾“å‡ºç»“æ„ã€‚

```python
from tps_rck_sdk import EndpointModel, structured_transform
from pydantic import Field
from typing import List

# 1. ä½¿ç”¨ Pydantic å®šä¹‰è¾“å‡ºæ•°æ®ç»“æ„
class TechStack(EndpointModel):
    languages: List[str] = Field(description="ç¼–ç¨‹è¯­è¨€")
    frameworks: List[str] = Field(description="æ¡†æ¶æˆ–åº“")

# 2. è°ƒç”¨ APIï¼Œæè¿°ä½ çš„ç›®æ ‡
try:
    result = structured_transform(
        input_text="é¡¹ç›®åç«¯éœ€è¦ç”¨ Python å’Œ Djangoï¼Œå‰ç«¯åˆ™ä½¿ç”¨ Reactã€‚",
        output_schema=TechStack,
        function_logic="ä»ç”¨æˆ·çš„éœ€æ±‚ä¸­æå–æŠ€æœ¯æ ˆä¿¡æ¯ã€‚",
        config_overrides={"speed": "fast"} # å¯é€‰ï¼šè¦†ç›–å…¨å±€é…ç½®
    )

    # 3. ç›´æ¥è·å¾—ç±»å‹å®‰å…¨çš„ Pydantic å¯¹è±¡
    print(result.model_dump_json(indent=2))
    # é¢„æœŸè¾“å‡º:
    # {
    #   "languages": [
    #     "Python"
    #   ],
    #   "frameworks": [
    #     "Django",
    #     "React"
    #   ]
    # }

except tps_rck_sdk.RCKAPIError as e:
    print(f"API è¯·æ±‚å¤±è´¥: {e}")

```

---

## ğŸ›ï¸ SDK æ¶æ„ä¸å¼•æ“é€‰æ‹©

SDK æä¾›äº†ä¸€ç³»åˆ—é«˜çº§å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯¹åº” RCK åç«¯çš„ä¸€ä¸ªä¸“ç”¨å¼•æ“ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ `auto` å‡½æ•°è®© RCK è‡ªåŠ¨ä¸ºæ‚¨é€‰æ‹©æœ€åˆé€‚çš„å¼•æ“ã€‚

```mermaid
graph TD
    A[è®¡ç®—ä»»åŠ¡] --> B{ä»»åŠ¡ç±»å‹?}
    B -->|ç»“æ„åŒ–è½¬æ¢| C[structured_transform<br/>ğŸ¯ Standard å¼•æ“]
    B -->|ç¤ºä¾‹å­¦ä¹ | D[learn_from_examples<br/>ğŸ§² Attractor å¼•æ“]
    B -->|æ–‡æœ¬/ä»£ç ç”Ÿæˆ| E[generate_text<br/>ğŸ’« Pure å¼•æ“]
    B -->|å›¾åƒç”Ÿæˆ| F[generate_image<br/>ğŸ¨ Image å¼•æ“]
    B -->|ä¸ç¡®å®š?| G[auto<br/>ğŸ¤– è‡ªåŠ¨é€‰æ‹©å¼•æ“]
```

---

## ğŸ“– API è¯¦ç»†ç”¨æ³•

### `structured_transform`

é€šç”¨AIè®¡ç®—ï¼Œå°†éç»“æ„åŒ–è¾“å…¥è½¬æ¢ä¸ºç²¾ç¡®çš„ã€éµå¾ª Pydantic æ¨¡å¼çš„ç»“æ„åŒ–è¾“å‡ºã€‚

- **å‚æ•°:**
  - `input_text` (str, **å¿…éœ€**): éœ€è¦å¤„ç†çš„è¾“å…¥æ–‡æœ¬ã€‚
  - `output_schema` (Type[EndpointModel], **å¿…éœ€**): ç”¨äºå®šä¹‰è¾“å‡ºç»“æ„çš„ Pydantic æ¨¡å‹ã€‚
  - `function_logic` (str, **å¿…éœ€**): å¯¹ä»»åŠ¡çš„è‡ªç„¶è¯­è¨€æè¿°ã€‚
  - `config_overrides` (dict, å¯é€‰): è¦†ç›–å…¨å±€é…ç½®ï¼Œä¾‹å¦‚ `{"speed": "quality", "temperature": 0.5}`ã€‚
- **è¿”å›:** `EndpointModel` çš„å®ä¾‹ã€‚

- **ç¤ºä¾‹:**
```python
class UserInfo(EndpointModel):
    name: str
    age: int

user = structured_transform(
    input_text="ç”¨æˆ·å«å¼ ä¸‰ï¼Œä»Šå¹´25å²ã€‚",
    output_schema=UserInfo,
    function_logic="æå–å§“åå’Œå¹´é¾„ã€‚"
)
print(f"å§“å: {user.name}, å¹´é¾„: {user.age}")
```

### `generate_text`

è‡ªç„¶è¯­è¨€ç”Ÿæˆï¼Œç”¨äºåˆ›æ„å†™ä½œã€ä»£ç ç”Ÿæˆç­‰ä»»åŠ¡ã€‚

- **å‚æ•°:**
  - `input_text` (str, **å¿…éœ€**): è¾“å…¥çš„æç¤ºæˆ–ä¸Šä¸‹æ–‡ã€‚
  - `function_logic` (str, **å¿…éœ€**): å¯¹ç”Ÿæˆä»»åŠ¡çš„æè¿°ã€‚
- **è¿”å›:** `str`ã€‚

- **ç¤ºä¾‹:**
```python
code = generate_text(
    input_text="ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ Python å‡½æ•°",
    function_logic="åªç”Ÿæˆå‡½æ•°ä»£ç ï¼Œä¸è¦ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€‚"
)
print(code)
```

### `learn_from_examples`

é€šè¿‡å°‘é‡æ ·æœ¬å½’çº³å‡ºæ¨¡å¼å’Œé€»è¾‘ï¼Œç„¶åå¤„ç†æ–°æ•°æ®ã€‚

- **å‚æ•°:**
  - `input_model` (AttractorInputBase, **å¿…éœ€**): éœ€è¦åº”ç”¨å­¦ä¹ åˆ°æ¨¡å¼çš„æ–°è¾“å…¥ Pydantic æ¨¡å‹ã€‚
  - `output_schema` (Type[EndpointModel], **å¿…éœ€**): æœŸæœ›è¾“å‡ºçš„ Pydantic æ¨¡å‹ã€‚
  - `examples` (List[Tuple[Input, Output]], **å¿…éœ€**): ä¸€ä¸ªæˆ–å¤šä¸ª `(è¾“å…¥æ¨¡å‹, è¾“å‡ºæ¨¡å‹)` çš„å…ƒç»„ã€‚
- **è¿”å›:** `EndpointModel` çš„å®ä¾‹ã€‚

- **ç¤ºä¾‹:**
```python
from tps_rck_sdk import AttractorInputBase

class Product(AttractorInputBase):
    description: str

class ProductCategory(EndpointModel):
    category: str

examples = [
    (Product(description="è‹¹æœå…¬å¸çš„æœ€æ–°æ™ºèƒ½æ‰‹æœº"), ProductCategory(category="ç”µå­äº§å“")),
    (Product(description="ä¸€æœ¬å…³äºä¸­ä¸–çºªå†å²çš„ä¹¦"), ProductCategory(category="ä¹¦ç±")),
]
new_product = Product(description="æ–°é²œé‡‡æ‘˜çš„æœ‰æœºè‰è“")

result = learn_from_examples(
    input_model=new_product,
    output_schema=ProductCategory,
    examples=examples
)
print(result.category) # -> "é£Ÿå“"
```

### `generate_image`

æ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆå›¾åƒã€‚

- **å‚æ•°:**
  - `input_text` (str, **å¿…éœ€**): å›¾åƒæ ¸å¿ƒå†…å®¹çš„æè¿°ã€‚
  - `composition` (str, **å¿…éœ€**): æ„å›¾å’Œé•œå¤´æè¿°ã€‚
  - `lighting` (str, **å¿…éœ€**): å…‰ç…§æ¡ä»¶æè¿°ã€‚
  - `style` (str, **å¿…éœ€**): è‰ºæœ¯é£æ ¼æè¿°ã€‚
- **è¿”å›:** `ImageResponse`ã€‚

- **ç¤ºä¾‹:**
```python
image_response = generate_image(
    input_text="ä¸€åªé›„ä¼Ÿçš„å·¨é¾™é£è¶Šæ°´æ™¶åŸå ¡",
    composition="ä»ä¸‹æ–¹æ‹æ‘„çš„å¹¿è§’é•œå¤´ï¼Œå¼ºè°ƒå·¨é¾™çš„å·¨å¤§",
    lighting="é»„é‡‘æ—¶åˆ»çš„é˜³å…‰",
    style="å²è¯—å¥‡å¹»æ•°å­—ç»˜ç”»é£æ ¼"
)

if image_response.images:
    # imageData æ˜¯è§£ç åçš„ bytesï¼Œå¯ç›´æ¥å†™å…¥æ–‡ä»¶
    image_bytes = image_response.images[0].imageData
    with open("dragon.png", "wb") as f:
        f.write(image_bytes)
    print("å›¾åƒå·²ä¿å­˜ä¸º dragon.png")
```

### `auto`

è‡ªåŠ¨æ¨¡å¼ï¼Œè®© RCK åç«¯æ ¹æ®æ‚¨çš„å‚æ•°æ™ºèƒ½åœ°å†³å®šè°ƒç”¨å“ªä¸ªå¼•æ“ã€‚å½“æ‚¨ä¸ç¡®å®šä»»åŠ¡ç±»å‹æ—¶ï¼Œè¿™æ˜¯æœ€ä½³é€‰æ‹©ã€‚

- **å‚æ•°:** çµæ´»çš„å‚æ•°ç»„åˆï¼Œè‡³å°‘éœ€è¦ `input_text` å’Œä¸€ä¸ªé€»è¾‘å®šä¹‰å‚æ•°ï¼ˆå¦‚ `function_logic`, `examples`, æˆ–å›¾åƒå‚æ•°ï¼‰ã€‚
- **è¿”å›:** `Union[EndpointModel, ImageResponse, str, dict]` - è¿”å›ç±»å‹ä¸ç¡®å®šï¼Œéœ€è¦è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚

- **ç¤ºä¾‹:**
```python
from tps_rck_sdk import auto, ImageResponse

# åœºæ™¯1ï¼šå¯èƒ½è¿”å›ç»“æ„åŒ–æ•°æ®
result = auto(
    input_text="åˆ†ææƒ…æ„Ÿï¼š'è¿™å¤ªæ£’äº†ï¼'",
    function_logic="è¿”å›åŒ…å« 'sentiment' å’Œ 'confidence' çš„JSONã€‚",
    output_schema=SentimentSchema 
)
if isinstance(result, SentimentSchema):
    print(f"æƒ…æ„Ÿ: {result.sentiment}")

# åœºæ™¯2ï¼šå¯èƒ½è¿”å›æ–‡æœ¬
result = auto(
    input_text="ç”¨ä¸€å¥è¯æ€»ç»“ç›¸å¯¹è®º",
    function_logic="æä¾›ä¸€ä¸ªç®€æ´çš„æ‘˜è¦ã€‚"
)
if isinstance(result, str):
    print(f"æ‘˜è¦: {result}")

# åœºæ™¯3ï¼šå¯èƒ½è¿”å›å›¾åƒ
result = auto(
    input_text="ä¸€åªå¯çˆ±çš„å°ç†ŠçŒ«",
    composition="ç‰¹å†™",
    lighting="æŸ”å’Œçš„å…‰çº¿",
    style="ç…§ç‰‡çº§çœŸå®æ„Ÿ"
)
if isinstance(result, ImageResponse):
    print(f"ç”Ÿæˆäº† {result.count} å¼ å›¾ç‰‡ã€‚")
```

---

## ğŸ“¥ å¤„ç†å“åº”

- **ç»“æ„åŒ–æ•°æ®**: `structured_transform`, `learn_from_examples` å’Œ `auto` (å½“æä¾› `output_schema` æ—¶) ç›´æ¥è¿”å›æ‚¨å®šä¹‰çš„ Pydantic æ¨¡å‹å®ä¾‹ï¼Œæ‚¨å¯ä»¥ç«‹å³è®¿é—®å…¶å±æ€§ã€‚
- **æ–‡æœ¬**: `generate_text` ç›´æ¥è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
- **å›¾åƒ**: `generate_image` è¿”å›ä¸€ä¸ª `ImageResponse` å¯¹è±¡ã€‚
  - `response.images`: `List[ImageDetails]` - åŒ…å«æ‰€æœ‰å›¾åƒä¿¡æ¯çš„åˆ—è¡¨ã€‚
  - `image.imageData`: `bytes` - å›¾åƒçš„åŸå§‹å­—èŠ‚æ•°æ®ï¼Œå¯ç›´æ¥ç”¨äºä¿å­˜æˆ–å¤„ç†ã€‚
  - `image.data_url`: `str` - å›¾åƒçš„ Base64 Data URLã€‚

---

## ğŸš¨ é”™è¯¯å¤„ç†

å½“APIè¯·æ±‚å¤±è´¥æˆ–å‚æ•°éªŒè¯ä¸é€šè¿‡æ—¶ï¼ŒSDKä¼šæŠ›å‡ºç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚

```python
from tps_rck_sdk import RCKAPIError, RCKConfigurationError

try:
    # ... ä½ çš„ API è°ƒç”¨
except RCKAPIError as e:
    # æ¥è‡ªæœåŠ¡å™¨çš„é”™è¯¯
    print(f"API Error: {e}")
    print(f"Status Code: {e.status_code}")
    print(f"Response Body: {e.response_body}")
except RCKConfigurationError as e:
    # SDK é…ç½®é”™è¯¯
    print(f"Configuration Error: {e}")
except Exception as e:
    # å…¶ä»–ç½‘ç»œé”™è¯¯æˆ–æœªçŸ¥é”™è¯¯
    print(f"An unexpected error occurred: {e}")
```

- `RCKAPIError`: è¡¨ç¤ºæœåŠ¡å™¨è¿”å›äº†ä¸€ä¸ªé”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œ4xxæˆ–5xxçŠ¶æ€ç ï¼‰ã€‚
- `RCKConfigurationError`: è¡¨ç¤º SDK æœªæ­£ç¡®é…ç½®ï¼ˆä¾‹å¦‚ï¼Œç¼ºå°‘ API å¯†é’¥ï¼‰ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯æˆæƒã€‚



