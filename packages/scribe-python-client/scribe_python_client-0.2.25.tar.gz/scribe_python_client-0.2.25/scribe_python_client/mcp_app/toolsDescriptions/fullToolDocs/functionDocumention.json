{
    "name": "query_findings",
    "description": "Use this function to answer questions about security findings from tools, such as severities, CWE types, affected components, or file locations. Use it when asking about issues found in scans, their severity, tool origin, or impacted products.",
    "tableName": "Findings",
    "examples": {
        "1:": {
            "question": "What are the high-severity findings across all tools?",
            "function": "query_findings",
            "querystr": {
                "columns": [
                    "title",
                    "severity_string",
                    "main_tool",
                    "logical_app"
                ],
                "filters": [
                    {
                        "col": "severity_string",
                        "op": "in",
                        "val": [
                            "HIGH",
                            "CRITICAL"
                        ]
                    }
                ],
                "metrics": [],
                "groupby": [],
                "orderby": [
                    [
                        "severity_string",
                        true
                    ]
                ],
                "row_limit": 30
            }
        },
        "2": {
            "question": "How many findings exist for each product?",
            "function": "query_findings",
            "querystr": {
                "columns": [
                    "logical_app"
                ],
                "filters": [],
                "metrics": [
                    {
                        "label": "finding_count",
                        "expressionType": "SQL",
                        "sqlExpression": "COUNT(*)"
                    }
                ],
                "groupby": [
                    "logical_app"
                ],
                "orderby": [
                    [
                        "finding_count",
                        true
                    ]
                ],
                "row_limit": 30
            }
        },
        "3": {
            "question": "Show me findings with a CVSS score above 7.",
            "function": "query_findings",
            "querystr": {
                "columns": [
                    "title",
                    "cvssv3",
                    "logical_app",
                    "component_name"
                ],
                "filters": [
                    {
                        "col": "cvssv3",
                        "op": ">",
                        "val": "7"
                    }
                ],
                "metrics": [],
                "groupby": [],
                "orderby": [],
                "row_limit": 30
            }
        },
        "4": {
            "question": "Which tools produce the most findings?",
            "function": "query_findings",
            "querystr": {
                "columns": [
                    "main_tool"
                ],
                "filters": [],
                "metrics": [
                    {
                        "label": "total_findings",
                        "expressionType": "SQL",
                        "sqlExpression": "COUNT(*)"
                    }
                ],
                "groupby": [
                    "main_tool"
                ],
                "orderby": [
                    [
                        "total_findings",
                        true
                    ]
                ],
                "row_limit": 30
            }
        },
        "5": {
            "question": "What types of CWEs are most commonly reported?",
            "function": "query_findings",
            "querystr": {
                "columns": [
                    "cwe_id"
                ],
                "filters": [],
                "metrics": [
                    {
                        "label": "cwe_count",
                        "expressionType": "SQL",
                        "sqlExpression": "COUNT(*)"
                    }
                ],
                "groupby": [
                    "cwe_id"
                ],
                "orderby": [
                    [
                        "cwe_count",
                        true
                    ]
                ],
                "row_limit": 30
            }
        }
    }
}