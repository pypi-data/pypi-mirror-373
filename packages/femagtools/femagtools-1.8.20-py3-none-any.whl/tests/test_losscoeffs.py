import numpy as np
import femagtools.losscoeffs

fo = 50.0
Bo = 1.5

f = [50.0, 100.0, 200.0, 400.0, 500.0, 1000.0, 2000.0]
B = [0.10103, 0.20105, 0.30106, 0.40008, 0.50109, 0.60109,
     0.70111, 0.80013, 0.90115, 1.00118, 1.10022, 1.2013,
     1.30049, 1.40116, 1.50311, 1.61841, 1.71087, 1.81709, 1.92619]

pfe = [
    (0.01859, 0.07684, 0.16358, 0.26768, 0.39037, 0.52917, 0.68284, 0.85386, 1.04347,
     1.25539, 1.49457, 1.77713, 2.12289, 2.50335, 2.89992, 3.35349, 3.65588, 3.97809, 4.28171),
    (0.04461, 0.17722, 0.37426, 0.62212, 0.91211, 1.24424, 1.61478, 2.02498, 2.48104,
     2.98914, 3.56541, 4.23834, 5.06866, 6.18773, 7.22253, 8.12348, None, None, None),
    (0.10782, 0.43127, 0.91707, 1.53547, 2.2716, 3.11803, 4.07599, 5.14797, 6.34264,
     7.70708, 9.20166, 10.96019, 13.09795, 16.00159, 18.82715, None, None, None, None),
    (0.2838, 1.13022, 2.4104, 4.04873, 6.00803, 8.32548, 10.9825, 14.00635, 17.45898,
     21.67625, 26.22441, 31.44426, 37.6766, None, None, None, None, None, None),
    (0.39409, 1.56273, 3.32623, 5.59287, 8.36762, 11.54513, 15.27785, 19.56824, 24.86492,
     30.61766, 37.20815, 44.76528, 53.71784, None, None, None, None, None, None),
    (1.16244, 4.45273, 9.37392, 15.76365, 23.62688, 33.63035, 45.09369, 58.67124,
     74.72488, 93.57929, 115.6707, 141.527, None, None, None, None, None, None, None),
    (3.57408, 13.07317, 27.14519, 46.63288, 70.58197, 100.6593, None, None,
     None, None, None, None, None, None, None, None, None, None, None)
]


def test_steinmetz():
    c = femagtools.losscoeffs.fitsteinmetz(f, B, pfe, Bo, fo)
    np.testing.assert_almost_equal(c,
                                   (1.884, 1.5827, 2.0228),
                                   decimal=4)


def test_jordan():
    c = femagtools.losscoeffs.fitjordan(f, B, pfe, Bo, fo)
    np.testing.assert_almost_equal(c,
                                   (1.3448,  0.4234,
                                    1.5702,  1.6385, 2.0473),
                                   decimal=4)
