# HR_view.yaml - Enhanced for PYYql Testing

constructed_table_name: HR_view

# Table dependencies
dependencies:
    emp:
        table_name: employee
        type: source
        source: sample_source
    dep:
        table_name: department
        type: source
        source: sample_source
    man:
        table_name: manager
        type: source
        source: sample_source

# Join relationships
join_conditions:
    - ("emp", "man", "emp.manager_id", "man.manager_id")
    - ("man", "dep", "man.department_id", "dep.department_id")

join_type: "left"

# Filter conditions
filter_condition:
    - "dep.status == 1"
    - "emp.emp_id IS NOT NULL"

# Column selection with aliases
select:
    emp.emp_id: employee_id
    emp.emp_name: employee_name
    emp.emp_joining_year: joining_year
    man.manager_id: manager_id
    man.manager_name: manager_name
    dep.department_id: department_id
    dep.department_name: department_name
    dep.status: department_status

# Sorting
sort_condition:
    - "(dep.department_name, asc)"
    - "(emp.emp_name, asc)"

# Optional aggregation example (commented out for individual employee view)
# group_condition:
#     - "dep.department_name"
# 
# aggregations:
#     emp.emp_id:
#         - "COUNT(*)"
# 
# having_condition:
#     - "COUNT(*) > 0"

# Output options
distinct: false
limit: null