export const __webpack_ids__=["24729"];export const __webpack_modules__={9224:function(t,e,i){i.d(e,{H:()=>s});const s=5},13814:function(t,e,i){i.d(e,{g:()=>n});i(2394),i(81738),i(94814),i(22960),i(6989),i(93190);var s=i(9224);const o=t=>t.reduce((t,e)=>t+parseFloat(e.state),0)/t.length,r=t=>parseFloat(t[t.length-1].state)||0,a=(t,e,i,a,n)=>{t.forEach(t=>{t.state=Number(t.state)}),t=t.filter(t=>!Number.isNaN(t.state));const c=void 0!==n?.min?n.min:Math.min(...t.map(t=>t.state)),h=void 0!==n?.max?n.max:Math.max(...t.map(t=>t.state)),d=(new Date).getTime(),l=(t,i,s)=>{const o=d-new Date(i.last_changed).getTime();let r=Math.abs(o/36e5-e);return s?(r=60*(r-Math.floor(r)),r=Number((10*Math.round(r/10)).toString()[0])):r=Math.floor(r),t[r]||(t[r]=[]),t[r].push(i),t};if(t=t.reduce((t,e)=>l(t,e,!1),[]),a>1&&(t=t.map(t=>t.reduce((t,e)=>l(t,e,!0),[]))),t.length)return((t,e,i,a,n,c)=>{const h=[];let d=(c-n)/80;d=0!==d?d:80;let l=i/(e-(1===a?1:0));l=isFinite(l)?l:i;let _=t.filter(Boolean)[0];a>1&&(_=_.filter(Boolean)[0]);let u=[o(_),r(_)];const p=t=>80+s.H/2-(t-n)/d,f=(t,e,i=0,s=1)=>{if(s>1&&t)return t.forEach((t,i)=>f(t,e,i,s-1));const a=l*(e+i/6);t&&(u=[o(t),r(t)]);const n=p(t?u[0]:u[1]);return h.push([a,n])};for(let e=0;e<t.length;e+=1)f(t[e],e,0,a);return h.push([i,p(u[1])]),h})(t,e,i,a,c,h)},n=(t,e,i,s,o)=>{if(!t)return;const r=t.map(t=>({state:Number(t.s),last_changed:1e3*t.lu}));return a(r,e,i,s,o)}},88809:function(t,e,i){var s=i(73742),o=i(59048),r=i(26292),a=i(9224);i(81738),i(94814);const n=(t,e,i,s)=>[(t-i)/2+i,(e-s)/2+s];class c extends o.oi{render(){return o.dy` ${this._path?o.YP`<svg width="100%" height="100%" viewBox="0 0 500 100"> <g> <mask id="fill"> <path class="fill" fill="white" d="${this._path} L 500, 100 L 0, 100 z"/> </mask> <rect height="100%" width="100%" id="fill-rect" fill="var(--accent-color)" mask="url(#fill)"></rect> <mask id="line"> <path fill="none" stroke="var(--accent-color)" stroke-width="${a.H}" stroke-linecap="round" stroke-linejoin="round" d="${this._path}"></path> </mask> <rect height="100%" width="100%" id="rect" fill="var(--accent-color)" mask="url(#line)"></rect> </g> </svg>`:o.YP`<svg width="100%" height="100%" viewBox="0 0 500 100"></svg>`} `}willUpdate(t){this.coordinates&&t.has("coordinates")&&(this._path=(t=>{if(!t.length)return"";let e,i,s="",o=t.filter(Boolean)[0];s+=`M ${o[0]},${o[1]}`;for(const r of t)e=r,i=n(o[0],o[1],e[0],e[1]),s+=` ${i[0]},${i[1]}`,s+=` Q${e[0]},${e[1]}`,o=e;return s+=` ${e[0]},${e[1]}`,s})(this.coordinates))}}c.styles=o.iv`:host{display:flex;width:100%}.fill{opacity:.1}`,(0,s.__decorate)([(0,r.Cb)()],c.prototype,"coordinates",void 0),(0,s.__decorate)([(0,r.SB)()],c.prototype,"_path",void 0),c=(0,s.__decorate)([(0,r.Mo)("hui-graph-base")],c)},8833:function(t,e,i){i.a(t,async function(t,s){try{i.r(e),i.d(e,{HuiGraphHeaderFooter:()=>g});var o=i(73742),r=i(59048),a=i(26292),n=i(37528),c=i(44272),h=i(6514),d=i(89166),l=i(45063),_=i(13814),u=(i(88809),t([h,d]));[h,d]=u.then?(await u)():u;const p=6e4,f=60*p,b=["counter","input_number","number","sensor"];class g extends r.oi{static async getConfigElement(){return await Promise.all([i.e("73614"),i.e("51679"),i.e("15634"),i.e("26452"),i.e("89112"),i.e("19596"),i.e("74272")]).then(i.bind(i,65697)),document.createElement("hui-graph-footer-editor")}static getStubConfig(t,e,i){return{type:"graph",entity:(0,l.j)(t,1,e,i,b,t=>!isNaN(Number(t.state))&&!!t.attributes.unit_of_measurement)[0]||""}}getCardSize(){return 3}setConfig(t){if(!t?.entity||!b.includes((0,c.M)(t.entity)))throw new Error("Specify an entity from within the sensor domain");const e={detail:1,hours_to_show:24,...t};e.hours_to_show=Number(e.hours_to_show),e.detail=1===e.detail||2===e.detail?e.detail:1,this._config=e}render(){return this._config&&this.hass?this._error?r.dy`<div class="errors">${this._error}</div>`:this._coordinates?this._coordinates.length?r.dy` <hui-graph-base .coordinates="${this._coordinates}"></hui-graph-base> `:r.dy` <div class="container"> <div class="info">No state history found.</div> </div> `:r.dy` <div class="container"> <ha-spinner size="small"></ha-spinner> </div> `:r.Ld}connectedCallback(){super.connectedCallback(),this.hasUpdated&&this._config&&this._subscribeHistory()}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeHistory()}_subscribeHistory(){(0,n.p)(this.hass,"history")&&!this._subscribed&&this._config&&(this._subscribed=(0,d.xS)(this.hass,t=>{this._subscribed&&this._config&&(this._coordinates=(0,_.g)(t[this._config.entity],this._config.hours_to_show,500,this._config.detail,this._config.limits)||[])},this._config.hours_to_show,[this._config.entity]).catch(t=>{this._subscribed=void 0,this._error=t}),this._setRedrawTimer())}_redrawGraph(){this._coordinates&&(this._coordinates=[...this._coordinates])}_setRedrawTimer(){clearInterval(this._interval),this._interval=window.setInterval(()=>this._redrawGraph(),this._config.hours_to_show>24?f:p)}_unsubscribeHistory(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then(t=>t?.()),this._subscribed=void 0)}updated(t){if(!this._config||!this.hass||!t.has("_config"))return;const e=t.get("_config");e&&this._subscribed&&e.entity===this._config.entity||(this._unsubscribeHistory(),this._subscribeHistory())}}g.styles=r.iv`ha-spinner{position:absolute;top:calc(50% - 14px)}.container{display:flex;justify-content:center;position:relative;padding-bottom:20%}.info{position:absolute;top:calc(50% - 16px);color:var(--secondary-text-color)}`,(0,o.__decorate)([(0,a.Cb)({attribute:!1})],g.prototype,"hass",void 0),(0,o.__decorate)([(0,a.Cb)()],g.prototype,"type",void 0),(0,o.__decorate)([(0,a.SB)()],g.prototype,"_config",void 0),(0,o.__decorate)([(0,a.SB)()],g.prototype,"_coordinates",void 0),g=(0,o.__decorate)([(0,a.Mo)("hui-graph-header-footer")],g),s()}catch(t){s(t)}})}};
//# sourceMappingURL=24729.9906b2ea8a6aca5d.js.map