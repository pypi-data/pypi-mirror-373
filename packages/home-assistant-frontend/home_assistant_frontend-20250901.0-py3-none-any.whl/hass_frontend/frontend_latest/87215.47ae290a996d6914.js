export const __webpack_ids__=["87215"];export const __webpack_modules__={56665:function(t,e,i){i.a(t,async function(t,a){try{i.d(e,{O:()=>f});i(2394),i(81738),i(94814),i(22960),i(6989),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761);var s=i(73742),o=i(59048),n=i(26292),r=i(36180),h=i(28105),c=i(55815),d=i(37528),l=i(74266),p=i(28598),_=i(27417),m=i(97050),u=i(7214),y=i(37008),g=t([y,l,p]);[y,l,p]=g.then?(await g)():g;const f={mean:"mean",min:"min",max:"max",sum:"sum",state:"sum",change:"sum"};class b extends o.oi{shouldUpdate(t){return t.size>1||!t.has("hass")}willUpdate(t){(t.has("statisticsData")||t.has("statTypes")||t.has("chartType")||t.has("hideLegend")||t.has("_hiddenStats"))&&this._generateData(),(!this.hasUpdated||t.has("unit")||t.has("period")||t.has("chartType")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("logarithmicScale")||t.has("hideLegend")||t.has("startTime")||t.has("endTime")||t.has("_legendData")||t.has("_chartData"))&&this._createOptions()}firstUpdated(){this._computedStyle=getComputedStyle(this)}render(){return(0,d.p)(this.hass,"history")?this.isLoadingData&&!this.statisticsData?o.dy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.loading_statistics")} </div>`:this.statisticsData&&Object.keys(this.statisticsData).length?o.dy` <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._chartOptions}" .height="${this.height}" style="${(0,r.V)({height:this.height})}" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}" .expandLegend="${this.expandLegend}"></ha-chart-base> `:o.dy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.no_statistics_found")} </div>`:o.dy`<div class="info"> ${this.hass.localize("ui.components.history_charts.history_disabled")} </div>`}_datasetHidden(t){this._legendData&&(this._hiddenStats.add(t.detail.id),this.requestUpdate("_hiddenStats"))}_datasetUnhidden(t){this._legendData&&(this._hiddenStats.delete(t.detail.id),this.requestUpdate("_hiddenStats"))}_createOptions(){const t=this.daysToShow??1;let e=this.minYAxis,i=this.maxYAxis;"number"==typeof e?this.fitYData&&(e=({min:t})=>Math.min(this._roundYAxis(t,Math.floor),this.minYAxis)):this.logarithmicScale&&(e=({min:t})=>{const e=t>0?.95*t:1.05*t;return this._roundYAxis(e,Math.floor)}),"number"==typeof i?this.fitYData&&(i=({max:t})=>Math.max(this._roundYAxis(t,Math.ceil),this.maxYAxis)):this.logarithmicScale&&(i=({max:t})=>{const e=t>0?1.05*t:.95*t;return this._roundYAxis(e,Math.ceil)});const a=this.endTime??new Date;let s=this.startTime;s||(this._chartData.forEach(t=>{if(!Array.isArray(t.data)||!t.data[0])return;const e=t.data[0],i=Array.isArray(e)?e[0]:e.value?.[0];i&&(!s||new Date(i)<s)&&(s=new Date(i))}),s||(s=new Date(a.getTime()-24*t*3600*1e3))),this._chartOptions={xAxis:[{id:"xAxis",type:"time",min:s,max:this.endTime},{id:"hiddenAxis",type:"time",show:!1}],yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,nameGap:2,nameTextStyle:{align:"left"},position:(0,m.HE)(this.hass)?"right":"left",scale:"bar"!==this.chartType||this.logarithmicScale||void 0!==e||void 0!==i,min:this._clampYAxis(e),max:this._clampYAxis(i),splitLine:{show:!0},axisLabel:{formatter:this._formatYAxisLabel}},legend:{type:"custom",show:!this.hideLegend,data:this._legendData},grid:{top:15,left:1,right:1,bottom:0,containLabel:!0},tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}async _generateData(){if(!this.statisticsData)return;const t=this.metadata||await this._getStatisticsMetaData(Object.keys(this.statisticsData));let e=0;const i=Object.entries(this.statisticsData),a=[],s=[],o=[];let n,r;if(0===i.length)return;n=this.endTime||new Date(Math.max(...i.map(([t,e])=>new Date(e[e.length-1].start).getTime()))),n>new Date&&(n=new Date);const h=this.names||{};i.forEach(([i,n])=>{const d=t?.[i];let l=h[i];void 0===l&&(l=(0,u.Kd)(this.hass,i,d)),this.unit||(void 0===r?r=(0,u.dO)(this.hass,i,d):null!==r&&r!==(0,u.dO)(this.hass,i,d)&&(r=null));let p,_=null;const m=[],y=[],g=(t,e,i)=>{i.length&&(t>e||(m.forEach((e,a)=>{"line"===this.chartType&&p&&_&&p.getTime()!==t.getTime()&&(e.data.push(this._transformDataValue([p,..._[a]])),e.data.push([p,null])),e.data.push(this._transformDataValue([t,...i[a]]))}),_=i,p=e))},f=(0,c.hZ)(e,this._computedStyle||getComputedStyle(this));e++;const b=[],v=this.statTypes.includes("mean")&&(0,u.Nw)(n,"mean"),x=this.statTypes.includes("max")&&(0,u.Nw)(n,"max"),D=this.statTypes.includes("min")&&(0,u.Nw)(n,"min"),S=[v,x,D].filter(Boolean).length>1,$=this.statTypes.includes("state"),T=x?"max":"mean",w=D?"min":"mean",C=S?[...this.statTypes].sort((t,e)=>"min"===t||"max"===e?-1:"max"===t||"min"===e?1:0):this.statTypes;let A=!1;C.forEach(t=>{if((0,u.Nw)(n,t)){const e=S&&(t===T||t===w);b.push(t);const a=e&&D&&x&&v||$&&["change","sum"].includes(t)?f+(this.hideLegend?"00":"7F"):f,s=e?f+"3F":f+"7F",n={id:`${i}-${t}`,type:this.chartType,smooth:"line"===this.chartType&&.4,smoothMonotone:"x",cursor:"default",data:[],name:l?`${l} (${this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`)})`:this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`),symbol:"none",sampling:"minmax",animationDurationUpdate:0,lineStyle:{width:1.5},itemStyle:"bar"===this.chartType?{borderRadius:[4,4,0,0],borderColor:a,borderWidth:1.5}:void 0,color:"bar"===this.chartType?s:a};if(e&&"line"===this.chartType&&(n.stack=`band-${i}`,n.stackStrategy="all",S&&t===T&&(n.areaStyle={color:f+"3F"})),!this.hideLegend){const e=v?"mean"===t:!1===A;e&&y.push({id:i,name:l,color:n.color,borderColor:n.itemStyle?.borderColor}),A=A||e}m.push(n),o.push(i)}});let Y=null,L=null;n.forEach(t=>{const e=new Date(t.start);if(Y===e)return;Y=e;const a=[];b.forEach(e=>{const i=[];if("sum"===e)null==L?(i.push(0),L=t.sum):i.push((t.sum||0)-L);else if(e===T&&"line"===this.chartType&&S){const e=t[T]||0;i.push(Math.abs(e-(t[w]||0))),i.push(e)}else i.push(t[e]??null);a.push(i)}),this._hiddenStats.has(i)||g(e,new Date(t.end),a)}),Array.prototype.push.apply(a,m),Array.prototype.push.apply(s,y)}),r&&(this.unit=r),s.forEach(({id:t,name:e,color:i,borderColor:s})=>{a.push({id:t,name:e,color:i,itemStyle:{borderColor:s},type:this.chartType,data:[],xAxisIndex:1})}),this._chartData=a,s.length!==this._legendData?.length&&(this._legendData=s.length>1?s.map(({id:t,name:e})=>({id:t,name:e})):void 0),this._statisticIds=o}_transformDataValue(t){return"bar"===this.chartType&&t[1]&&t[1]<0?{value:t,itemStyle:{borderRadius:[0,0,4,4]}}:t}_clampYAxis(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,Number.EPSILON);if("function"==typeof t)return e=>Math.max(t(e),Number.EPSILON)}return t}_roundYAxis(t,e){return Math.abs(t)<1?t:e(t)}constructor(...t){super(...t),this.statTypes=["sum","min","mean","max"],this.chartType="line",this.fitYData=!1,this.hideLegend=!1,this.logarithmicScale=!1,this.isLoadingData=!1,this.clickForMoreInfo=!0,this._chartData=[],this._statisticIds=[],this._hiddenStats=new Set,this._previousYAxisLabelValue=0,this._renderTooltip=t=>{const e={},i=this.unit?`${(0,_.L)(this.unit,this.hass.locale)}${this.unit}`:"";return t.map((t,a)=>{if(e[t.seriesIndex])return"";e[t.seriesIndex]=!0;const s=this._statisticIds[t.seriesIndex],o=this.hass.states[s],n=this.hass.entities[s],r=String(t.value[2]??t.value[1]),h=(0,p.l4)(o,n)??{maximumFractionDigits:2},c=`${(0,p.uf)(r,this.hass.locale,h)}${i}`;return`${0===a?(0,l.E8)(new Date(t.value[0]),this.hass.locale,this.hass.config)+"<br>":""}${t.marker} ${t.seriesName}: ${c}`}).filter(Boolean).join("<br>")},this._getStatisticsMetaData=(0,h.Z)(async t=>{const e=await(0,u.Py)(this.hass,t),i={};return e.forEach(t=>{i[t.statistic_id]=t}),i}),this._formatYAxisLabel=t=>{const e=Math.max(1,-Math.floor(Math.log10(Math.abs(t-this._previousYAxisLabelValue||1)))),i=(0,p.uf)(t,this.hass.locale,{maximumFractionDigits:e});return this._previousYAxisLabelValue=t,i}}}b.styles=o.iv`:host{display:block;min-height:60px}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}`,(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"hass",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"statisticsData",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"metadata",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"names",void 0),(0,s.__decorate)([(0,n.Cb)()],b.prototype,"unit",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"startTime",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"endTime",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1,type:Array})],b.prototype,"statTypes",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1})],b.prototype,"chartType",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1,type:Number})],b.prototype,"minYAxis",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:!1,type:Number})],b.prototype,"maxYAxis",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"fit-y-data",type:Boolean})],b.prototype,"fitYData",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"hide-legend",type:Boolean})],b.prototype,"hideLegend",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"logarithmic-scale",type:Boolean})],b.prototype,"logarithmicScale",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"is-loading-data",type:Boolean})],b.prototype,"isLoadingData",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"click-for-more-info",type:Boolean})],b.prototype,"clickForMoreInfo",void 0),(0,s.__decorate)([(0,n.Cb)()],b.prototype,"period",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"days-to-show",type:Number})],b.prototype,"daysToShow",void 0),(0,s.__decorate)([(0,n.Cb)({type:String})],b.prototype,"height",void 0),(0,s.__decorate)([(0,n.Cb)({attribute:"expand-legend",type:Boolean})],b.prototype,"expandLegend",void 0),(0,s.__decorate)([(0,n.SB)()],b.prototype,"_chartData",void 0),(0,s.__decorate)([(0,n.SB)()],b.prototype,"_legendData",void 0),(0,s.__decorate)([(0,n.SB)()],b.prototype,"_statisticIds",void 0),(0,s.__decorate)([(0,n.SB)()],b.prototype,"_chartOptions",void 0),(0,s.__decorate)([(0,n.SB)()],b.prototype,"_hiddenStats",void 0),b=(0,s.__decorate)([(0,n.Mo)("statistics-chart")],b),a()}catch(t){a(t)}})},84447:function(t,e,i){var a=i(73742),s=i(27885),o=i(67522),n=i(23533),r=i(7046),h=i(59048),c=i(26292);class d extends s.g{renderOutline(){return this.filled?h.dy`<span class="filled"></span>`:super.renderOutline()}getContainerClasses(){return{...super.getContainerClasses(),active:this.active}}renderPrimaryContent(){return h.dy` <span class="leading icon" aria-hidden="true"> ${this.renderLeadingIcon()} </span> <span class="label">${this.label}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${this.renderTrailingIcon()} </span> `}renderTrailingIcon(){return h.dy`<slot name="trailing-icon"></slot>`}constructor(...t){super(...t),this.filled=!1,this.active=!1}}d.styles=[n.W,r.W,o.W,h.iv`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`],(0,a.__decorate)([(0,c.Cb)({type:Boolean,reflect:!0})],d.prototype,"filled",void 0),(0,a.__decorate)([(0,c.Cb)({type:Boolean})],d.prototype,"active",void 0),d=(0,a.__decorate)([(0,c.Mo)("ha-assist-chip")],d)},26488:function(t,e,i){i.d(e,{Q:()=>a});const a=["relative","total","date","time","datetime"]},55367:function(t,e,i){i.a(t,async function(t,a){try{i.r(e),i.d(e,{HuiStatisticsGraphCardEditor:()=>$});i(2394),i(81738),i(94814),i(29981),i(22960),i(6989),i(72489),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761);var s=i(73742),o=i(59048),n=i(26292),r=i(28105),h=i(95632),c=i(45332),d=i(39884),l=i(65829),p=i(56665),_=i(23395),m=(i(87979),i(7214)),u=i(55577),y=i(90806),g=i(94177),f=i(75382),b=t([_,f,p]);[_,f,p]=b.then?(await b)():b;const v=(0,h.G0)([(0,h.i0)("state"),(0,h.i0)("sum"),(0,h.i0)("change"),(0,h.i0)("min"),(0,h.i0)("max"),(0,h.i0)("mean")]),x=(0,h.f0)(y.I,(0,h.Ry)({entities:(0,h.IX)(g.K),title:(0,h.jt)((0,h.Z_)()),days_to_show:(0,h.jt)((0,h.Rx)()),period:(0,h.jt)((0,h.G0)([(0,h.i0)("5minute"),(0,h.i0)("hour"),(0,h.i0)("day"),(0,h.i0)("week"),(0,h.i0)("month")])),chart_type:(0,h.jt)((0,h.G0)([(0,h.i0)("bar"),(0,h.i0)("line")])),stat_types:(0,h.jt)((0,h.G0)([(0,h.IX)(v),v])),unit:(0,h.jt)((0,h.Z_)()),hide_legend:(0,h.jt)((0,h.O7)()),logarithmic_scale:(0,h.jt)((0,h.O7)()),min_y_axis:(0,h.jt)((0,h.Rx)()),max_y_axis:(0,h.jt)((0,h.Rx)()),fit_y_data:(0,h.jt)((0,h.O7)())})),D=["5minute","hour","day","week","month"],S=["mean","min","max","sum","state","change"];class $ extends o.oi{setConfig(t){(0,h.hu)(t,x),this._config=t,this._configEntities=t.entities?(0,u.A)(t.entities,!1).map(t=>t.entity):[]}willUpdate(t){t.has("_configEntities")&&!(0,l.v)(this._configEntities,t.get("_configEntities"))&&(this._metaDatas=void 0,this._configEntities?.length&&this._getStatisticsMetaData(this._configEntities))}render(){if(!this.hass||!this._config)return o.Ld;const t=this._schema(this.hass.localize,this._configEntities,this._metaDatas,void 0!==this._config.min_y_axis||void 0!==this._config.max_y_axis),e=this._config.stat_types?(0,c.r)(this._config.stat_types):S.filter(t=>this._metaDatas?.some(e=>(0,m.Z0)(e,t))),i={chart_type:"line",period:"hour",...this._config,stat_types:e},a=this._metaDatas?.[0]?.unit_class,s=a?void 0:this._metaDatas?.[0]?.statistics_unit_of_measurement;return o.dy` <ha-form .hass="${this.hass}" .data="${i}" .schema="${t}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form> <ha-statistics-picker allow-custom-entity .hass="${this.hass}" .placeholder="${this.hass.localize("ui.panel.lovelace.editor.card.statistics-graph.pick_statistic")}" .label="${this.hass.localize("ui.panel.lovelace.editor.card.statistics-graph.picked_statistic")}" .includeStatisticsUnitOfMeasurement="${s}" .includeUnitClass="${a}" .ignoreRestrictionsOnFirstStatistic="${!0}" .value="${this._configEntities}" .configValue="${"entities"}" @value-changed="${this._entitiesChanged}"></ha-statistics-picker> `}_valueChanged(t){(0,d.B)(this,"config-changed",{config:t.detail.value})}async _entitiesChanged(t){const e=t.detail.value,i=e.map(t=>this._config.entities.find(e=>"string"!=typeof e&&e.entity===t)??t),a={...this._config,entities:i};e?.some(t=>(0,m.Hs)(t))&&"5minute"===a.period&&delete a.period;const s=a.stat_types||a.unit?await(0,m.Py)(this.hass,e):void 0;a.stat_types&&a.entities.length&&(a.stat_types=(0,c.r)(a.stat_types).filter(t=>s.some(e=>(0,m.Z0)(e,t))),a.stat_types.length||delete a.stat_types),a.unit&&!s.some(t=>(0,m.dO)(this.hass,t?.statistic_id,t)===a.unit)&&delete a.unit,(0,d.B)(this,"config-changed",{config:a})}constructor(...t){super(...t),this._getStatisticsMetaData=async t=>{this._metaDatas=await(0,m.Py)(this.hass,t||[])},this._schema=(0,r.Z)((t,e,i,a)=>{const s=new Set;i?.forEach(t=>{const e=(0,m.dO)(this.hass,t.statistic_id,t);e&&s.add(e)});const o=[{name:"title",selector:{text:{}}},{name:"",type:"grid",schema:[{name:"period",required:!0,selector:{select:{options:D.map(i=>({value:i,label:t(`ui.panel.lovelace.editor.card.statistics-graph.periods.${i}`),disabled:"5minute"===i&&e?.some(t=>(0,m.Hs)(t))}))}}},{name:"days_to_show",default:f.DEFAULT_DAYS_TO_SHOW,selector:{number:{min:1,mode:"box"}}},{name:"stat_types",required:!0,selector:{select:{multiple:!0,mode:"list",options:S.map(e=>({value:e,label:t(`ui.panel.lovelace.editor.card.statistics-graph.stat_type_labels.${e}`),disabled:!i||!i.some(t=>(0,m.Z0)(t,p.O[e]))}))}}},{name:"chart_type",required:!0,type:"select",options:[["line",t("ui.panel.lovelace.editor.card.statistics-graph.chart_type_labels.line")],["bar",t("ui.panel.lovelace.editor.card.statistics-graph.chart_type_labels.bar")]]},{name:"",type:"grid",schema:[{name:"min_y_axis",required:!1,selector:{number:{mode:"box",step:"any"}}},{name:"max_y_axis",required:!1,selector:{number:{mode:"box",step:"any"}}}]},...a?[{name:"fit_y_data",required:!1,selector:{boolean:{}}}]:[],{name:"hide_legend",required:!1,selector:{boolean:{}}},{name:"logarithmic_scale",required:!1,selector:{boolean:{}}}]}];return s.size>1&&o[1].schema.push({name:"unit",required:!1,selector:{select:{options:Array.from(s).map(t=>({value:t,label:t}))}}}),o}),this._computeLabelCallback=t=>{switch(t.name){case"chart_type":case"stat_types":case"period":case"unit":case"hide_legend":case"logarithmic_scale":case"min_y_axis":case"max_y_axis":case"fit_y_data":return this.hass.localize(`ui.panel.lovelace.editor.card.statistics-graph.${t.name}`);default:return this.hass.localize(`ui.panel.lovelace.editor.card.generic.${t.name}`)}}}}$.styles=o.iv`ha-statistics-picker{width:100%}`,(0,s.__decorate)([(0,n.Cb)({attribute:!1})],$.prototype,"hass",void 0),(0,s.__decorate)([(0,n.SB)()],$.prototype,"_config",void 0),(0,s.__decorate)([(0,n.SB)()],$.prototype,"_configEntities",void 0),(0,s.__decorate)([(0,n.SB)()],$.prototype,"_metaDatas",void 0),$=(0,s.__decorate)([(0,n.Mo)("hui-statistics-graph-card-editor")],$),a()}catch(t){a(t)}})},90806:function(t,e,i){i.d(e,{I:()=>s});var a=i(95632);const s=(0,a.Ry)({type:(0,a.Z_)(),view_layout:(0,a.Yj)(),layout_options:(0,a.Yj)(),grid_options:(0,a.Yj)(),visibility:(0,a.Yj)()})},94177:function(t,e,i){i.d(e,{K:()=>n});var a=i(95632),s=i(26488),o=i(20560);const n=(0,a.G0)([(0,a.Ry)({entity:(0,a.Z_)(),name:(0,a.jt)((0,a.Z_)()),icon:(0,a.jt)((0,a.Z_)()),image:(0,a.jt)((0,a.Z_)()),secondary_info:(0,a.jt)((0,a.Z_)()),format:(0,a.jt)((0,a.kE)(s.Q)),state_color:(0,a.jt)((0,a.O7)()),tap_action:(0,a.jt)(o.fJ),hold_action:(0,a.jt)(o.fJ),double_tap_action:(0,a.jt)(o.fJ),confirmation:(0,a.jt)(o.TX)}),(0,a.Z_)()])}};
//# sourceMappingURL=87215.47ae290a996d6914.js.map