
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/datasets_io/plot_custom_dataset_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_datasets_io_plot_custom_dataset_example.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_datasets_io_plot_custom_dataset_example.py:

.. _custom-dataset-example:

Custom Dataset Example
======================

This example shows how to convert data X and y as numpy arrays to a braindecode
compatible data format.

.. GENERATED FROM PYTHON SOURCE LINES 9-18

.. code-block:: Python


    # Authors: Lukas Gemein <l.gemein@gmail.com>
    #
    # License: BSD (3-clause)

    import mne

    from braindecode.datasets import create_from_X_y


.. GENERATED FROM PYTHON SOURCE LINES 19-20

To set up the example, we first fetch some data using `MNE <MNE-Python_>`_:

.. GENERATED FROM PYTHON SOURCE LINES 20-38

.. code-block:: Python


    # 5, 6, 7, 10, 13, 14 are codes for executed and imagined hands/feet
    subject_id = 22
    event_codes = [5, 6, 9, 10, 13, 14]
    # event_codes = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]

    # This will download the files if you don't have them yet,
    # and then return the paths to the files.
    physionet_paths = mne.datasets.eegbci.load_data(
        subject_id, event_codes, update_path=False
    )

    # Load each of the files
    parts = [
        mne.io.read_raw_edf(path, preload=True, stim_channel="auto")
        for path in physionet_paths
    ]


.. GENERATED FROM PYTHON SOURCE LINES 39-42

We take the required data, targets and additional information sampling
frequency and channel names from the loaded data. Note that this data and
information can originate from any source.

.. GENERATED FROM PYTHON SOURCE LINES 42-47

.. code-block:: Python

    X = [raw.get_data() for raw in parts]
    y = event_codes
    sfreq = parts[0].info["sfreq"]
    ch_names = parts[0].info["ch_names"]


.. GENERATED FROM PYTHON SOURCE LINES 48-49

Convert to data format compatible with skorch and braindecode:

.. GENERATED FROM PYTHON SOURCE LINES 49-61

.. code-block:: Python

    windows_dataset = create_from_X_y(
        X,
        y,
        drop_last_window=False,
        sfreq=sfreq,
        ch_names=ch_names,
        window_stride_samples=500,
        window_size_samples=500,
    )

    windows_dataset.description  # look as dataset description


.. GENERATED FROM PYTHON SOURCE LINES 62-63

You can manipulate the dataset

.. GENERATED FROM PYTHON SOURCE LINES 63-65

.. code-block:: Python

    print(len(windows_dataset))  # get the number of samples


.. GENERATED FROM PYTHON SOURCE LINES 66-67

You can now index the data

.. GENERATED FROM PYTHON SOURCE LINES 67-74

.. code-block:: Python

    i = 0
    x_i, y_i, window_ind = windows_dataset[0]
    n_channels, n_times = x_i.shape  # the EEG data
    _, start_ind, stop_ind = window_ind
    print(f"n_channels={n_channels}  -- n_times={n_times} -- y_i={y_i}")
    print(f"start_ind={start_ind} -- stop_ind={stop_ind}")


.. GENERATED FROM PYTHON SOURCE LINES 75-76

.. include:: /links.inc

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_datasets_io_plot_custom_dataset_example.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_custom_dataset_example.ipynb <plot_custom_dataset_example.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_custom_dataset_example.py <plot_custom_dataset_example.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_custom_dataset_example.zip <plot_custom_dataset_example.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
