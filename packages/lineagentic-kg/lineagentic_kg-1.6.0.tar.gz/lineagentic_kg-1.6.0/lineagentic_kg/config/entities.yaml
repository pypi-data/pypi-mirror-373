# Entity Definitions
# This file contains entity type definitions and their properties

# Entity Definitions
entities:
  Dataset:
    key: datasetKey
    urn_generator: dataset
    properties:
      - platform
      - name
      - env
      - versionId
    aspects:
      datasetProperties: versioned
      schemaMetadata: versioned
      ownership: versioned
      globalTags: versioned
      datasetProfile: timeseries
      datasetTransformation: versioned
      dataQuality: versioned
    property_extraction:
      urn_parsing:
        pattern: "urn:li:dataset:\\(urn:li:dataPlatform:([^,]+),([^,]+),([^)]+)\\)"
        mappings:
          - source_group: 1
            target_property: "platform"
          - source_group: 2
            target_property: "name"
          - source_group: 3
            target_property: "env"

  CorpUser:
    key: corpUserKey
    urn_generator: corpUser
    properties:
      - username
    aspects:
      corpUserInfo: versioned
      ownership: versioned
    property_extraction:
      urn_parsing:
        pattern: "urn:li:corpuser:([^,]+)"
        mappings:
          - source_group: 1
            target_property: "username"

  CorpGroup:
    key: corpGroupKey
    urn_generator: corpGroup
    properties:
      - name
    aspects:
      corpGroupInfo: versioned
      ownership: versioned
    property_extraction:
      urn_parsing:
        pattern: "urn:li:corpGroup:([^,]+)"
        mappings:
          - source_group: 1
            target_property: "name"

  Tag:
    key: tagKey
    urn_generator: tag
    properties:
      - key
      - value
    aspects: {}
    property_extraction:
      urn_parsing:
        pattern: "urn:li:tag:([^=]+)(?:=(.+))?"
        mappings:
          - source_group: 1
            target_property: "key"
          - source_group: 2
            target_property: "value"

  Column:
    key: columnKey
    urn_generator: column
    properties:
      - dataset_urn
      - field_path
    aspects:
      columnProperties: versioned
      columnTransformation: versioned
    property_extraction:
      urn_parsing:
        pattern: "urn:li:column:\\(([^,]+),([^)]+)\\)"
        mappings:
          - source_group: 1
            target_property: "dataset_urn"
          - source_group: 2
            target_property: "field_path"

  DataProduct:
    key: dataProductKey
    urn_generator: dataProduct
    properties:
      - name
      - domain
      - purpose
    aspects:
      dpOwnership: versioned
      dpContract: versioned
      dpObservability: versioned
      dpPolicy: versioned
      dpProvisioner: versioned
    property_extraction:
      urn_parsing:
        pattern: "urn:li:dataProduct:\\(([^,]+),([^,]+),([^)]+)\\)"
        mappings:
          - source_group: 1
            target_property: "domain"
          - source_group: 2
            target_property: "name"
          - source_group: 3
            target_property: "env"
