function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-BDMDATBU.js","./index-CqCRtC_k.css","./BuilderEmbeddedCodeEditor-nW2rYTXy.js","./BuilderEmbeddedCodeEditor-CXloIist.css","./BuilderSidebarToolkit-xr0LwYV9.js","./WdsCheckbox-1rateD_M.js","./WdsCheckbox-DKvpPA4D.css","./marked.esm-273vDTCT.js","./BuilderSidebarToolkit-Ipk1HoMm.css","./BuilderSidebarComponentTree-Bl8y1zpa.js","./useComponentDescription-_-KVKaN0.js","./BuilderSidebarComponentTree-C5AMKQcR.css","./BuilderSettings-BpHzmadU.js","./WdsDropdownMenu-4tPFLLRl.js","./WdsDropdownMenu-BT8vFJ33.css","./useKeyValueEditor-Ctp0-O8I.js","./useKeyValueEditor-CsemOh8D.css","./BuilderSettings-BfzcpNWD.css","./ComponentRenderer-CJHWkXjd.js","./ComponentRenderer-72hqvEvI.css","./BuilderInsertionOverlay-V7vzRb9q.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-CGPDezzi.js","./BuilderInsertionLabel-_YS5WPfq.css","./BuilderVault-YWCelaHF.js","./BuilderVault-Cx6oQSES.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as N,i as U,a as W,r as O,u as ve,c as k,o as t,f as u,g as d,x as S,y as q,A as G,G as H,R as f,S as C,_ as z,T as Ie,w as te,b as T,z as F,U as ke,V as Ke,X as Se,Y as Ct,Z as Le,q as ce,$ as It,a0 as tt,a1 as at,a2 as nt,D as K,s as me,v as Be,t as R,m as de,a3 as ot,a4 as rt,a5 as At,a6 as lt,W as J,a7 as $e,K as Ae,L as pe,a8 as Pt,a9 as qe,J as ee,aa as Tt,E as ae,ab as xt,ac as Dt,ad as ge,ae as Xe,af as re,ag as we,ah as Me,ai as Ue,aj as _e,ak as Et,al as Lt,am as Oe,an as ie,Q as se,ao as it,ap as st,aq as dt,ar as Mt,as as Fe,at as Ft,au as ut,av as Pe,aw as Nt,ax as Rt,ay as zt,az as Vt,aA as Wt,aB as Ut,aC as He,aD as qt,aE as Ot,aF as Ht,aG as jt,p as Kt,aH as Gt,H as Yt,aI as Zt,aJ as Je}from"./index-BDMDATBU.js";import{W as Xt}from"./WdsCheckbox-1rateD_M.js";import{marked as Jt}from"./marked.esm-273vDTCT.js";const Qt={class:"BuilderSwitcher"},ea=N({__name:"BuilderSwitcher",setup(e){const r=U(W.core),a=U(W.builderManager);let o=O(null);const l=ve(r),i={ui:void 0,blueprints:void 0};function v(w){return w==="blueprints"||w==="ui"}function s(w){const p=a.mode.value;if(p!=w){switch(v(p)&&r.activePageId.value&&(i[p]=r.activePageId.value),o.value=w,w){case"ui":l.track("nav_ui_opened");break;case"preview":l.track("nav_preview_opened");break;case"blueprints":l.track("nav_blueprints_opened");break;case"vault":l.track("nav_vault_opened");break}a.mode.value=w,v(w)&&i[w]&&r.getComponentById(i[w])&&r.setActivePageId(i[w]),(w=="preview"||p=="blueprints"||w=="blueprints")&&a.setSelection(null)}}const B=k(()=>a.getMode());return(w,p)=>(t(),u("div",Qt,[d("button",{"data-automation-action":"set-mode-ui",class:H({active:B.value=="ui"}),type:"button",onClick:p[0]||(p[0]=_=>s("ui"))},[S(q,{name:"frame"}),p[4]||(p[4]=G(" Interface "))],2),d("button",{"data-automation-action":"set-mode-blueprints",class:H({active:B.value=="blueprints"}),type:"button",onClick:p[1]||(p[1]=_=>s("blueprints"))},[S(q,{name:"wds-blueprints"}),p[5]||(p[5]=G(" Blueprints "))],2),f(r).isWriterCloudApp.value?(t(),u("button",{key:0,class:H({active:B.value=="vault"}),"data-automation-action":"set-mode-vault",type:"button",onClick:p[2]||(p[2]=_=>s("vault"))},[S(q,{name:"key-round"}),p[6]||(p[6]=G(" Vault "))],2)):C("",!0),d("button",{class:H({active:B.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:p[3]||(p[3]=_=>s("preview"))},[S(q,{name:"view"}),p[7]||(p[7]=G(" Preview "))],2)]))}}),ta=z(ea,[["__scopeId","data-v-b47b97e5"]]),aa={class:"BuilderStateExplorer"},na=N({__name:"BuilderStateExplorer",setup(e){const r=U(W.core);return(a,o)=>(t(),u("div",aa,[S(Ie,{data:f(r).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),oa=z(na,[["__scopeId","data-v-45c6b03e"]]),ra={key:0,class:"WdsStateDotState--cover"},la=N({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){const r=e;let a;const o=O(!1);return te(()=>r.state,l=>{if(l!=="error"){o.value=!1,clearTimeout(a);return}a=setTimeout(()=>{o.value=!0},1e3)}),(l,i)=>(t(),u("div",{class:H(["WdsStateDotState",`WdsStateDotState--${e.state}`])},[e.state=="error"?(t(),u("div",ra,[o.value?(t(),T(ke,{key:0,title:"We’re trying to reconnect...",size:"normal"},{default:F(()=>i[0]||(i[0]=[d("p",null," Connection was lost due to a network issue or an ongoing update. Please hang tight! ",-1)])),_:1})):C("",!0)])):C("",!0)],2))}}),ct=z(la,[["__scopeId","data-v-408a2071"]]);function ia(e,r){let a;return()=>{a&&clearTimeout(a),a=setTimeout(e,r)}}function sa(e){const r=Ke(),a=ve(e),o=tt(),{pushToast:l}=Se(),{writerApi:i,apiBaseUrl:v}=Ct({signal:r.signal}),s=k(()=>e.getComponentById("root")),B=O(!1),w=Le(),p=Le(),_=ia(async()=>{e.isWriterCloudApp.value&&e.mode.value==="edit"&&!$.value&&i.updateApplicationMetadata(e.writerOrgId.value,e.writerAppId.value,{name:h.value}),await e.sendComponentUpdate()},1e3),h=k({get:()=>s.value.content.appName,set:g=>{s.value.content.appName!==g&&(s.value.content.appName=g,_())}});te(()=>s.value.content.appName,_),te(p,()=>{var x;const g=(x=p.value)==null?void 0:x.name;g!==void 0&&(h.value=g)});const n=k(()=>{var D,E;const g=(E=(D=p.value.writer)==null?void 0:D.teamIds)==null?void 0:E[0];if(!g)return;const x=`/organization/${e.writerOrgId.value}/team/${g}/framework/${e.writerAppId.value}`;return new URL(x,v)}),c=k(()=>{if(!(!e.writerOrgId.value||!e.writerAppId.value))return new URL(`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,v)}),$=k(()=>{var g;return(g=p.value)!=null&&g.lastDeployedAt?new Date(p.value.lastDeployedAt):void 0}),y=k(()=>!!(e.isWriterCloudApp.value&&p.value)),b=k(()=>{var g;return((g=p.value)==null?void 0:g.status)==="deployed"});te(e.writerApplication,P,{immediate:!0}),ce(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await P()},{signal:r.signal})});async function P(){if(e.writerApplication.value)try{p.value=await i.fetchApplicationDeployment(e.writerOrgId.value,e.writerAppId.value)}catch(g){o.error("Failed to fetch deployment information",g),p.value=void 0}}async function m(){if(e.writerApplication.value){if(!b.value){const g=`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,x=new URL(g,v);window.open(x,"_blank");return}B.value=!0,w.value=void 0;try{await i.publishApplication(e.writerOrgId.value,e.writerAppId.value,{applicationVersionId:p.value.applicationVersion.id,applicationVersionDataId:p.value.applicationVersionData.id}),await P();const g=n.value?{label:"See it live",func:()=>window.open(n.value,"_blank"),icon:"open_in_new"}:void 0;l({type:"success",message:"agent deployed",action:g}),a.track("deployment_succeeded")}catch(g){a.track("deployment_failed",{error:String(g)}),w.value=g,o.error("Deploy failed",g),l({type:"error",message:"deploy failed"})}finally{B.value=!1}}}return{name:h,canDeploy:y,writerDeployUrl:c,hasBeenPublished:b,publishApplication:m,isDeploying:It(B),lastDeployedAt:$}}const da=["data-writer-tooltip"],ua=["src","alt"],ca={key:1,class:"SharedWriterAvatar__initials"},pa=N({__name:"SharedWriterAvatar",props:{userId:{type:Number,required:!0},showTooltip:{type:Boolean,required:!1}},setup(e){const r=e,a=k(()=>r.userId),o=O(!1),{user:l,isLoading:i}=at(a),v=k(()=>{var p;return((p=l.value)==null?void 0:p.avatar)??""}),s=k(()=>{var p;return(((p=l.value)==null?void 0:p.firstName)??"?").at(0)}),B=k(()=>{if(!(!r.showTooltip||!l.value))return`${l.value.firstName??""} ${l.value.lastName??""}`}),w=k(()=>l.value?`Avatar of ${l.value.firstName??""} ${l.value.lastName??""}`:`Avatar of the user ID ${a.value}`);return(p,_)=>(t(),u("div",{class:"SharedWriterAvatar","data-writer-tooltip":B.value},[f(i)||v.value&&!o.value?(t(),T(nt,{key:0,class:"SharedWriterAvatar__loader"})):C("",!0),f(i)?C("",!0):(t(),u(K,{key:1},[v.value?me((t(),u("img",{key:0,src:v.value,alt:w.value,class:"SharedWriterAvatar__img",onLoad:_[0]||(_[0]=h=>o.value=!0)},null,40,ua)),[[Be,o.value]]):(t(),u("div",ca,R(s.value),1))],64))],8,da))}}),Ge=z(pa,[["__scopeId","data-v-d974552d"]]),va=["data-writer-tooltip"],ma={key:0,class:"profile"},fa={key:1,class:"profile"},_a=N({__name:"BuilderHeaderConnected",setup(e){const r=U(W.collaborationManager),a=k(()=>r.connectedProfiles.value.length),o=k(()=>{var i;return(i=r.connectedProfiles.value)==null?void 0:i[0]}),l=k(()=>"Also editing: "+r.connectedProfiles.value.map(v=>v.displayName).join(", "));return(i,v)=>a.value>0?(t(),u("div",{key:0,class:"BuilderHeaderConnected","data-writer-tooltip":l.value,"data-writer-tooltip-placement":"bottom"},[a.value==1?(t(),u("div",ma,[S(Ge,{"user-id":o.value.userId},null,8,["user-id"])])):C("",!0),a.value>1?(t(),u("div",fa," +"+R(a.value),1)):C("",!0)],8,va)):C("",!0)}}),ya=z(_a,[["__scopeId","data-v-a13cab91"]]),ha=N({__name:"BuilderHeaderMoreDropdown",setup(e){const r=[{label:"Import agent .zip file",value:"import",icon:"upload"},{label:"Download agent .zip file",value:"export",icon:"download"}],a=U(W.core),o=de("exportInput"),l=ve(a),i=Se(),v=O(!1),s=O(!1),B=O(!1),w=k(()=>[{disabled:v.value,desc:"Cancel",fn:()=>{B.value=!1,s.value=!1}},{disabled:v.value||!B.value,loading:v.value,desc:"Import",fn:_}]);async function p(){if(l.track("nav_export_clicked"),!o.value)return;const n=await fetch("./api/export");if(!n.ok)throw new Error("Failed to connect to export API");const c=await n.blob(),$=window.URL.createObjectURL(c),y=document.createElement("a");y.href=$,y.download="export.zip",document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL($)}async function _(){if(l.track("nav_import_clicked"),!o.value)return;const n=o.value.files[0];if(n){v.value=!0;try{const c=new FormData;if(c.append("file",n),!(await fetch("./api/import",{method:"POST",body:c})).ok)throw new Error("Failed to connect to import API");s.value=!1,i.pushToast({type:"success",message:"Project imported successfully."})}catch(c){i.pushToast({type:"error",message:"Failed to import the project: "+(c instanceof Error?c.message:String(c))})}finally{v.value=!1}}}async function h(n){if(n==="export")try{await p()}catch(c){i.pushToast({message:`Failed to export the project: ${c}`,type:"error"})}else n==="import"&&(o.value.value="",o.value.click())}return(n,c)=>(t(),u(K,null,[S(ot,{class:"BuilderHeaderMoreDropdown","trigger-variant":"secondary",options:r,onSelect:h}),me(d("input",{ref_key:"exportInput",ref:o,type:"file",accept:".zip,application/zip",onChange:c[0]||(c[0]=$=>s.value=!0)},null,544),[[Be,!1]]),s.value?(t(),T(ke,{key:0,actions:w.value,title:"Are you sure you want to continue?",description:"Your current work will be replaced with the agent in the zip file. This includes replacement of current pages, blueprints, local scripts, and custom assets.",size:"normal"},{default:F(()=>[S(Xt,{modelValue:B.value,"onUpdate:modelValue":c[1]||(c[1]=$=>B.value=$),label:"Yes, I want to replace the current agent with the imported file"},null,8,["modelValue"])]),_:1},8,["actions"])):C("",!0)],64))}}),ga=z(ha,[["__scopeId","data-v-ed946ab4"]]),ba={class:"BuilderHeader"},wa={class:"BuilderHeader__logo"},ka=["href"],Sa={key:1,src:rt,alt:"Writer Framework logo"},Ba=["disabled"],$a={class:"BuilderHeader__toolbar"},Ca=N({__name:"BuilderHeader",setup(e){const r=U(W.core),a=O(!1),o=O(!1),l=ve(r),i=Se(),{canDeploy:v,isDeploying:s,publishApplication:B,hasBeenPublished:w,lastDeployedAt:p,writerDeployUrl:_,name:h}=sa(r),n=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function c(){l.track("nav_deploy_clicked"),w.value?$.value=!0:await B()}const $=O(!1),y=[{desc:"Cancel",fn:()=>$.value=!1},{desc:"Yes, deploy changes",fn:async()=>{$.value=!1,await B()}}],b=k(()=>p.value?`Editor Last saved ${n.format(p.value)}`:void 0),P=k(()=>w.value===!0?"Deploy changes":(w.value===!1,"Configure deployment")),m=k(()=>{let A="";switch(r.syncHealth.value){case"offline":A+="Offline. Not syncing.";break;case"connected":A+="Online. Syncing...";break;case"idle":A+="Sync not initialised.";break;case"suspended":A+="Sync suspended.";break}return r.featureFlags.value.length>0&&(A+=` Feature flags: ${r.featureFlags.value.join(", ")}`),A}),g=k(()=>{switch(r.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function x(){l.track("nav_state_explorer_opened"),a.value=!0}function D(){o.value=!0}async function E(){var I;const A=location.href;try{if((I=navigator.clipboard)!=null&&I.writeText)await navigator.clipboard.writeText(A);else{const V=document.createElement("textarea");V.value=A,V.style.position="fixed",V.style.opacity="0",document.body.appendChild(V),V.select(),document.execCommand("copy"),document.body.removeChild(V)}i.pushToast({type:"success",message:"Edit link copied to clipboard."})}catch{i.pushToast({type:"error",message:"Could not copy link."})}}return(A,I)=>(t(),u("div",ba,[d("div",wa,[f(_)?(t(),u("a",{key:0,href:f(_).toString(),target:"_blank",class:"BuilderHeader__goBack"},I[3]||(I[3]=[d("img",{src:rt,alt:"Writer Framework logo"},null,-1)]),8,ka)):(t(),u("img",Sa)),I[4]||(I[4]=d("hr",null,null,-1)),f(r).isWriterCloudApp.value?me((t(),u("input",{key:2,"onUpdate:modelValue":I[0]||(I[0]=V=>lt(h)?h.value=V:null),type:"text",disabled:!!f(p),class:"BuilderHeader__logo__appTitle"},null,8,Ba)),[[At,f(h)]]):C("",!0)]),S(ta,{class:"BuilderHeader__switcher"}),d("div",$a,[I[6]||(I[6]=d("hr",null,null,-1)),S(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:x},{default:F(()=>[S(q,{name:"compass"})]),_:1}),S(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"Invite collaborators","data-writer-tooltip-placement":"bottom",onClick:D},{default:F(()=>[S(q,{name:"share-2"})]),_:1}),S(ga),f(v)?(t(),T(J,{key:0,size:"small",class:"BuilderHeader__toolbar__deployBtn",loading:f(s),"data-writer-tooltip":b.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:c},{default:F(()=>[G(R(P.value)+" ",1),$.value?(t(),T(ke,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:y},{default:F(()=>I[5]||(I[5]=[d("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):C("",!0)]),_:1},8,["loading","data-writer-tooltip"])):C("",!0),S(ya),S(ct,{state:g.value,"data-writer-tooltip":m.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),a.value?(t(),T(ke,{key:1,title:"State Explorer","display-close-button":"",onClose:I[1]||(I[1]=V=>a.value=!1)},{default:F(()=>[S(oa)]),_:1})):C("",!0),o.value?(t(),T(ke,{key:2,title:"Share edit link with collaborators",description:"All AI Studio builders in your org can edit this agent with you in real time. Copy the link below to point them directly to editing this agent.","display-close-button":"",actions:[{desc:"Close",fn:()=>o.value=!1},{desc:"Copy edit link",fn:()=>E(),icon:"clipboard"}],onClose:I[2]||(I[2]=V=>o.value=!1)},null,8,["actions"])):C("",!0)])]))}}),Ia=z(Ca,[["__scopeId","data-v-167c3d18"]]),Aa={class:"text"},Pa=200,Ta=4,xa=N({__name:"BuilderTooltip",setup(e){const r=de("rootEl"),a=O(!1),o=O(null);let l=null,i=null;const v=O("top"),s=O({top:0,left:0});async function B(){if(!l||(o.value=l.dataset.writerTooltip,!o.value))return;const n=l.dataset.writerTooltipGap?parseInt(l.dataset.writerTooltipGap):Ta;if(a.value=w(l),!a.value)return;await pe();const{x:c,y:$,width:y,height:b}=l.getBoundingClientRect(),{width:P,height:m}=r.value.getBoundingClientRect();switch(v.value){case"top":s.value.top=$-m-n,s.value.left=c+y/2-P/2;break;case"right":s.value.top=$+b/2-m/2,s.value.left=c+y+n;break;case"left":s.value.left=c-P-n,s.value.top=$+b/2-m/2;break;case"bottom":s.value.top=$+b+n,s.value.left=c+y/2-P/2;break}}function w(n){return n.getAttribute("data-writer-tooltip-strategy")==="overflow"?n.scrollWidth>n.clientWidth:!0}function p(n){const $=n.target.closest("[data-writer-tooltip]");if($)l!==$&&(a.value=!1);else{a.value=!1,l=null;return}l=$,v.value=l.dataset.writerTooltipPlacement??"top",setTimeout(()=>_($),Pa)}async function _(n){n===l&&(i==null||i.disconnect(),i=new MutationObserver(B),i.observe(l,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),B())}const h=k(()=>{const{top:n,left:c}=s.value;return{top:`${n}px`,left:`${c}px`}});return ce(()=>{document.documentElement.addEventListener("mouseover",p)}),$e(()=>{document.documentElement.removeEventListener("mouseover",p),i==null||i.disconnect()}),(n,c)=>me((t(),u("div",{ref_key:"rootEl",ref:r,class:"BuilderTooltip",style:Ae(h.value)},[d("div",{class:H(["arrow",v.value])},null,2),d("div",Aa,R(o.value),1)],4)),[[Be,a.value]])}}),Da=z(xa,[["__scopeId","data-v-7ba01c7c"]]),Ea=""+new URL("art-paper-D70v1WMA.svg",import.meta.url).href,La={class:"BuilderPanel__collapser"},Ma={class:"BuilderPanel__title"},Fa={class:"BuilderPanel__titleCompanion"},Na=["data-order"],Ra={key:0,class:"BuilderPanel__contents__leftPanel"},za={class:"BuilderPanel__actions"},Va={class:"BuilderPanel__actionsCompanion"},Wa=N({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean},maxFileSizeLimit:{}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{expose:r,emit:a}){const o=U(W.builderManager),l=["code","log"],i=e,v=k(()=>{if(typeof i.maxFileSizeLimit=="number")return`Files can be up to ${Pt(i.maxFileSizeLimit)}`}),s=a,B=de("mainContents");r({mainContents:B});const w=k(()=>i.enableDropFile&&p.value),p=O(!1);function _(m,g){i.enableDropFile&&(m.preventDefault(),p.value=g)}function h(m){m.preventDefault(),p.value=!1}function n(m){i.enableDropFile&&m.length>0&&s("filesDrop",m)}const c=k(()=>!o.openPanels.value.has(i.panelId)),$=k(()=>l.indexOf(i.panelId));function y(m){if(o.openPanels.value.has(m)){o.openPanels.value.delete(m),s("openned",!1);return}o.openPanels.value.add(m),s("openned",!0)}function b(m){const g=Dt(m);if(g&&m.key==i.keyboardShortcutKey.toLowerCase()){m.preventDefault(),y(i.panelId);return}i.actions.forEach(x=>{if(!x.keyboardShortcut)return;const{key:D,modifierKey:E}=x.keyboardShortcut;D.toLowerCase()==m.key&&(!g&&E||(m.preventDefault(),x.callback()))})}function P(m){if(!m)return"";let g=" (";return m.modifierKey&&(g+=qe()),g+=m.key,g+=")",g}return ce(async()=>{document.addEventListener("keydown",b)}),$e(()=>{document.removeEventListener("keydown",b)}),(m,g)=>(t(),u("div",{class:H(["BuilderPanel",{collapsed:c.value}])},[d("div",La,[S(J,{variant:"neutral",size:"small","data-automation-action":"toggle-panel","data-automation-key":m.panelId,"data-writer-tooltip":`Toggle ${m.name} (${f(qe)()}${m.keyboardShortcutKey})`,onClick:g[0]||(g[0]=x=>y(m.panelId))},{default:F(()=>[S(q,{name:c.value?"chevron-right":"chevron-up"},null,8,["name"]),d("span",Ma,R(m.name),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),d("div",Fa,[ee(m.$slots,"titleCompanion",{},void 0,!0)]),c.value?C("",!0):(t(),T(xt,{key:0,to:m.contentsTeleportEl},[d("div",{style:Ae({order:$.value}),"data-order":$.value,class:H(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":m.enableLeftPanel,"BuilderPanel__contents--dropingFile":w.value}]),onDrop:h,onDragover:g[1]||(g[1]=x=>_(x,!0)),onDragleave:g[2]||(g[2]=x=>_(x,!1))},[w.value?(t(),T(Tt,{key:0,multiple:"",label:"Drop files here",restrictions:v.value,onDrop:n},null,8,["restrictions"])):(t(),u(K,{key:1},[m.enableLeftPanel?(t(),u("div",Ra,[ee(m.$slots,"leftPanel",{},void 0,!0)])):C("",!0),d("div",za,[d("div",Va,[ee(m.$slots,"actionsCompanion",{},void 0,!0)]),(t(!0),u(K,null,ae(m.actions,(x,D)=>(t(),T(J,{key:D,"data-writer-tooltip":x.name+P(x.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:x.isDisabled,onClick:x.callback},{default:F(()=>[S(q,{name:x.icon},null,8,["name"])]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),d("div",{ref_key:"mainContents",ref:B,class:"BuilderPanel__mainContents"},[ee(m.$slots,"default",{},void 0,!0)],512)],64))],46,Na)],8,["to"]))],2))}}),pt=z(Wa,[["__scopeId","data-v-5ccf1c14"]]),je=150;function Ua(e){const r=O(structuredClone(ge(e.sourceFiles.value)));te(e.sourceFiles,(b,P)=>{let m=!1,g=structuredClone(ge(r.value));const x=v(P).map(a);for(const D of Xe(b)){const E=re(D,P),A=re(D,b);if(we(A))continue;if(E===void 0||Me(A)){g=Ue(D,g,structuredClone(ge(A))),m=!0;continue}if(!_e(E))continue;const I=!E.complete&&A.complete,V=E.complete&&A.complete;if(!I&&!V)continue;const ue=a(D);if(x.includes(ue))continue;const Z=re(D,g);_e(Z)&&(m=!0,Z.complete=!0,Z.content=A.content)}for(const D of Et(g))re(D,b)===void 0&&(g=Lt(D,g),m=!0);m&&(r.value=g)});function a(b){return b.join("/")}const o=Le(),l=k(()=>Array.from(Xe(r.value))),i=k(()=>v(e.sourceFiles.value));function v(b){return l.value.filter(P=>{const m=re(P,r.value);if(Me(m))return!1;if(!_e(m))return!0;const g=re(P,b);return _e(g)?!m.complete||!g.complete?!1:m.content!==g.content:!0})}const s=k(()=>{if(o.value!==void 0)return re(o.value,r.value)}),B=k({get(){return _e(s.value)?s.value.content:""},set(b){if(o.value===void 0)return;const P=re(o.value,r.value);_e(P)&&(P.content=b)}});function w(b=1){const P=`new-file-${b}.txt`;return re([P],r.value)?w(b+1):P}async function p(){const b=w();r.value=Ue([b],ge(r.value)),n([b]),await e.sendCreateSourceFileRequest([b])}const _=k(()=>{var P;return(P=o.value)!=null&&P.length?o.value.at(-1).split(".").at(-1):""}),h=k(()=>{switch(_.value){case"py":return"python";case"js":case"mjs":return"javascript";case"ts":return"typescript";case"md":case"markdown":return"markdown";default:return _.value}});function n(b){o.value=b,_e(s.value)&&!s.value.complete&&e.requestSourceFileLoading(b)}async function c(b){if(!(!o.value||!s.value)&&(s.value.type==="file"&&await e.sendCodeSaveRequest(B.value,o.value),b)){const P=[...ge(o.value)];o.value=void 0;try{await e.sendRenameSourceFileRequest(P,b)}catch(m){throw o.value=P,m}n(b)}}function $(b){return new Promise((P,m)=>{const g=new FileReader;g.addEventListener("loadend",x=>{const D=x.target.result;if(D instanceof ArrayBuffer){const E=String.fromCharCode.apply(null,new Uint8Array(D));return P(E)}P(D.split(",")[1])}),g.addEventListener("error",()=>{m()}),g.readAsDataURL(b)})}async function y(b){const P=je*1024*1024;if(b.size>P)throw Error(`Cannot upload file bigger than ${je}mb`);const m=[b.name];if(re(m,e.sourceFiles.value))throw Error(`The file ${b.name} already exists`);r.value=Ue(m,ge(r.value),{type:"binary",uploading:!0});const g=await $(b);await e.sendFileUploadRequest(m,g)}return{code:B,sourceFileDraft:r,fileOpen:s,filepathOpen:o,pathsUnsaved:i,openedFileLanguage:h,save:c,upload:y,openFile:n,openNewFile:p,getNewFilename:w}}const qa={class:"BuilderTree"},Oa=["draggable","data-automation-key","aria-expanded"],Ha=["data-writer-tooltip"],ja={key:1,class:"BuilderTree__main__dropdown"},Ka=N({__name:"BuilderTree",props:Oe({name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0},disableCollapse:{type:Boolean,required:!1}},{collapsed:{type:Boolean,required:!1,default:!1},collapsedModifiers:{}}),emits:Oe({expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},["update:collapsed"]),setup(e,{expose:r,emit:a}){const o=ie({loader:()=>se(()=>import("./index-BDMDATBU.js").then(h=>h.bo),__vite__mapDeps([0,1]),import.meta.url)}),l=e,i=a;r({expand:p,toggleCollapse:_});const v=it(e,"collapsed"),s=O(!1),B=k(()=>!l.matched),w=k(()=>!l.hasChildren);function p(){v.value=!1,i("expandBranch")}function _(h){h??(h=!v.value),h!==v.value&&(v.value=h)}return(h,n)=>(t(),u("div",qa,[d("div",{class:H(["BuilderTree__main",{selected:e.selected,notMatched:B.value,childless:w.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!v.value,onMouseenter:n[2]||(n[2]=c=>s.value=!0),onMouseleave:n[3]||(n[3]=c=>s.value=!1),onClick:n[4]||(n[4]=c=>h.$emit("select",c)),onKeydown:n[5]||(n[5]=dt(c=>h.$emit("select",c),["enter"])),onDragover:n[6]||(n[6]=c=>h.$emit("dragover",c)),onDragstart:n[7]||(n[7]=c=>h.$emit("dragstart",c)),onDragend:n[8]||(n[8]=c=>h.$emit("dragend",c)),onDrop:n[9]||(n[9]=c=>h.$emit("drop",c))},[e.hasChildren&&!e.disableCollapse?(t(),T(J,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:n[0]||(n[0]=st(c=>_(void 0),["stop"]))},{default:F(()=>[S(q,{name:v.value?"chevron-down":"chevron-up"},null,8,["name"])]),_:1},8,["disabled"])):C("",!0),ee(h.$slots,"nameLeft",{},void 0,!0),d("span",{class:H(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},R(e.name),11,Ha),ee(h.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&s.value?(t(),u("div",ja,[S(f(o),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:n[1]||(n[1]=c=>h.$emit("dropdownSelect",c))},null,8,["options"])])):C("",!0)],42,Oa),S(Mt,null,{default:F(()=>[me(d("div",{class:H(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[ee(h.$slots,"children",{},void 0,!0)],2),[[Be,!v.value&&e.hasChildren]])]),_:3})]))}}),Ga=z(Ka,[["__scopeId","data-v-8c085d0a"]]),Ya=["width","height","viewBox","aria-valuenow"],Za=["r","cx","cy","stroke","stroke-width"],Xa=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],Ja=N({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const r=e,a=k(()=>r.sizePx/2),o=k(()=>r.sizePx/2-r.strokeWidth/2),l=k(()=>2*Math.PI*o.value),i=k(()=>l.value*((100-r.progress)/100)),v=k(()=>`0 0 ${r.sizePx} ${r.sizePx}`);return(s,B)=>(t(),u("svg",{width:e.sizePx,height:e.sizePx,viewBox:v.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[d("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:f(Fe).Blue1,"stroke-width":e.strokeWidth},null,8,Za),d("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:f(Fe).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":l.value,"stroke-dashoffset":i.value},null,8,Xa)],8,Ya))}}),Qa=N({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const r=e,a=O(0);return ce(()=>{let o;const l=i=>{o||(o=i);const v=i-o;a.value=Math.min(v/r.timeMs*100,100),a.value<100&&requestAnimationFrame(l)};requestAnimationFrame(l)}),(o,l)=>(t(),T(Ja,{class:"BuilderCodePanelFileUploading",progress:a.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),en=z(Qa,[["__scopeId","data-v-449f2dac"]]),Qe=[{label:"Delete",value:"delete",icon:"trash-2"}],tn=N({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:r}){const a=e,o=r;function l(n){return n.join("/")}const i=k(()=>l(a.pathActive)),v=k(()=>a.pathsUnsaved.map(l)),s=k(()=>we(a.sourceFiles)?Object.entries(a.sourceFiles.children).sort((n,c)=>n[0].localeCompare(c[0])):[]);function B(n){const c=re([...a.path,n],a.sourceFiles);return Me(c)&&c.uploading}function w(n){const c=l([...a.path,n]);return v.value.includes(c)}function p(n){return l([...a.path,n])===i.value}function _(n){if(!we(a.sourceFiles)||B(n))return;const c=a.sourceFiles.children[n];we(c)||o("select",[...a.path,n])}function h(n,c){n==="delete"&&o("delete",[...a.path,c])}return(n,c)=>(t(),u("div",null,[(t(!0),u(K,null,ae(s.value,([$,y])=>(t(),T(Ga,{key:$,name:$,matched:"","has-children":f(we)(y),selected:p($),disabled:B($),"right-click-options":Qe,"dropdown-options":f(we)(y)||f(Me)(y)?Qe:void 0,onSelect:b=>_($),onDropdownSelect:b=>h(b,$)},Ft({children:F(()=>[S(vt,{"source-files":y,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,$],onSelect:c[0]||(c[0]=b=>n.$emit("select",b)),onDelete:c[1]||(c[1]=b=>n.$emit("delete",b))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[B($)||w($)?{name:"nameLeft",fn:F(()=>[B($)?(t(),T(en,{key:0,"time-ms":2e3})):w($)?(t(),T(ct,{key:1,state:"newDraft"})):C("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),vt=z(tn,[["__scopeId","data-v-13c86c55"]]),an=["disabled"],nn={class:"WdsButtonLink__text"},on=N({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disabled:{type:Boolean}},setup(e){const r=e,a=k(()=>[`WdsButtonLink--variant-${r.variant}`,`WdsButtonLink--weight-${r.weight}`]);return(o,l)=>(t(),u("button",{class:H(["WdsButtonLink",a.value]),disabled:e.disabled,type:"button"},[e.leftIcon?(t(),T(q,{key:0,name:e.leftIcon},null,8,["name"])):C("",!0),d("span",nn,R(e.text),1),e.rightIcon?(t(),T(q,{key:1,name:e.rightIcon},null,8,["name"])):C("",!0)],10,an))}}),mt=z(on,[["__scopeId","data-v-f2cbc67f"]]),rn={class:"BuilderCodePanelFileUploadBtn"},ln=N({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:r}){const a=de("input"),o=r;function l(){const{files:i}=a.value;i instanceof FileList&&i.length>0&&(o("selected",Array.from(i)),a.value.value="")}return(i,v)=>(t(),u("form",rn,[me(d("input",{ref_key:"input",ref:a,type:"file",multiple:"",onChange:l},null,544),[[Be,!1]]),S(mt,{"left-icon":"upload",text:"Upload",onClick:v[0]||(v[0]=s=>f(a).click())})]))}}),sn={class:"BuilderCodePanel__tree"},dn={class:"BuilderCodePanel__tree__actions"},un={key:1,class:"BuilderCodePanel__noPreview"},cn={class:"BuilderCodePanel__actionsCompanion"},pn=N({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const r=ie({loader:()=>se(()=>import("./index-BDMDATBU.js").then(M=>M.bo),__vite__mapDeps([0,1]),import.meta.url)}),a=ie({loader:()=>se(()=>import("./BuilderEmbeddedCodeEditor-nW2rYTXy.js").then(M=>M.B),__vite__mapDeps([2,0,1,3]),import.meta.url)}),o=U(W.core),l=[{label:"Rename file",value:"rename",icon:"pencil"},{label:"Delete file",value:"delete",icon:"trash-2",variant:"danger"}],i=ve(o),{sourceFileDraft:v,openFile:s,upload:B,openNewFile:w,code:p,openedFileLanguage:_,filepathOpen:h,fileOpen:n,pathsUnsaved:c,save:$}=Ua(o);async function y(M){await Promise.all(M.map(b))}async function b(M){try{await B(M),m({type:"success",message:`File ${M.name} uploaded`})}catch(Y){m({type:"error",message:Y.message})}}const P=k(()=>{var M;return(M=n.value)==null?void 0:M.type}),{pushToast:m}=Se(),g=tt();function x(M){const Y=new AbortController;ce(()=>{document.addEventListener("keydown",async ne=>{const ze=ne.metaKey||ne.ctrlKey,Ve=ne.key==="s"||ne.key==="S";!ze||!Ve||(ne.preventDefault(),await M())},{signal:Y.signal})}),$e(()=>Y.abort())}x(Ce);const D=de("filenameEl"),E=O(""),A=O(!1),I=k(()=>{var M;return((M=h.value)==null?void 0:M.join("/"))??""}),V=k(()=>I.value!=="main.py"),ue=k(()=>I.value!==E.value),Z=k(()=>A.value||I.value==="main.py"),le=k(()=>ue.value?!1:h.value===void 0?!0:!c.value.map(M=>M.join("/")).includes(I.value));te(h,()=>{var M;E.value=((M=h.value)==null?void 0:M.join("/"))??""}),te(o.sessionTimestamp,()=>{A.value=!1});function ye(M){M&&(i.track("nav_code_opened"),h.value===void 0&&s(["main.py"]))}async function Te(){var M;I.value!=="main.py"&&(await pe(),(M=D.value)==null||M.focus())}async function Ne(M){switch(M){case"rename":return Te();case"delete":await De(h.value)}}async function xe(){await w(),Te()}async function De(M){await o.sendDeleteSourceFileRequest(M),m({type:"success",message:"The file was deleted"}),h.value.join("/").startsWith(M.join("/"))&&s(["main.py"])}async function Ce(){if(h.value===void 0)return m({type:"error",message:"There is no file open"});if(le.value)return m({type:"info",message:"There are not file changes to save"});A.value=!0;const M=ue.value?E.value.split("/"):void 0;if(M){const Y=Re(M);if(Y)return m({type:"error",message:Y})}try{await $(M),m({type:"success",message:"The file was saved"}),i.track("nav_code_file_updated",{path:h.value})}catch(Y){g.error("The file hasn't been saved.",Y),m({type:"error",message:"The file hasn't been saved"});return}finally{A.value=!1}}function Re(M){return M[0]===""?"Path should not have a leading slash":M[0]===".wf"?".wf is reserved for Writer Framework":M.some(Y=>Y==="")?"Invalid path":null}return(M,Y)=>(t(),T(pt,{"panel-id":"code",name:"Code","contents-teleport-el":M.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"","max-file-size-limit":f(je)*1e3*1e3,onFilesDrop:y,onOpenned:ye},{leftPanel:F(()=>[d("div",sn,[S(vt,{"path-active":f(h),"paths-unsaved":f(c),"source-files":f(v),onAddFile:xe,onSelect:f(s),onDelete:De},null,8,["path-active","paths-unsaved","source-files","onSelect"]),d("div",dn,[S(mt,{"left-icon":"plus",text:"Add file",onClick:xe}),S(ln,{onSelected:y})])])]),actionsCompanion:F(()=>[d("div",cn,[S(ut,{ref_key:"filenameEl",ref:D,modelValue:E.value,"onUpdate:modelValue":Y[1]||(Y[1]=ne=>E.value=ne),disabled:!V.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:dt(Ce,["enter"])},null,8,["modelValue","disabled"]),S(J,{variant:"primary",size:"small",disabled:A.value||le.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:Ce},{default:F(()=>[S(q,{name:"save"}),Y[3]||(Y[3]=G(" Save file "))]),_:1},8,["disabled"]),S(f(r),{disabled:Z.value,options:l,onSelect:Ne},null,8,["disabled"])])]),default:F(()=>[P.value==="file"?(t(),T(f(a),{key:0,modelValue:f(p),"onUpdate:modelValue":Y[0]||(Y[0]=ne=>lt(p)?p.value=ne:null),variant:"full",language:f(_),disabled:A.value},null,8,["modelValue","language","disabled"])):C("",!0),P.value==="binary"?(t(),u("div",un,Y[2]||(Y[2]=[d("img",{class:"BuilderCodePanel__noPreview__img",src:Ea},null,-1),d("p",{class:"BuilderCodePanel__noPreview__title"},"Can’t Preview File",-1),d("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):C("",!0)]),_:1},8,["contents-teleport-el","max-file-size-limit"]))}}),vn=z(pn,[["__scopeId","data-v-c9f7bb95"]]),mn={class:"BuiderLogBlueprintExecutionTrace"},fn={key:0,class:"trace"},_n={class:"type"},yn={key:0},hn={key:1},gn={class:"main"},bn={key:0},wn={key:1},kn={key:2},Sn={key:3},Bn={class:"details"},$n={class:"data","data-automation-key":"result"},Cn={key:1,class:"nothing"},In={class:"data","data-automation-key":"return-value"},An={class:"environment"},Pn={class:"data"},Tn={key:1,class:"nothing"},xn={class:"callStack"},Dn={class:"eyebrow"},En=N({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:r}){const a=U(W.core),o=U(W.builderManager),l=ve(a),i=r,{goToComponentParentPage:v}=Pe(a,o),s=e,B=k(()=>{var h;const _=((h=s.executionItem.executionEnvironment)==null?void 0:h.call_stack)??[];return Object.fromEntries(_.map(n=>[n,a.getComponentById(n)]))}),w=k(()=>{var _;return((_=s.executionItem.executionEnvironment)==null?void 0:_.trace)??[]});ce(()=>{l.track("blueprints_logs_trace_opened")});async function p(_){i("closeModal"),o.setMode("blueprints"),await pe(),v(_),await pe(),o.setSelection(_,void 0,"log")}return(_,h)=>{var n,c,$;return t(),u("div",mn,[w.value.length>0?(t(),u("div",fn,[(t(!0),u(K,null,ae(w.value,(y,b)=>(t(),u("div",{key:b,class:"traceEntry"},[d("div",_n,[y.type=="functionCall"?(t(),u("span",yn,"⚡️")):C("",!0),y.type=="reasoning"?(t(),u("span",hn,"🧠")):C("",!0)]),d("div",gn,[y.thought?(t(),u("div",bn,[h[0]||(h[0]=d("strong",null,"Thought.",-1)),G(" "+R(y.thought),1)])):C("",!0),y.action?(t(),u("div",wn,[h[1]||(h[1]=d("strong",null,"Action.",-1)),G(" "+R(y.action),1)])):C("",!0),y.name?(t(),u("div",kn,R(y.name),1)):C("",!0),y.parameters?(t(),u("div",Sn,[S(Ie,{"hide-root":!0,data:y.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):C("",!0)])]))),128))])):C("",!0),d("div",Bn,[d("div",null,[h[2]||(h[2]=d("h3",null,"Result",-1)),h[3]||(h[3]=d("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),d("div",$n,[(n=_.executionItem)!=null&&n.result?(t(),T(Ie,{key:0,data:_.executionItem.result,"initial-depth":1},null,8,["data"])):(t(),u("div",Cn,"No result."))])]),d("div",null,[h[4]||(h[4]=d("h3",null,"Return value",-1)),h[5]||(h[5]=d("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),d("div",In,[(c=_.executionItem)!=null&&c.returnValue?(t(),T(Ie,{key:0,data:_.executionItem.returnValue,"initial-depth":1},null,8,["data"])):(t(),u(K,{key:1},[G(" No return value. ")],64))])])]),d("div",An,[h[6]||(h[6]=d("h3",null,"Execution environment",-1)),h[7]||(h[7]=d("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),d("div",Pn,[($=_.executionItem)!=null&&$.executionEnvironment?(t(),T(Ie,{key:0,data:_.executionItem.executionEnvironment,"initial-depth":1},null,8,["data"])):(t(),u("div",Tn,"Empty execution environment."))])]),d("div",xn,[h[8]||(h[8]=d("h3",null,"Call stack",-1)),(t(!0),u(K,null,ae(B.value,(y,b)=>{var P,m,g;return t(),u("div",{key:b,class:H(["component",{active:b==_.executionItem.componentId}])},[d("div",null,[d("div",Dn,[b==_.executionItem.componentId?(t(),u(K,{key:0},[G(" This block · ")],64)):C("",!0),G(" "+R(((P=f(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:P.name)??"Unavailable component")+" · Id: "+R(b),1)]),G(" "+R(((m=y==null?void 0:y.content)==null?void 0:m.alias)??((g=f(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:g.name)??"Unavailable component"),1)]),y?(t(),T(J,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:x=>p(b)},{default:F(()=>[S(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):C("",!0)],2)}),128))])])}}}),Ln=z(En,[["__scopeId","data-v-f98f57c8"]]),Mn={class:"BuilderListItem"},Fn=["viewBox"],Nn=["d","stroke"],Rn=["d","stroke"],zn={class:"BuilderListItem__content"},Vn=N({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Fe.Blue2},colorLast:{type:String,required:!1,default:Fe.Blue2}},setup(e){const r=e,a=k(()=>r.height/2),o=k(()=>`0 0 17 ${r.height}`),l=k(()=>["M1 0",`V${a.value-8}`,`C1 ${a.value-4}.4183 4.58172 ${a.value} 9 ${a.value}`,"H17"].join(" ")),i=k(()=>[`M1 ${a.value-8}`,`V${r.height}`].join(" "));return(v,s)=>(t(),u("div",Mn,[(t(),u("svg",{viewBox:o.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?C("",!0):(t(),u("path",{key:0,d:i.value,stroke:e.colorLast,"stroke-width":"1"},null,8,Nn)),d("path",{d:l.value,stroke:e.color,"stroke-width":"1"},null,8,Rn)],8,Fn)),d("div",zn,[ee(v.$slots,"default",{},void 0,!0)])]))}}),Wn=z(Vn,[["__scopeId","data-v-33f3edcd"]]),Un={class:"BuilderLogBlueprintExecution"},qn={class:"name"},On={key:0},Hn={class:"eyebrow"},jn={class:"outcome"},Kn={class:"result"},Gn={class:"time"},Yn={key:0,class:"message markdown"},Zn=N({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const r=U(W.core),a=U(W.builderManager),{goToComponentParentPage:o}=Pe(r,a),l=e,i=O(null),v={in_progress:5,error:4,success:3,stopped:2,skipped:1,none:0},s=k(()=>({summary:[...l.executionLog.summary.filter(_=>!!_.outcome).filter(_=>(v[_.outcome]??v.success)>1).map(_=>({..._,component:r.getComponentById(_.componentId),componentDef:r.getComponentById(_.componentId)?r.getComponentDefinition(r.getComponentById(_.componentId).type):void 0}))]}));async function B(p){a.setMode("blueprints"),await pe(),o(p),await pe(),a.setSelection(p,void 0,"log")}function w(p){return p<0?"N/A":p<.1?"< 0.1s":`${p.toFixed(2)}s`}return(p,_)=>{const h=Nt("dompurify-html");return t(),u("div",Un,[(t(!0),u(K,null,ae(s.value.summary,(n,c)=>(t(),T(Wn,{key:c,"is-last":c+1===s.value.summary.length},{default:F(()=>{var $,y,b,P,m,g,x,D,E,A,I,V;return[d("div",{class:H(["itemWrapper",{"itemWrapper--first":c===0,"itemWrapper--last":c+1===s.value.summary.length}])},[d("div",{class:H(["item",{selected:f(a).isComponentIdSelected(n.componentId)}])},[d("div",qn,[(y=($=n.component)==null?void 0:$.content)!=null&&y.alias?(t(),u("div",On,[d("div",Hn,R(((b=n.componentDef)==null?void 0:b.name)??"Unavailable component"),1),G(" "+R((m=(P=n.component)==null?void 0:P.content)==null?void 0:m.alias),1)])):(t(),u(K,{key:1},[G(R(((g=n.componentDef)==null?void 0:g.name)??"Unavailable component"),1)],64)),n.component?(t(),T(J,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:ue=>B(n.componentId)},{default:F(()=>[S(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):C("",!0)]),d("div",jn,[n.outcome!=="in_progress"?(t(),u(K,{key:0},[d("div",{class:H(["ball",(E=(D=(x=n.componentDef)==null?void 0:x.outs)==null?void 0:D[n.outcome])==null?void 0:E.style])},null,2),G(" "+R(((V=(I=(A=n.componentDef)==null?void 0:A.outs)==null?void 0:I[n.outcome])==null?void 0:V.name)??n.outcome),1)],64)):(t(),u(K,{key:1},[_[1]||(_[1]=d("div",{class:"ballContainer"},[d("div",{class:"ball inProgress"})],-1)),_[2]||(_[2]=G(" In progress... "))],64))]),d("div",Kn,[i.value==c?(t(),T(ke,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>i.value=null}]},{default:F(()=>[S(Ln,{"execution-item":n,onCloseModal:_[0]||(_[0]=()=>i.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):C("",!0),n.result||n.returnValue||n.executionEnvironment?(t(),T(J,{key:1,variant:"special",size:"small",onClick:()=>i.value=c},{default:F(()=>[S(q,{name:"file-search-2"}),_[3]||(_[3]=G(" Trace "))]),_:2},1032,["onClick"])):C("",!0)]),d("div",Gn,R(w(n.executionTimeInSeconds)),1),n.message?me((t(),u("div",Yn,null,512)),[[h,f(Jt).parse(n.message)]]):C("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),Xn=z(Zn,[["__scopeId","data-v-a691c27b"]]),Jn={class:"BuilderLogIndicator"},Qn={key:0,class:"number error"},eo={class:"icon"},to={key:1,class:"number info"},ao={class:"icon"},no=N({__name:"BuilderLogIndicator",setup(e){const r=U(W.builderManager),a=k(()=>r.getLogEntries().reduce((o,l)=>(l.type in o||(o[l.type]=0),o[l.type]++,o),{}));return(o,l)=>(t(),u("div",Jn,[a.value.error>0?(t(),u("div",Qn,[d("div",eo,[S(q,{name:"triangle-alert"})]),G(" "+R(a.value.error??0),1)])):C("",!0),a.value.info>0?(t(),u("div",to,[d("div",ao,[S(q,{name:"info"})]),G(" "+R(a.value.info??0),1)])):C("",!0)]))}}),oo=z(no,[["__scopeId","data-v-f0898ae9"]]),ro={key:0,class:"entries"},lo={class:"icon"},io={class:"title"},so={class:"time"},uo={class:"content"},co={key:0,class:"codeContainer"},po={key:1,class:"emptyMessage"},vo=N({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const r=U(W.core),a=U(W.builderManager),o=de("panel"),l=ve(r);async function i(w){w&&(l.track("nav_logs_opened"),await pe(),await B())}const v=[{icon:"trash-2",name:"Clear log",callback:()=>{a.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],s=k(()=>a.getLogEntries());async function B(){var c;const w=(c=o.value)==null?void 0:c.mainContents;if(!w)return;const p=w.querySelector(".item.selected");if(!p)return;const _=w.getBoundingClientRect(),h=p.getBoundingClientRect(),n=w.scrollTop+(h.top-_.top)-(_.height/2-h.height/2);w.scrollTo({top:n,behavior:"smooth"})}return te(a.selection,async()=>{await pe(),await B()}),(w,p)=>(t(),T(pt,{ref_key:"panel",ref:o,"panel-id":"log",name:"Log","contents-teleport-el":w.contentsTeleportEl,actions:v,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:i},{titleCompanion:F(()=>[S(oo)]),default:F(()=>[s.value.length>0?(t(),u("div",ro,[(t(!0),u(K,null,ae(s.value,(_,h)=>(t(),u(K,{key:h},[d("div",{class:H(["entry",_.type])},[d("div",lo,[S(q,{name:_.type==="error"?"triangle-alert":"info"},null,8,["name"])]),d("div",io,R(_.title)+R(_.repeated>0?` · Repeated ${_.repeated} times`:""),1),d("div",so,R(_.timestampReceived.toLocaleTimeString()),1),d("div",uo,[G(R(_.message)+" ",1),_.code?(t(),u("div",co,[d("code",null,R(_.code),1)])):C("",!0)])],2),_.blueprintExecution?(t(),T(Xn,{key:0,"execution-log":_.blueprintExecution},null,8,["execution-log"])):C("",!0)],64))),128))])):C("",!0),s.value.length==0?(t(),u("div",po,p[0]||(p[0]=[d("div",null,[G(" Exceptions and other relevant messages will be shown here."),d("br"),G("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):C("",!0)]),_:1},8,["contents-teleport-el"]))}}),mo=z(vo,[["__scopeId","data-v-5bf9ec81"]]),fo={class:"switches"},_o=N({__name:"BuilderPanelSwitcher",setup(e){const r=U(W.builderManager),a=de("screenEl");return(o,l)=>(t(),u("div",{class:H(["BuilderPanelSwitcher",{openPanels:f(r).openPanels.value.size>0}])},[d("div",{ref_key:"screenEl",ref:a,class:"screen"},null,512),d("div",fo,[S(vn,{"contents-teleport-el":f(a)},null,8,["contents-teleport-el"]),S(mo,{"contents-teleport-el":f(a)},null,8,["contents-teleport-el"])])],2))}}),yo=z(_o,[["__scopeId","data-v-93f8be10"]]),ho=["href"],go=["disabled"],bo=N({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(r,a)=>e.href?(t(),u("a",{key:0,class:"BuilderSidebarButton",href:e.href},[S(q,{name:e.icon},null,8,["name"])],8,ho)):(t(),u("button",{key:1,class:H(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[S(q,{name:e.icon},null,8,["name"])],10,go))}}),be=z(bo,[["__scopeId","data-v-044cd21a"]]),wo={class:"BuilderSidebarVersion"},ko={class:"BuilderSidebarVersion__capsule"},So=N({__name:"BuilderSidebarVersion",props:{version:{type:String,required:!0}},setup(e){return(r,a)=>(t(),u("span",wo,[d("span",ko," BETA "+R(e.version),1)]))}}),Bo=z(So,[["__scopeId","data-v-bbae565d"]]),$o={key:0,class:"BuilderSidebarPanel__inputContainer"},Co={class:"BuilderSidebarPanel__footer"},Io=N({__name:"BuilderSidebarPanel",props:Oe({hideSearchBar:{type:Boolean,required:!1},placeholder:{type:String,required:!1,default:""},searchCount:{type:Number,required:!1,default:void 0}},{modelValue:{type:String,required:!1,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const r=it(e,"modelValue"),a=e,o=k(()=>{if(a.searchCount!==void 0)return`${a.searchCount} result${a.searchCount===1?"":"s"}`}),l=O(!1);function i(v){v.target instanceof HTMLElement&&(l.value=v.target.scrollTop>0)}return(v,s)=>(t(),u("div",{class:H(["BuilderSidebarPanel",{"BuilderSidebarPanel--mainScrollSeparator":l.value}])},[e.hideSearchBar?C("",!0):(t(),u("div",$o,[S(ut,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=B=>r.value=B),class:"searchInput","left-icon":"search","data-automation-action":"search",placeholder:e.placeholder,"right-text":o.value,"right-icon":r.value?"x":void 0,onRightIconClick:s[1]||(s[1]=B=>r.value="")},null,8,["modelValue","placeholder","right-text","right-icon"])])),d("div",{class:"BuilderSidebarPanel__main",onScroll:i},[ee(v.$slots,"default",{},void 0,!0)],32),d("div",Co,[ee(v.$slots,"footer",{},void 0,!0)])],2))}}),Ao=z(Io,[["__scopeId","data-v-fcaea8d5"]]),Po=["data-note-id"],To={class:"BuilderSidebarNote__header"},xo={class:"BuilderSidebarNote__header__avatar"},Do={class:"BuilderSidebarNote__header__avatar__type"},Eo={class:"BuilderSidebarNote__header__info"},Lo={key:1},Mo={key:0,class:"BuilderSidebarNote__header__actions"},Fo={key:0,class:"BuilderSidebarNote__content"},No={key:0},Ro=N({__name:"BuilderSidebarNote",props:{component:{type:Object,required:!0},excerpt:{type:Boolean}},emits:{select:()=>!0,edit:()=>!0,delete:()=>!0},setup(e,{emit:r}){const a=e,{user:o}=Rt(),l=r,i=U(W.notesManager),{createdAtFormatted:v,type:s,content:B,createdBy:w}=i.useNoteInformation(k(()=>a.component)),{user:p,isLoading:_,error:h}=at(w),n=k(()=>_.value||h.value),c=k(()=>B.value.length<100?B.value:`${B.value.slice(0,100)}...`),$=k(()=>B.value.split(`
`)),y=k(()=>p.value?[p.value.firstName,p.value.lastName].filter(Boolean).join(" "):""),b=k(()=>{var m;if(((m=o.value)==null?void 0:m.id)===w.value)return[{value:"edit",label:"Edit",icon:"pencil"},{value:"delete",label:"Delete",icon:"trash-2",variant:"danger"}]});function P(m){switch(m){case"edit":return l("edit");case"delete":return l("delete")}}return(m,g)=>(t(),u("div",{class:"BuilderSidebarNote","data-note-id":e.component.id,tabindex:"0",onClick:g[0]||(g[0]=x=>m.$emit("select"))},[d("div",To,[d("div",xo,[d("div",Do,[f(s)==="blueprints"?(t(),T(q,{key:0,name:"wds-blueprints"})):f(s)==="ui"?(t(),T(q,{key:1,name:"frame"})):C("",!0)]),S(Ge,{"user-id":f(w)},null,8,["user-id"])]),d("div",Eo,[n.value?(t(),T(nt,{key:0,class:"BuilderSidebarNote__header__info__loader"})):(t(),u("p",Lo,R(y.value),1)),d("p",null,R(f(v)),1)]),b.value?(t(),u("div",Mo,[S(ot,{options:b.value,"trigger-custom-size":"16px",onSelect:P},null,8,["options"])])):C("",!0)]),f(B)?(t(),u("div",Fo,[e.excerpt?(t(),u("p",No,R(c.value),1)):(t(!0),u(K,{key:1},ae($.value,(x,D)=>(t(),u("p",{key:D},R(x),1))),128))])):C("",!0)],8,Po))}}),et=z(Ro,[["__scopeId","data-v-4129b8b4"]]),zo={},Vo={class:"BuilderSidebarNotesEmpty"};function Wo(e,r){return t(),u("div",Vo,r[0]||(r[0]=[zt('<svg width="77" height="77" viewBox="0 0 77 77" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-98d925a1><circle cx="38.5" cy="38.5" r="38.5" fill="#E4E9FF" data-v-98d925a1></circle><path d="M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778V30.1111Z" fill="white" data-v-98d925a1></path><path d="M32.6667 35.4444H43.3333H32.6667Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778M32.6667 35.4444H43.3333M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" data-v-98d925a1></path></svg><h5 data-v-98d925a1>No Notes</h5><p data-v-98d925a1>Click anywhere on a blueprint or interface to add a note</p>',3)]))}const Uo=z(zo,[["render",Wo],["__scopeId","data-v-98d925a1"]]),qo={class:"BuilderSidebarNoteForm"},Oo=N({__name:"BuilderSidebarNoteForm",props:{component:{type:Object,required:!0},autofocus:{type:Boolean}},emits:{submit:e=>typeof e=="string"},setup(e){const r=e,a=U(W.notesManager),o=O(a.getNoteContent(r.component));return(l,i)=>(t(),u("div",qo,[S(Vt,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=v=>o.value=v),class:"BuilderSidebarNoteForm__input",autofocus:e.autofocus},null,8,["modelValue","autofocus"]),S(J,{class:"BuilderSidebarNoteForm__submit",variant:"secondary",size:"smallIcon",disabled:!o.value,onClick:i[1]||(i[1]=v=>l.$emit("submit",o.value))},{default:F(()=>[S(q,{name:"send"})]),_:1},8,["disabled"])]))}}),Ho=z(Oo,[["__scopeId","data-v-157847b0"]]),jo={key:0,class:"BuilderSidebarNotes__note"},Ko={key:2,class:"BuilderSidebarNotes__notes"},Go=N({__name:"BuilderSidebarNotes",setup(e){const r=U(W.core),a=U(W.builderManager),{selectedNote:o,selectNote:l,selectedNoteMode:i,selectedNoteId:v,getAllNotes:s,searchNotes:B,deleteNote:w,hoveredNoteId:p,useNoteInformation:_}=U(W.notesManager),{createAndInsertComponent:h}=Pe(r,a),n=Wt({componentId:v,fieldKey:"content"}),c=O(""),$=k(()=>Array.from(s()).toSorted(P)),y=k(()=>Array.from(B(c.value)).toSorted(P)),b=k(()=>!!(o.value||$.value.length===0));function P(x,D){const E=_(x).createdAt.value,A=_(D).createdAt.value;return new Date(A).getTime()-new Date(E).getTime()}function m(x){return _(x).state.value}function g(x){r.getComponentById(v.value)?n.value=x:h(o.value.type,o.value.parentId,void 0,{content:{...o.value.content,content:x},x:o.value.x,y:o.value.y}),l(void 0)}return(x,D)=>(t(),T(Ao,{modelValue:c.value,"onUpdate:modelValue":D[4]||(D[4]=E=>c.value=E),class:"BuilderSidebarNotes","hide-search-bar":b.value},{default:F(()=>[f(o)?(t(),u("div",jo,[f(i)==="edit"?(t(),T(Ho,{key:0,component:f(o),autofocus:"",onSubmit:g},null,8,["component"])):(t(),T(et,{key:1,component:f(o),onGoBack:D[0]||(D[0]=E=>f(l)(void 0)),onEdit:D[1]||(D[1]=E=>f(l)(f(v),"edit")),onDelete:D[2]||(D[2]=E=>f(w)(f(v)))},null,8,["component"]))])):y.value.length===0?(t(),T(Uo,{key:1})):(t(),u("div",Ko,[(t(!0),u(K,null,ae(y.value,E=>(t(),T(et,{key:E.id,component:E,class:H(["BuilderSidebarNotes__notes__note",{"BuilderSidebarNotes__notes__note--hover":m(E)==="hover"}]),excerpt:"",onSelect:A=>f(l)(E.id,"show"),onEdit:A=>f(l)(E.id,"edit"),onDelete:A=>f(w)(E.id),onMouseenter:A=>p.value=E.id,onMouseleave:D[3]||(D[3]=A=>p.value=void 0)},null,8,["component","class","onSelect","onEdit","onDelete","onMouseenter"]))),128))]))]),_:1},8,["modelValue","hide-search-bar"]))}}),Yo=z(Go,[["__scopeId","data-v-3dc5600c"]]),Zo={class:"BuilderSidebar"},Xo={class:"BuilderSidebar__toolbar"},Jo={key:0,class:"BuilderSidebar__toolbar__top"},Qo={key:1,class:"BuilderSidebar__toolbar__center"},er={class:"BuilderSidebar__toolbar__bottom"},tr={key:0,class:"BuilderSidebar__pane"},ar={key:1},nr=N({__name:"BuilderSidebar",emits:{activePaneChanged:e=>e===void 0||typeof e=="string"},setup(e,{emit:r}){const a=ie({loader:()=>se(()=>import("./BuilderSidebarToolkit-xr0LwYV9.js"),__vite__mapDeps([4,0,1,5,6,7,8]),import.meta.url)}),o=ie({loader:()=>se(()=>import("./BuilderSidebarComponentTree-Bl8y1zpa.js"),__vite__mapDeps([9,0,1,10,5,6,7,11]),import.meta.url)});function l(A){return typeof A=="string"&&["layers","add"].includes(A)}const i=U(W.core),v=U(W.builderManager),s=U(W.notesManager),B=r,w=k(()=>h()),{undo:p,redo:_,getUndoRedoSnapshot:h}=Pe(i,v),n=k(()=>v.mode.value==="preview"),c="",$=Ut("activePane",l),y=O(n.value?void 0:$.value),b=k(()=>y.value!=="notes"?!1:s.selectedNoteId.value!==void 0);function P(){y.value==="notes"&&s.selectNote(void 0)}te(y,()=>{s.isAnnotating.value=y.value==="notes"},{immediate:!0}),te(n,()=>{n.value&&y.value}),te(s.selectedNoteId,()=>{s.selectedNoteId.value&&(y.value="notes")});const m=k(()=>({layers:v.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block",notes:"Notes"})),g=qe();async function x(A){if(!(!(He()?A.metaKey:A.ctrlKey)||A.target.closest("textarea, input, select")))switch(A.key){case"l":A.preventDefault(),y.value="layers";break;case"Enter":A.preventDefault(),y.value="add";break}}const D=new AbortController;ce(()=>{document.addEventListener("keydown",x,{signal:D.signal})}),$e(()=>D.abort());function E(A){y.value=y.value===A?void 0:A,$.value=y.value,s.selectNote(void 0),B("activePaneChanged",A)}return(A,I)=>(t(),u("div",Zo,[d("div",Xo,[n.value?C("",!0):(t(),u("div",Jo,[I[6]||(I[6]=d("hr",null,null,-1)),S(be,{icon:"layers","data-writer-tooltip-placement":"right","data-writer-tooltip":`${m.value.layers} (${f(g)}L)`,active:y.value==="layers","data-automation-action":"sidebar-layers",onClick:I[0]||(I[0]=V=>E("layers"))},null,8,["data-writer-tooltip","active"]),S(be,{icon:"wds-blocks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${m.value.add} (${f(g)}Enter)`,active:y.value==="add","data-automation-action":"sidebar-add",onClick:I[1]||(I[1]=V=>E("add"))},null,8,["data-writer-tooltip","active"]),f(i).isWriterCloudApp.value?(t(),T(be,{key:0,icon:"message-square","data-writer-tooltip-placement":"right","data-writer-tooltip":`${m.value.notes}`,active:y.value==="notes","data-automation-action":"sidebar-notes",onClick:I[2]||(I[2]=V=>E("notes"))},null,8,["data-writer-tooltip","active"])):C("",!0)])),n.value?C("",!0):(t(),u("div",Qo,[I[7]||(I[7]=d("hr",null,null,-1)),S(be,{icon:"undo-2","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${f(g)}Z)`,disabled:!w.value.isUndoAvailable,onClick:I[3]||(I[3]=V=>f(p)())},null,8,["data-writer-tooltip","disabled"]),S(be,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${f(g)}Y)`,icon:"redo-2",disabled:!w.value.isRedoAvailable,onClick:I[4]||(I[4]=V=>f(_)())},null,8,["data-writer-tooltip","disabled"])])),d("div",er,[f(c)?(t(),T(Bo,{key:0,version:f(c)},null,8,["version"])):C("",!0),I[8]||(I[8]=d("hr",null,null,-1)),S(be,{target:"_blank",href:"https://dev.writer.com/agent-builder/overview",icon:"circle-question-mark","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),y.value&&!n.value?(t(),u("div",tr,[d("div",{class:H(["BuilderSidebar__pane__header",{"BuilderSidebar__pane__header--goBack":b.value}])},[b.value?(t(),u(K,{key:0},[S(J,{variant:"neutral",size:"smallIcon",onClick:P},{default:F(()=>[S(q,{name:"arrow-left"})]),_:1}),I[9]||(I[9]=d("h2",null,"Back",-1))],64)):(t(),u("h2",ar,R(m.value[y.value]),1)),S(J,{variant:"neutral",size:"smallIcon",onClick:I[5]||(I[5]=V=>y.value=void 0)},{default:F(()=>[S(q,{name:"arrow-left-to-line"})]),_:1})],2),y.value==="add"?(t(),T(f(a),{key:0})):C("",!0),y.value==="layers"?(t(),T(f(o),{key:1})):C("",!0),y.value==="notes"?(t(),T(Yo,{key:2})):C("",!0)])):C("",!0)]))}}),or=z(nr,[["__scopeId","data-v-bf0b63b3"]]),rr={class:"WdsToast__icon"},lr=N({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const r=e,a=k(()=>{switch(r.type){case"info":return"info";case"success":return"check";case"error":return"x";default:return"circle-question-mark"}});return(o,l)=>(t(),u("div",{class:H(["WdsToast",`WdsToast--${e.type}`])},[d("div",rr,[S(q,{name:a.value},null,8,["name"])]),d("p",null,R(e.message),1),e.action?(t(),u("button",{key:0,class:"WdsToast__action",onClick:l[0]||(l[0]=(...i)=>e.action.func&&e.action.func(...i))},[G(R(e.action.label)+" ",1),S(q,{name:e.action.icon},null,8,["name"])])):C("",!0),e.closable?(t(),T(J,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:l[1]||(l[1]=i=>o.$emit("close"))},{default:F(()=>[S(q,{name:"x"})]),_:1})):C("",!0)],2))}}),ir=z(lr,[["__scopeId","data-v-834b8081"]]),sr={class:"BuilderToasts"},dr=N({__name:"BuilderToasts",setup(e){const{toasts:r,removeToast:a}=Se();return(o,l)=>(t(),u("div",sr,[S(qt,{name:"list",tag:"div"},{default:F(()=>[(t(!0),u(K,null,ae(f(r),i=>(t(),T(ir,{key:i.id,class:"BuilderToasts__toast",closable:i.closable,message:i.message,type:i.type,action:i.action,onClick:v=>f(a)(i.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),ur=z(dr,[["__scopeId","data-v-6c357255"]]),cr=200,pr=36,vr=N({__name:"BuilderInstanceTracker",props:{instancePath:{},matchSize:{type:Boolean},verticalOffsetPixels:{},isOffBoundsAllowed:{type:Boolean},preventSettingsBarOverlap:{type:Boolean}},setup(e,{expose:r}){const a=e,{instancePath:o,matchSize:l,verticalOffsetPixels:i,isOffBoundsAllowed:v,preventSettingsBarOverlap:s}=Ot(a),B=Le({});let w=0;const p=de("rootEl");function _(y){const b=document.querySelector(".ComponentRenderer"),{top:P,left:m}=y.getBoundingClientRect(),{clientHeight:g}=document.body,{clientWidth:x}=b,{left:D}=b.getBoundingClientRect(),E=document.querySelector(".BuilderSettings"),{left:A}=(E==null?void 0:E.getBoundingClientRect())||{left:1/0};let{clientHeight:I,clientWidth:V}=(l!=null&&l.value?y:p.value)??{};if(I===void 0||V===void 0)return;let ue=i!=null&&i.value?i.value:0,Z=m,le=P+ue;if(v.value||(Z=Math.max(D,Z),Z=Math.min(D+x-V,Z),le=Math.max(pr,le),le=Math.min(g-I,le)),s.value){let ye=0;Z+V>A&&(ye=Math.max(Z-(A-V),0)),Z-=ye}B.value={display:"block",top:`${le}px`,left:`${Z}px`,width:`${V}px`,height:`${I}px`}}function h(){B.value={display:"none"}}function n(){let y=document.querySelector(`.ComponentRenderer [data-writer-instance-path="${o.value}"]`);if(!y){h();return}const b=getComputedStyle(y);if(!b){h();return}if(b.display=="contents"&&(y=y.querySelector("[data-writer-id]")),!y){h();return}_(y)}function c(){w=requestAnimationFrame(async()=>{n(),!$.signal.aborted&&(await new Promise(y=>setTimeout(y,cr)),c())})}const $=Ke();return r({refresh:n}),ce(async()=>{window.addEventListener("scroll",n,{signal:$.signal}),c()}),$e(()=>{cancelAnimationFrame(w)}),(y,b)=>(t(),u("div",{ref_key:"rootEl",ref:p,class:"BuilderInstanceTracker",style:Ae(B.value)},[ee(y.$slots,"default",{},void 0,!0)],4))}}),Ee=z(vr,[["__scopeId","data-v-c3e9e555"]]),mr={ref:"rootEl",class:"BuilderCollaborationTracker"},fr={class:"bubble"},_r={class:"main"},yr=N({__name:"BuilderCollaborationTracker",setup(e){const r=U(W.collaborationManager);function a(o){return!(Ht(o).length<=2)}return(o,l)=>(t(),u("div",mr,[(t(!0),u(K,null,ae(f(r).connectedUsersByInstancePath.value,(i,v)=>(t(),u(K,{key:v},[a(v)?(t(),T(Ee,{key:0,"is-off-bounds-allowed":!1,"instance-path":v,"vertical-offset-pixels":-32,class:"instanceTracker"},{default:F(()=>[d("div",fr,[d("div",_r,[(t(!0),u(K,null,ae(i,s=>(t(),T(Ge,{key:s,"show-tooltip":!0,"user-id":s},null,8,["user-id"]))),128))]),l[0]||(l[0]=d("div",{class:"triangle"},null,-1))])]),_:2},1032,["instance-path"])):C("",!0)],64))),128))],512))}}),hr=z(yr,[["__scopeId","data-v-15c19d63"]]),gr={class:"ShareResizeVertical__top"},br={class:"ShareResizeVertical__divider"},wr={class:"ShareResizeVertical__bottom"},kr=N({__name:"ShareResizeVertical",props:{initialBottomSize:{type:Number,required:!0},disabled:{type:Boolean,required:!1}},setup(e){const r=e,a=de("root"),o=Ke(),l=jt(r,"initialBottomSize");let i=O(l.value);te(l,()=>i.value=l.value);const v=k(()=>({gridTemplateRows:`minmax(0px, 1fr) 1px ${i.value}px`}));function s(){if(!a.value)return;document.addEventListener("mousemove",w,{signal:o.signal}),document.addEventListener("mouseup",p,{signal:o.signal});const B=a.value.getBoundingClientRect();function w(_){i.value=B.bottom-_.clientY}function p(){document.removeEventListener("mouseup",p),document.removeEventListener("mousemove",w)}}return(B,w)=>(t(),u("div",{ref_key:"root",ref:a,class:"ShareResizeVertical",style:Ae(v.value)},[d("div",gr,[ee(B.$slots,"top",{},void 0,!0)]),d("div",br,[e.disabled?C("",!0):(t(),u("div",{key:0,class:"ShareResizeVertical__divider__hand",onMousedown:st(s,["prevent"])},null,32))]),d("div",wr,[ee(B.$slots,"bottom",{},void 0,!0)])],4))}}),Sr=z(kr,[["__scopeId","data-v-0de30584"]]),Br={class:"builderMain"},$r=N({__name:"BuilderApp",setup(e){Kt(W.isAutogenModalShown,O(!1));const r=ie({loader:()=>se(()=>import("./BuilderSettings-BpHzmadU.js").then(L=>L.b),__vite__mapDeps([12,0,1,10,13,5,6,14,15,16,17]),import.meta.url)}),a=ie({loader:()=>se(()=>import("./ComponentRenderer-CJHWkXjd.js"),__vite__mapDeps([18,0,1,19]),import.meta.url)}),o=ie({loader:()=>se(()=>import("./BuilderInsertionOverlay-V7vzRb9q.js"),__vite__mapDeps([20,0,1,21]),import.meta.url)}),l=ie({loader:()=>se(()=>import("./BuilderInsertionLabel-CGPDezzi.js"),__vite__mapDeps([22,0,1,23]),import.meta.url)}),i=ie({loader:()=>se(()=>import("./BuilderVault-YWCelaHF.js"),__vite__mapDeps([24,15,0,1,16,25]),import.meta.url)}),v=U(W.core),s=U(W.builderManager),B=U(W.notesManager),w=U(W.collaborationManager),p=ve(v),_=Se(),h=de("noteEl");function n(){if(h.value!=null&&typeof h.value[Symbol.iterator]=="function")for(const Q of h.value)Q.refresh()}const{candidateId:c,candidateInstancePath:$,isCandidacyConfirmed:y,dropComponent:b,assignInsertionCandidacy:P,removeInsertionCandidacy:m}=Zt(v),{createAndInsertComponent:g,undo:x,redo:D,moveComponent:E,moveComponentUp:A,moveComponentDown:I,cutComponent:V,isPasteAllowed:ue,isCopyAllowed:Z,isCutAllowed:le,isDeleteAllowed:ye,isGoToParentAllowed:Te,isGoToChildAllowed:Ne,isGoToNextSiblingAllowed:xe,isGoToPrevSiblingAllowed:De,pasteComponent:Ce,copyComponent:Re,removeComponentsSubtree:M,goToParent:Y,goToChild:ne,goToNextSibling:ze,goToPrevSibling:Ve,moveComponentToParent:ft,moveComponentInsideNextSibling:_t}=Pe(v,s,p),oe=s.mode,yt=s.firstSelectedId,Ye=k(()=>s.openPanels.value.size>0),ht=k(()=>Array.from(B.getNotes(v.activePageId.value)).map(L=>({...L,parentInstancePath:B.useNoteInformation(L).parentInstancePath.value})).filter(L=>L.parentInstancePath!==void 0));async function gt(L){if(L.key=="Escape"){s.setSelection(null);return}const Q=He()?L.metaKey:L.ctrlKey;if(L.target.closest("textarea, input, select, [contenteditable]"))return;if(L.key=="z"&&Q){L.preventDefault(),x();return}if(L.key=="y"&&Q){L.preventDefault(),D();return}if(!s.isSingleSelectionActive.value||!s.firstSelectedItem.value)return;const{componentId:j,instancePath:he}=s.firstSelectedItem.value;if(L.key==(He()?"Backspace":"Delete")){const fe=s.selection.value.filter(We=>ye(We.componentId)).map(We=>We.componentId);M(...fe);return}if(Q)if(L.shiftKey)switch(L.key){case"ArrowDown":L.preventDefault(),xe(j)&&ze(j);break;case"ArrowUp":L.preventDefault(),De(j)&&Ve(j);break;case"ArrowLeft":L.preventDefault(),Te(j)&&Y(j,he);break;case"ArrowRight":L.preventDefault(),Ne(j)&&ne(j);break}else switch(L.key){case"ArrowDown":L.preventDefault(),I(j);break;case"ArrowUp":L.preventDefault(),A(j);break;case"ArrowLeft":L.preventDefault(),ft(j);break;case"ArrowRight":L.preventDefault(),_t(j);break;case"v":if(!ue(j))return;try{await Ce(j)}catch(fe){_.pushToast({type:"error",message:String(fe)})}break;case"c":Z(j)&&Re(j);break;case"x":le(j)&&V(j);break}}function bt(L){oe.value!=="preview"&&P(L)}function wt(L){if(oe.value==="preview")return;s.setSelection(null);const Q=b(L);if(!Q)return;const{draggedType:X,draggedId:j,parentId:he,position:fe}=Q;j?E(j,he,fe):g(X,he,fe)}function kt(L){if(oe.value==="preview"||L.target.closest("[data-writer-unselectable]"))return;const X=L.target.closest("[data-writer-id]");if(!X)return;const j=X.dataset.writerId,he=X.dataset.writerInstancePath;s.isComponentIdSelected(j)&&s.selectionStatus.value!==Je.Multiple||B.isAnnotating.value||(L.preventDefault(),L.stopPropagation(),s.handleSelectionFromEvent(L,j,he,"click"))}function St(){s.isSettingsBarCollapsed.value=!1}const Bt=L=>{if(oe.value==="preview")return;const X=L.target.closest("[data-writer-id]").dataset.writerId,{type:j}=v.getComponentById(X);s.selectionStatus.value===Je.Multiple&&(s.setSelection(X,void 0,"click"),s.isSettingsBarCollapsed.value=!0),L.dataTransfer.setData(`application/json;writer=${j},${X}`,"{}")};function $t(L){s.setSelection(null),m(L)}const Ze=new AbortController;return te(s.selection,()=>{w&&(w.updateOutgoingPing({action:"select",selection:s.selection.value}),w.sendCollaborationPing())}),ce(()=>{document.addEventListener("keydown",gt,{signal:Ze.signal})}),$e(()=>{Ze.abort()}),(L,Q)=>(t(),u("div",{class:"BuilderApp",tabindex:"-1",style:Ae(f(Yt))},[d("div",{class:H(["mainGrid",{openPanels:f(s).openPanels.value.size>0}])},[S(Ia,{class:"builderHeader"}),me(S(or,{class:"sidebar",onActivePaneChanged:n},null,512),[[Be,f(oe)==="ui"||f(oe)==="blueprints"]]),S(Sr,{"initial-bottom-size":Ye.value?440:48,disabled:!Ye.value,class:H({"mainGrid--fullWidth":f(oe)==="preview"||f(oe)==="vault"})},{top:F(()=>[d("div",Br,[f(oe)==="vault"?(t(),T(f(i),{key:0})):(t(),u("div",{key:1,class:H(["rendererWrapper",{addNoteCursor:f(B).isAnnotating.value&&f(s).mode.value!=="preview"}]),onScroll:n},[S(f(a),{class:H(["componentRenderer",{settingsOpen:f(s).isSingleSelectionActive}]),onDragover:bt,onDragstart:Bt,onDragend:$t,onDrop:wt,onClickCapture:kt,onDblclick:St},null,8,["class"])],34)),f(s).isSingleSelectionActive?(t(),T(f(r),{key:f(yt)??"noneSelected"})):C("",!0)])]),bottom:F(()=>[S(yo,{class:"panelSwitcher"})]),_:1},8,["initial-bottom-size","disabled","class"])],2),f(oe)!=="preview"?(t(),u(K,{key:0},[S(hr,{class:"collaborationTracker"}),f(c)&&!f(y)?(t(),u(K,{key:0},[(t(),T(Ee,{key:f($),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":f($),"match-size":!0},{default:F(()=>[S(f(o))]),_:1},8,["instance-path"])),(t(),T(Ee,{key:f($),class:"insertionLabelTracker","instance-path":f($),"vertical-offset-pixels":-48},{default:F(()=>[S(f(l),null,{default:F(()=>[G(R(f(v).getComponentDefinition(f(v).getComponentById(f(c)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):C("",!0)],64)):C("",!0),f(oe)==="ui"?(t(!0),u(K,{key:1},ae(ht.value,X=>(t(),T(Ee,{key:X.id,ref_for:!0,ref_key:"noteEl",ref:h,class:"BuilderApp__noteTracker","is-off-bounds-allowed":!0,"instance-path":X.parentInstancePath,"match-size":!0},{default:F(()=>[S(Gt,{class:"BuilderApp__noteTracker__note","component-id":X.id},null,8,["component-id"])]),_:2},1032,["instance-path"]))),128)):C("",!0),Q[0]||(Q[0]=d("div",{id:"modal"},null,-1)),S(Da,{id:"tooltip"}),S(ur)],4))}}),Cr=z($r,[["__scopeId","data-v-452da39b"]]),Tr=Object.freeze(Object.defineProperty({__proto__:null,default:Cr},Symbol.toStringTag,{value:"Module"}));export{Ao as B,mt as W,Ga as a,Wn as b,Tr as c};
