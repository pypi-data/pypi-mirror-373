ServerName "ProFTPD Server @{{component.host.fqdn}}"
ServerType standalone
DefaultServer on

MaxInstances 100
User {{component.service_user}}
Group {{component.service_user_group}}
DelayTable {{component.workdir}}/delaytable
ScoreboardFile {{component.workdir}}scoreboard
PidFile {{component.workdir}}/proftpd.pid

SystemLog {{component.workdir}}/system.log
DebugLevel 10
{% if component.extended_debug %}
TraceLog {{component.workdir}}/trace.log
Trace DEFAULT:10
{% endif %}

<Global>
    AllowOverwrite on
    AuthOrder mod_auth_file.c mod_auth_unix.c
    AuthUserFile {{component.passwd_file.path}}
    DefaultRoot ~
    RequireValidShell off
    Umask 022
    TransferLog {{component.workdir}}/transfer.log
</Global>

<Limit SITE_CHMOD>
    DenyAll
</Limit>


<VirtualHost {{component.ftp_address.listen.host}} {% if component.ftp_address.listen_v6 %}{{component.ftp_address.listen_v6.host}}{% endif %}>
    Port {{component.ftp_address.listen.port}}
    PassivePorts 49152 65534
</VirtualHost>

<VirtualHost {{component.sftp_address.listen.host}} {% if component.sftp_address.listen_v6 %}{{component.sftp_address.listen_v6.host}} {% endif %}>
    SFTPEngine on
    Port {{component.sftp_address.listen.port}}
    SFTPHostKey {{component.hostkey_path}}
    SFTPAuthMethods publickey password
    SFTPAuthorizedUserKeys file:~/.sftp/authorized_keys
    SFTPCompression delayed
</VirtualHost>
