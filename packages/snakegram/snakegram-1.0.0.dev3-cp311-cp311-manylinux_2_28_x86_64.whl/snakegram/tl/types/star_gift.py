
#                     !!! WARNING !!!
#             This is an auto-generated file!
#                 Generated by [Builder].
# Any manual modifications will be lost upon regeneration.
#             DO NOT EDIT THIS FILE DIRECTLY.

from typing import TYPE_CHECKING, Optional, Union, List
from ...gadgets.tlobject import TLObject
from ...gadgets.byteutils import Writer


if TYPE_CHECKING:
    from .peer import TypePeer
    from .document import TypeDocument
    from ...gadgets.byteutils import Reader
    from .star_gift_attribute import TypeStarGiftAttribute


class StarGift(TLObject, family='TypeStarGift'):
    """
    Represents a [star gift, see here](https://core.telegram.org/api/gifts) for more info.
    """

    _id = 0X2CC73C8
    _group_id = 0X87440C7B

    def __init__(
        self,
        id: int,
        sticker: 'TypeDocument',
        stars: int,
        convert_stars: int,
        limited: bool = False,
        sold_out: bool = False,
        birthday: bool = False,
        availability_remains: Optional[int] = None,
        availability_total: Optional[int] = None,
        first_sale_date: Optional[int] = None,
        last_sale_date: Optional[int] = None,
        upgrade_stars: Optional[int] = None
    ):

        """
        Represents a [star gift, see here](https://core.telegram.org/api/gifts) for more info.

        Args:
            id (int): Identifier of the gift
            sticker ('TypeDocument'): [Sticker](https://core.telegram.org/api/stickers) that represents the gift.
            stars (int): Price of the gift in [Telegram Stars](https://core.telegram.org/api/stars).
            convert_stars (int): The receiver of this gift may convert it to this many Telegram Stars, instead of displaying it on their profile page. convert_stars will be equal to stars only if the gift was bought using recently bought Telegram Stars, otherwise it will be less than stars.
            limited (bool, optional): Whether this is a limited-supply gift.
            sold_out (bool, optional): Whether this gift sold out and cannot be bought anymore.
            birthday (bool, optional): Whether this is a birthday-themed gift
            availability_remains (Optional[int], optional): For limited-supply gifts: the remaining number of gifts that may be bought.
            availability_total (Optional[int], optional): For limited-supply gifts: the total number of gifts that was available in the initial supply.
            first_sale_date (Optional[int], optional): For sold out gifts only: when was the gift first bought.
            last_sale_date (Optional[int], optional): For sold out gifts only: when was the gift last bought.
            upgrade_stars (Optional[int], optional): ...
        """

        self.id = id
        self.sticker = sticker
        self.stars = stars
        self.convert_stars = convert_stars
        self.limited = limited
        self.sold_out = sold_out
        self.birthday = birthday
        self.availability_remains = availability_remains
        self.availability_total = availability_total
        self.first_sale_date = first_sale_date
        self.last_sale_date = last_sale_date
        self.upgrade_stars = upgrade_stars

    def to_bytes(self, boxed: bool=True):
        with Writer(b'\xc8s\xcc\x02' if boxed else b'') as writer:
            with writer.flag() as flags:
                flags(self.limited, 0)
                flags(self.sold_out, 1)
                flags(self.birthday, 2)
                writer.long(self.id)
                writer.object(
                    self.sticker,
                    group_id=0X6547BD50
                )
                writer.long(self.stars)

                if flags(self.availability_remains, 0):
                    writer.int(self.availability_remains)

                if flags(self.availability_total, 0):
                    writer.int(self.availability_total)
                writer.long(self.convert_stars)

                if flags(self.first_sale_date, 1):
                    writer.int(self.first_sale_date)

                if flags(self.last_sale_date, 1):
                    writer.int(self.last_sale_date)

                if flags(self.upgrade_stars, 3):
                    writer.long(self.upgrade_stars)

            return writer.getvalue()

    @classmethod
    def from_reader(cls, reader: 'Reader'):
        flags = reader.flag()
        id_ = reader.long()
        sticker_ = reader.object(
            group_id=0X6547BD50
        )

        stars_ = reader.long()
        availability_remains_ = (
            reader.int()
            if flags(0) else None
        )

        availability_total_ = (
            reader.int()
            if flags(0) else None
        )

        convert_stars_ = reader.long()
        first_sale_date_ = (
            reader.int()
            if flags(1) else None
        )

        last_sale_date_ = (
            reader.int()
            if flags(1) else None
        )

        upgrade_stars_ = (
            reader.long()
            if flags(3) else None
        )

        return cls(
            id=id_,
            sticker=sticker_,
            stars=stars_,
            convert_stars=convert_stars_,
            limited=flags(0),
            sold_out=flags(1),
            birthday=flags(2),
            availability_remains=availability_remains_,
            availability_total=availability_total_,
            first_sale_date=first_sale_date_,
            last_sale_date=last_sale_date_,
            upgrade_stars=upgrade_stars_
        )

class StarGiftUnique(TLObject, family='TypeStarGift'):
    _id = 0X5C62D151
    _group_id = 0X87440C7B

    def __init__(
        self,
        id: int,
        title: str,
        slug: str,
        num: int,
        attributes: List['TypeStarGiftAttribute'],
        availability_issued: int,
        availability_total: int,
        owner_id: Optional['TypePeer'] = None,
        owner_name: Optional[str] = None,
        owner_address: Optional[str] = None,
        gift_address: Optional[str] = None
    ):

        self.id = id
        self.title = title
        self.slug = slug
        self.num = num
        self.attributes = attributes
        self.availability_issued = availability_issued
        self.availability_total = availability_total
        self.owner_id = owner_id
        self.owner_name = owner_name
        self.owner_address = owner_address
        self.gift_address = gift_address

    def to_bytes(self, boxed: bool=True):
        with Writer(b'Q\xd1b\\' if boxed else b'') as writer:
            with writer.flag() as flags:
                writer.long(self.id)
                writer.string(self.title)
                writer.string(self.slug)
                writer.int(self.num)

                if flags(self.owner_id, 0):
                    writer.object(
                        self.owner_id,
                        group_id=0XB4DECBCA
                    )

                if flags(self.owner_name, 1):
                    writer.string(self.owner_name)

                if flags(self.owner_address, 2):
                    writer.string(self.owner_address)
                writer.vector(
                    self.attributes,
                    lambda value: writer.object(
                        value,
                        group_id=0XEE235015
                    )
                )
                writer.int(self.availability_issued)
                writer.int(self.availability_total)

                if flags(self.gift_address, 3):
                    writer.string(self.gift_address)

            return writer.getvalue()

    @classmethod
    def from_reader(cls, reader: 'Reader'):
        flags = reader.flag()
        id_ = reader.long()
        title_ = reader.string()
        slug_ = reader.string()
        num_ = reader.int()
        owner_id_ = (
            reader.object(
                group_id=0XB4DECBCA
            )
            if flags(0) else None
        )

        owner_name_ = (
            reader.string()
            if flags(1) else None
        )

        owner_address_ = (
            reader.string()
            if flags(2) else None
        )

        attributes_ = reader.vector(
            lambda: reader.object(
                group_id=0XEE235015
            )
        )

        availability_issued_ = reader.int()
        availability_total_ = reader.int()
        gift_address_ = (
            reader.string()
            if flags(3) else None
        )

        return cls(
            id=id_,
            title=title_,
            slug=slug_,
            num=num_,
            attributes=attributes_,
            availability_issued=availability_issued_,
            availability_total=availability_total_,
            owner_id=owner_id_,
            owner_name=owner_name_,
            owner_address=owner_address_,
            gift_address=gift_address_
        )

TypeStarGift = Union[
    StarGift,
    StarGiftUnique
]