# Reloading Context Instructions

<!--
AI Attribution (AIA) Notice:
- Generated by: Claude (Anthropic AI Assistant)
- Session Date: 2025-08-25
- Vibe-Coder: Andrew Potozniak <potozniak@redhat.com>
-->

## Context Continuation Instructions

**Project**: Container Registry Card Catalog - A TUI application for browsing container registries

**Current State**: Authentication system is fully functional with dual debug systems implemented. The application supports Docker Registry v2 token authentication (especially Quay.io), basic auth, and bearer tokens with in-memory credential storage.

## Key Files to Read

1. **`CURRENT_STATUS.md`** - Complete project status and accomplishments
2. **`container_registry_card_catalog.py`** - Main TUI application (1400+ lines)
3. **`DEBUG_USAGE_GUIDE.md`** - Comprehensive debug system documentation
4. **`QUAY_AUTHENTICATION_GUIDE.md`** - Quay.io authentication specifics
5. **`REGISTRY_CONFIGURATION_DESIGN.md`** - Architecture and design decisions

## Last Completed Work

- Implemented `--debug` flag for TUI operations logging with credential masking
- Fixed debug logging to be file-only (no console output to prevent TUI corruption)
- Created dual debug system: TUI operations debug (`--debug`) + API debug console (Ctrl+D)
- Updated all documentation to reflect debug system bifurcation

## Next Priority Tasks

1. **Test authentication functionality** - Verify real registry connections work
2. **Implement persistent configuration storage** - Encrypted credential storage
3. **Fix any remaining UI update issues** - Ensure registry status refreshes properly

## Important Technical Details

### Authentication System
- Authentication works in-memory only (no persistence yet for security)
- Quay.io requires specific scope format: `repository:org/repo:pull` (not `registry:catalog:*`)
- Service parameter must be FQDN: `quay.io` (not generic names)
- Docker Registry v2 token flow fully implemented with auto-refresh
- Repository loading respects user-configured max_repos setting
- Tag loading is conditional (≤50 repos for performance)

### Debug Systems
- **TUI Operations Debug** (`--debug`): File-based logging of application state
- **API Debug Console** (Ctrl+D): Interactive console for HTTP/auth debugging
- All debug logging automatically masks credentials, tokens, and sensitive data
- File-only logging prevents TUI corruption

### Configuration
- In-memory auth storage: `self.registry_auth = {}`
- Registry configuration modal accessible with 'C' key
- Test connection functionality with real-time feedback
- Registry type detection and authentication hints

### File Structure
- `container_registry_card_catalog.py` - Main TUI application
- `registry_client.py` - HTTP client with authentication support
- `registry_config_modal.py` - Configuration modal UI
- `local_container_client.py` - Local podman/docker support
- Various documentation files (*.md)

## Working Features ✅

- Docker Registry v2 token authentication (Quay.io tested)
- Basic auth and bearer token support
- Token caching and auto-refresh
- Registry type detection and hints
- Configuration modal with test connection
- Dual debug systems with credential masking
- Local container runtime support (podman/docker)
- Repository pagination with Link header support
- Performance optimizations for large catalogs

## Known Issues ⚠️

- Configuration persistence not implemented (in-memory only)
- Registry status may not update immediately after auth config
- Repository count UI may not reflect configured max_repos setting

## Security Note

All debug logging automatically masks credentials, tokens, and sensitive data using comprehensive keyword detection. Logs are safe to share externally.

## Development Context

The application is ready for:
1. Testing with real registries and authentication
2. Implementing persistent configuration with proper encryption  
3. Addressing any remaining UI update issues

The authentication system is fully functional - the main remaining work is adding secure persistent storage and ensuring UI consistency across all operations.

---

*This file provides complete context for continuing development of the Container Registry Card Catalog project.*